{"config":{"separator":"[\\s\\-_,:!=\\[\\]()\\\\\"`/]+|\\.(?!\\d)"},"items":[{"location":"","level":1,"title":"Index","text":"<p>P√°gina de apuntes del m√≥dulo de Planificaci√≥n y administraci√≥n de redes (PARE), de 1¬∫ de ASIR en el IES Severo Ochoa de Elche.</p>","path":["Index"],"tags":[]},{"location":"SecSwitches/","level":1,"title":"üöÄ Gu√≠a Completa de Seguridad en Switches Cisco","text":"","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#1-vlans-virtual-local-area-networks","level":2,"title":"üìö 1. VLANs (Virtual Local Area Networks)","text":"","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#concepto-teorico-detallado","level":3,"title":"Concepto Te√≥rico Detallado","text":"<p>¬øQu√© es una VLAN? Una VLAN es una red l√≥gica independiente dentro de una red f√≠sica. Imagina un edificio de oficinas donde cada departamento tiene su propio espacio privado aunque compartan el mismo edificio f√≠sico.</p> <p>Problema que resuelve:</p> <ul> <li>Dominios de broadcast grandes: Sin VLANs, toda la red recibe tr√°fico broadcast</li> <li>Seguridad: Dispositivos en diferentes departamentos pueden comunicarse libremente</li> <li>Rendimiento: Tr√°fico innecesario en todos los puertos</li> </ul> <p>Tipos de VLANs:</p> <ul> <li>VLAN de datos: Para usuarios finales</li> <li>VLAN de voz: Para tr√°fico VoIP (prioridad alta)</li> <li>VLAN de administraci√≥n: Para gesti√≥n del switch</li> <li>VLAN nativa: Para tr√°fico sin etiquetar en trunks</li> </ul> <p></p> <p></p>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#que-es-un-trunk","level":3,"title":"¬øQu√© es un trunk?","text":"<p>Un trunk es un enlace de red que transporta m√∫ltiples VLANs simult√°neamente entre switches o entre un switch y un router.*</p>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#analogia-para-entenderlo","level":3,"title":"Analog√≠a para Entenderlo","text":"<pre><code># SIN TRUNK (Access Ports):\nCada VLAN = Carretera separada\nPuerto access = Rampa de entrada/salida a UNA carretera\n\n# CON TRUNK:\nTrunk = Autopista con M√öLTIPLES carriles (cada carril = una VLAN)\nCada frame lleva \"etiqueta\" que dice a qu√© carril (VLAN) pertenece\n</code></pre>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#problema-que-resuelve","level":3,"title":"Problema que Resuelve","text":"<pre><code># ESCENARIO SIN TRUNK:\nSwitch A (VLAN 10,20,30) --- Switch B (VLAN 10,20,30)\nNecesitar√≠as: 3 cables separados (uno por VLAN)\n‚ùå Ineficiente ‚ùå Costoso ‚ùå No escalable\n\n# ESCENARIO CON TRUNK:\nSwitch A (VLAN 10,20,30) ---[UN CABLE]--- Switch B (VLAN 10,20,30)\n‚úÖ Un solo cable transporta TODAS las VLANs\n‚úÖ Eficiente ‚úÖ Escalable ‚úÖ Flexible\n</code></pre>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#como-funciona-el-trunking-tecnicamente","level":2,"title":"üèóÔ∏è C√≥mo Funciona el Trunking T√©cnicamente","text":"","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#protocolo-8021q-dot1q","level":3,"title":"Protocolo 802.1Q (Dot1Q)","text":"","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#ejemplo-de-etiquetado","level":3,"title":"Ejemplo de Etiquetado","text":"","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#configuracion-de-trunks-en-cisco","level":2,"title":"‚öôÔ∏è Configuraci√≥n de Trunks en Cisco","text":"","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#comandos-basicos","level":3,"title":"Comandos B√°sicos","text":"<pre><code>! CONFIGURAR PUERTO COMO TRUNK\nSwitch(config)# interface gigabitethernet 0/1\nSwitch(config-if)# switchport mode trunk\n! El puerto ahora transporta TODAS las VLANs\n\n! LIMITAR VLANs PERMITIDAS EN EL TRUNK\nSwitch(config-if)# switchport trunk allowed vlan 10,20,30\n! Solo estas VLANs pueden pasar por el trunk\n\n! VERIFICACI√ìN\nSwitch# show interfaces trunk\nPort        Mode         Encapsulation  Status        Native vlan\nGi0/1       on           802.1q         trunking      1\n\nPort        Vlans allowed on trunk\nGi0/1       10,20,30\n</code></pre>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#modos-de-operacion-de-puertos","level":3,"title":"Modos de Operaci√≥n de Puertos","text":"<pre><code># SWITCHPORT MODE TRUNK ‚Üí Forza trunk, negocia DTP\n# SWITCHPORT MODE DYNAMIC DESIRABLE ‚Üí Intenta formar trunk\n# SWITCHPORT MODE DYNAMIC AUTO ‚Üí Espera que otro inicie trunk  \n# SWITCHPORT MODE ACCESS ‚Üí Solo una VLAN (no trunk)\n</code></pre>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#que-es-la-vlan-nativa","level":2,"title":"üè∑Ô∏è ¬øQu√© es la VLAN NATIVA?","text":"","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#concepto-fundamental","level":3,"title":"Concepto Fundamental","text":"<p>La VLAN nativa es la √∫nica VLAN cuyos frames viajan SIN etiqueta 802.1Q a trav√©s de un trunk.</p>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#proposito-de-la-vlan-nativa","level":3,"title":"Prop√≥sito de la VLAN Nativa","text":"<pre><code># COMUNICACI√ìN CON DISPOSITIVOS QUE NO ENTIENDEN 802.1Q\n- Dispositivos legacy\n- Algunos servidores\n- Equipos de red antiguos\n- Dispositivos que no soportan VLAN tagging\n</code></pre>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#comportamiento","level":3,"title":"Comportamiento","text":"<pre><code># PARA TR√ÅFICO DE VLAN NATIVA:\nFrame entra al trunk ‚Üí NO se a√±ade etiqueta 802.1Q\nFrame sale del trunk ‚Üí Se asume que pertenece a VLAN nativa\n\n# PARA TR√ÅFICO DE OTRAS VLANs:\nFrame entra al trunk ‚Üí SE A√ëADE etiqueta 802.1Q con VLAN ID\nFrame sale del trunk ‚Üí SE REMUEVE etiqueta, se env√≠a a VLAN correcta\n</code></pre>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#importante-consideraciones-de-seguridad","level":2,"title":"‚ö†Ô∏è IMPORTANTE: Consideraciones de Seguridad","text":"","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#problema-de-seguridad-con-vlan-nativa","level":3,"title":"Problema de Seguridad con VLAN Nativa","text":"<pre><code># ATAQUE DE SALTO DE VLAN (VLAN HOPPING)\nAtacante puede:\n1. Enviar frames etiquetados con VLAN nativa\n2. Switch puede remover etiqueta y enviar a VLAN nativa\n3. Posible acceso no autorizado a VLAN nativa\n\n# SOLUCI√ìN RECOMENDADA:\nNUNCA usar VLAN 1 como nativa\nUsar VLAN \"basura\" no utilizada para nativa\n</code></pre>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#configuracion-segura","level":3,"title":"Configuraci√≥n Segura","text":"<pre><code>! CONFIGURACI√ìN NO SEGURA (POR DEFECTO)\nSwitch(config-if)# switchport trunk native vlan 1\n! ‚ùå VLAN 1 es default y puede tener dispositivos\n\n! CONFIGURACI√ìN SEGURA (RECOMENDADA)\nSwitch(config-if)# switchport trunk native vlan 999\nSwitch(config)# vlan 999  \nSwitch(config-vlan)# name VLAN_BASURA_NATIVA\nSwitch(config-vlan)# exit\n! ‚úÖ VLAN 999 no tiene dispositivos, solo existe para tr√°fico nativo\n</code></pre>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#configuracion-completa-y-segura","level":2,"title":"üîß Configuraci√≥n Completa y Segura","text":"","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#ejemplo-practico-corporativo","level":3,"title":"Ejemplo Pr√°ctico Corporativo","text":"<pre><code>! ESCENARIO: Empresa con 3 departamentos + VLAN de administraci√≥n\n\n! CREAR VLANs\nSwitch(config)# vlan 10\nSwitch(config-vlan)# name VENTAS\nSwitch(config-vlan)# vlan 20\nSwitch(config-vlan)# name IT\nSwitch(config-vlan)# vlan 30\nSwitch(config-vlan)# name CONTABILIDAD\nSwitch(config-vlan)# vlan 99\nSwitch(config-vlan)# name ADMIN\nSwitch(config-vlan)# vlan 999\nSwitch(config-vlan)# name NATIVA_SEGURA\nSwitch(config-vlan)# exit\n\n! CONFIGURAR TRUNK SEGURO\nSwitch(config)# interface gigabitethernet 0/1\nSwitch(config-if)# description TRUNK_TO_CORE_SWITCH\nSwitch(config-if)# switchport mode trunk\nSwitch(config-if)# switchport trunk native vlan 999\nSwitch(config-if)# switchport trunk allowed vlan 10,20,30,99\n! ‚úÖ Solo las VLANs necesarias\n! ‚úÖ VLAN nativa segura (999)\n! ‚úÖ Explic√≠tamente no permite VLAN 1\n\n! CONFIGURAR EL OTRO EXTREMO (SWITCH CORE)\nCoreSwitch(config)# interface gigabitethernet 0/1  \nCoreSwitch(config-if)# description TRUNK_TO_ACCESS_SWITCH\nCoreSwitch(config-if)# switchport mode trunk\nCoreSwitch(config-if)# switchport trunk native vlan 999\nCoreSwitch(config-if)# switchport trunk allowed vlan 10,20,30,99\n</code></pre>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#configuracion-de-puertos-de-acceso","level":3,"title":"Configuraci√≥n de Puertos de Acceso","text":"<pre><code>! PUERTOS PARA USUARIOS (NO TRUNK)\nSwitch(config)# interface range fastethernet 0/1-8\nSwitch(config-if-range)# switchport mode access\nSwitch(config-if-range)# switchport access vlan 10\nSwitch(config-if-range)# description USUARIOS_VENTAS\n\nSwitch(config)# interface range fastethernet 0/9-16  \nSwitch(config-if-range)# switchport mode access\nSwitch(config-if-range)# switchport access vlan 20\nSwitch(config-if-range)# description USUARIOS_IT\n</code></pre>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#verificacion-y-troubleshooting","level":2,"title":"üìä Verificaci√≥n y Troubleshooting","text":"","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#comandos-de-verificacion","level":3,"title":"Comandos de Verificaci√≥n","text":"<pre><code>! VER ESTADO DE TRUNKS\nSwitch# show interfaces trunk\nPort        Mode         Encapsulation  Status        Native vlan\nGi0/1       on           802.1q         trunking      999\nGi0/2       auto         802.1q         trunking      1\n\nPort        Vlans allowed on trunk\nGi0/1       10,20,30,99\nGi0/2       1-4094\n\n! VER CONFIGURACI√ìN DE INTERFAZ ESPEC√çFICA\nSwitch# show interfaces gigabitethernet 0/1 switchport\nName: Gi0/1\nSwitchport: Enabled\nAdministrative Mode: trunk\nOperational Mode: trunk\nAdministrative Trunking Encapsulation: dot1q\nOperational Trunking Encapsulation: dot1q\nNegotiation of Trunking: On\nAccess Mode VLAN: 1 (default)\nTrunking Native Mode VLAN: 999 (VLAN_BASURA_NATIVA)\nTrunking VLANs Enabled: 10,20,30,99\n\n! VER ESTAD√çSTICAS DE TRUNK\nSwitch# show interfaces gigabitethernet 0/1 trunk\nPort        Vlans allowed on trunk\nGi0/1       10,20,30,99\n\nPort        Vlans allowed and active in management domain\nGi0/1       10,20,30,99\n\nPort        Vlans in spanning tree forwarding state and not pruned\nGi0/1       10,20,30,99\n</code></pre>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#troubleshooting-comun","level":3,"title":"Troubleshooting Com√∫n","text":"<pre><code># PROBLEMA 1: Trunk no se forma\nCAUSA: Mismatch en configuraci√≥n de trunk\nSOLUCI√ìN: Verificar que ambos lados est√©n en \"switchport mode trunk\"\n\n# PROBLEMA 2: VLAN nativa mismatch  \nCAUSA: Diferente VLAN nativa en cada extremo\nS√çNTOMA: P√©rdida de conectividad para VLAN nativa\nSOLUCI√ìN: Configurar misma VLAN nativa en ambos extremos\n\n# PROBLEMA 3: VLAN no permitida en trunk\nCAUSA: VLAN no est√° en \"allowed vlan list\"\nS√çNTOMA: Dispositivos en esa VLAN no pueden comunicarse through trunk\nSOLUCI√ìN: A√±adir VLAN a la lista permitida\n</code></pre>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#resumen-de-conceptos-clave","level":2,"title":"üéØ Resumen de Conceptos Clave","text":"","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#trunk","level":3,"title":"TRUNK:","text":"<pre><code>‚úÖ Transporta M√öLTIPLES VLANs en un solo enlace f√≠sico\n‚úÖ Usa etiquetado 802.1Q para identificar a qu√© VLAN pertenece cada frame\n‚úÖ Esencial para conectar switches en redes con m√∫ltiples VLANs\n‚úÖ Debe configurarse igual en ambos extremos del enlace\n</code></pre>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#vlan-nativa","level":3,"title":"VLAN NATIVA:","text":"<pre><code>‚úÖ √önica VLAN que viaja SIN etiqueta 802.1Q en un trunk\n‚úÖ Por defecto es VLAN 1 (‚ùå INSECURO)\n‚úÖ Mejor pr√°ctica: Usar VLAN no utilizada (ej: 999)\n‚úÖ Debe coincidir en ambos extremos del trunk\n</code></pre>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#mejores-practicas","level":3,"title":"MEJORES PR√ÅCTICAS:","text":"<pre><code>1. ‚úÖ NUNCA usar VLAN 1 para nada\n2. ‚úÖ Usar VLAN dedicada no utilizada como nativa (999, 4094, etc.)\n3. ‚úÖ Limitar VLANs permitidas en trunk solo a las necesarias\n4. ‚úÖ Deshabilitar puertos no utilizados\n5. ‚úÖ Configurar manualmente trunks en lugar de usar auto-negotiation\n6. ‚úÖ Documentar configuraci√≥n de trunks\n</code></pre>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#comandos-explicados-paso-a-paso","level":3,"title":"Comandos Explicados Paso a Paso","text":"<pre><code>! CREACI√ìN DE VLANs\nSwitch# configure terminal\nSwitch(config)# vlan 10\n! El comando 'vlan 10' crea o entra en la configuraci√≥n de la VLAN 10\n! Las VLANs 1-1005 son est√°ndar, 1006-4094 son extendidas\n\nSwitch(config-vlan)# name VENTAS\n! 'name' asigna un nombre descriptivo para identificar la VLAN f√°cilmente\n\nSwitch(config-vlan)# exit\n! Sale del modo de configuraci√≥n de VLAN\n\n! ASIGNACI√ìN DE PUERTOS A VLANs\nSwitch(config)# interface fastethernet 0/1\n! Selecciona el puerto f√≠sico para configurar\n\nSwitch(config-if)# switchport mode access\n! 'switchport mode access' configura el puerto como acceso (solo una VLAN)\n! Esto significa que el dispositivo conectado no espera etiquetas VLAN\n\nSwitch(config-if)# switchport access vlan 10\n! Asigna el puerto espec√≠ficamente a la VLAN 10\n! El dispositivo conectado estar√° en la red l√≥gica de VENTAS\n\n! CONFIGURACI√ìN DE PUERTOS TRUNK\nSwitch(config)# interface gigabitethernet 0/1\nSwitch(config-if)# switchport mode trunk\n! 'switchport mode trunk' configura el puerto para transportar m√∫ltiples VLANs\n! Los trunks usan etiquetas 802.1Q para identificar a qu√© VLAN pertenece cada frame\n\nSwitch(config-if)# switchport trunk native vlan 999\n! 'native vlan' define qu√© VLAN viaja sin etiquetar\n! Por seguridad, NUNCA usar VLAN 1 como nativa\n\nSwitch(config-if)# switchport trunk allowed vlan 10,20,30\n! 'allowed vlan' especifica qu√© VLANs pueden pasar por el trunk\n! Esto proporciona control granular sobre qu√© VLANs se propagan\n\n! VERIFICACI√ìN\nSwitch# show vlan brief\n! Muestra todas las VLANs y qu√© puertos est√°n asignados a cada una\nSwitch# show interfaces trunk\n! Muestra informaci√≥n detallada sobre puertos trunk\n</code></pre>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#ejemplo-practico-completo","level":3,"title":"Ejemplo Pr√°ctico Completo","text":"<pre><code>! ESCENARIO: Empresa con 3 departamentos\nSwitch(config)# vlan 10\nSwitch(config-vlan)# name VENTAS\nSwitch(config-vlan)# exit\n\nSwitch(config)# vlan 20\nSwitch(config-vlan)# name IT\nSwitch(config-vlan)# exit\n\nSwitch(config)# vlan 30\nSwitch(config-vlan)# name CONTABILIDAD\nSwitch(config-vlan)# exit\n\nSwitch(config)# vlan 99\nSwitch(config-vlan)# name ADMINISTRACION\nSwitch(config-vlan)# exit\n\n! Asignar puertos a departamentos\nSwitch(config)# interface range fastethernet 0/1-8\nSwitch(config-if-range)# switchport mode access\nSwitch(config-if-range)# switchport access vlan 10\nSwitch(config-if-range)# description PUERTOS_VENTAS\n\nSwitch(config)# interface range fastethernet 0/9-16\nSwitch(config-if-range)# switchport mode access\nSwitch(config-if-range)# switchport access vlan 20\nSwitch(config-if-range)# description PUERTOS_IT\n\n! Configurar IP de gesti√≥n en VLAN de administraci√≥n\nSwitch(config)# interface vlan 99\nSwitch(config-if)# ip address 192.168.99.10 255.255.255.0\nSwitch(config-if)# no shutdown\n! Esto permite administrar el switch remotamente mediante SSH/Telnet\n</code></pre>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#2-port-security","level":2,"title":"üîí 2. Port Security","text":"","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#concepto-teorico-detallado_1","level":3,"title":"Concepto Te√≥rico Detallado","text":"<p>¬øQu√© es Port Security? Es un mecanismo que restringe qu√© dispositivos pueden conectarse a un puerto del switch bas√°ndose en direcciones MAC.</p> <p></p> <p>Problemas que resuelve:</p> <ul> <li>Conectividad no autorizada: Evita que usuarios conecten dispositivos no autorizados</li> <li>Ataques MAC flooding: Previene que atacantes saturen la tabla MAC</li> <li>Robo de puertos: Impide usar puertos f√≠sicos para acceso no autorizado</li> </ul> <p>Mecanismos de aprendizaje de MAC:</p> <ul> <li>Est√°ticas: Se configuran manualmente</li> <li>Din√°micas: El switch aprende autom√°ticamente</li> <li>Sticky: Combina ambos - aprende y luego las hace est√°ticas</li> </ul>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#comandos-explicados-paso-a-paso_1","level":3,"title":"Comandos Explicados Paso a Paso","text":"<pre><code>! HABILITAR PORT SECURITY B√ÅSICO\nSwitch(config)# interface fastethernet 0/1\nSwitch(config-if)# switchport mode access\n! PRIMERO debe ser puerto de acceso para habilitar port security\n\nSwitch(config-if)# switchport port-security\n! Este comando ACTIVA la funcionalidad de port security en el puerto\n! Sin esto, los dem√°s comandos de port security no funcionar√°n\n\nSwitch(config-if)# switchport port-security maximum 2\n! 'maximum' define el n√∫mero m√°ximo de direcciones MAC permitidas\n! En este caso, permite hasta 2 dispositivos diferentes\n\n! TIPOS DE VIOLACI√ìN - CR√çTICOS PARA ENTENDER\nSwitch(config-if)# switchport port-security violation shutdown\n! 'violation shutdown' - EL M√ÅS SEGURO\n! - Cierra el puerto inmediatamente\n! - Lo coloca en estado err-disable\n! - Requiere intervenci√≥n manual para reactivar\n! - USAR EN ENTORNOS DE ALTA SEGURIDAD\n\nSwitch(config-if)# switchport port-security violation restrict\n! 'violation restrict' - MODO INTERMEDIO\n! - Permite tr√°fico de MACs conocidas\n! - Bloquea tr√°fico de MACs no autorizadas\n! - Genera logs pero mantiene el puerto activo\n! - BUENO para monitoreo sin interrumpir servicio\n\nSwitch(config-if)# switchport port-security violation protect\n! 'violation protect' - MODO MENOS RESTRICTIVO\n! - Solo bloquea frames de MACs no autorizadas\n! - No genera logs de violaci√≥n\n! - PUEDE PASAR DESAPERCIBIDO UN ATAQUE\n\n! M√âTODOS DE APRENDIZAJE DE MAC\nSwitch(config-if)# switchport port-security mac-address sticky\n! 'sticky' - EL M√ÅS PR√ÅCTICO\n! - Aprende las MACs que se conectan inicialmente\n! - Las convierte en direcciones est√°ticas autom√°ticamente\n! - Se guardan en la configuraci√≥n\n! - Perfecto para despliegues iniciales\n\nSwitch(config-if)# switchport port-security mac-address 0000.1111.2222\n! Configuraci√≥n MANUAL de MAC espec√≠fica\n! √ötil para dispositivos cr√≠ticos como impresoras o servidores\n\n! CONFIGURACIONES AVANZADAS\nSwitch(config-if)# switchport port-security aging time 120\n! 'aging time' define cu√°nto tiempo se mantiene una MAC en la tabla\n! 120 minutos = 2 horas\n\nSwitch(config-if)# switchport port-security aging type inactivity\n! 'inactivity' significa que el temporizador corre solo si no hay tr√°fico\n! Alternativa: 'absolute' (tiempo fijo independiente del tr√°fico)\n</code></pre>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#ejemplo-practico-completo_1","level":3,"title":"Ejemplo Pr√°ctico Completo","text":"<pre><code>! ESCENARIO: Oficina con pol√≠ticas de seguridad espec√≠ficas\n\n! Puerto para impresora (1 dispositivo fijo)\nSwitch(config)# interface fastethernet 0/5\nSwitch(config-if)# switchport mode access\nSwitch(config-if)# switchport access vlan 10\nSwitch(config-if)# switchport port-security\nSwitch(config-if)# switchport port-security maximum 1\nSwitch(config-if)# switchport port-security violation shutdown\nSwitch(config-if)# switchport port-security mac-address 0050.56AB.CDEF\nSwitch(config-if)# description IMPRESORA_SALA_VENTAS\n\n! Puerto para usuarios generales (hasta 3 dispositivos)\nSwitch(config)# interface fastethernet 0/10\nSwitch(config-if)# switchport mode access\nSwitch(config-if)# switchport access vlan 20\nSwitch(config-if)# switchport port-security\nSwitch(config-if)# switchport port-security maximum 3\nSwitch(config-if)# switchport port-security violation restrict\nSwitch(config-if)# switchport port-security mac-address sticky\nSwitch(config-if)# switchport port-security aging time 240\nSwitch(config-if)# description PUESTO_TRABAJO_USUARIO\n\n! Configurar recuperaci√≥n autom√°tica de err-disable\nSwitch(config)# errdisable recovery cause psecure-violation\nSwitch(config)# errdisable recovery interval 300\n! Esto reactiva autom√°ticamente puertos despu√©s de 5 minutos\n\n! VERIFICACI√ìN DETALLADA\nSwitch# show port-security\n! Muestra resumen de todos los puertos con port security\n\nSwitch# show port-security interface fastethernet 0/10\n! Muestra detalles espec√≠ficos del puerto:\n! - M√°ximo de direcciones permitidas\n! - Direcciones actualmente aprendidas\n! - Contador de violaciones\n! - Tipo de violaci√≥n configurado\n\nSwitch# show port-security address\n! Muestra la tabla de direcciones MAC seguras aprendidas\n</code></pre>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#3-dhcp-snooping","level":2,"title":"üåê 3. DHCP Snooping","text":"","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#pero-que-es-dhcp","level":2,"title":"¬øPero qu√© es DHCP?","text":"","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#que-es-dhcp","level":3,"title":"üîÑ ¬øQu√© es DHCP?","text":"<p>DHCP (Dynamic Host Configuration Protocol) es el \"servicio de entrega de direcciones\" autom√°tico de las redes. En lugar de configurar manualmente cada dispositivo, DHCP asigna autom√°ticamente:</p> <ul> <li>‚úÖ Direcci√≥n IP</li> <li>‚úÖ M√°scara de subred </li> <li>‚úÖ Gateway por defecto</li> <li>‚úÖ Servidores DNS</li> </ul>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#el-proceso-de-4-pasos-dora","level":2,"title":"üì¶ El Proceso de 4 Pasos (DORA)","text":"","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#1-discover-hay-algun-servidor-dhcp","level":3,"title":"1. üéØ DISCOVER - \"¬øHay alg√∫n servidor DHCP?\"","text":"<p><pre><code>Cliente ‚Üí Broadcast: \"¬°Hola! Necesito una IP, ¬øalguien puede ayudarme?\"\n</code></pre> - El cliente env√≠a broadcast sin IP - Todos los dispositivos en la red local lo reciben</p>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#2-offer-si-te-ofrezco-esta-ip","level":3,"title":"2. üì® OFFER - \"S√≠, te ofrezco esta IP\"","text":"<p><pre><code>Servidor DHCP ‚Üí Cliente: \"Te ofrezco la IP 192.168.1.100\"\n</code></pre> - Servidor reserva una IP disponible - Env√≠a oferta con configuraci√≥n de red</p>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#3-request-acepto-tu-oferta","level":3,"title":"3. üìù REQUEST - \"Acepto tu oferta\"","text":"<p><pre><code>Cliente ‚Üí Broadcast: \"Acepto la IP 192.168.1.100 del servidor X\"\n</code></pre> - Cliente confirma que acepta la IP - Se hace por broadcast por si hay m√∫ltiples servidores</p>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#4-ack-confirmado-usa-esta-ip","level":3,"title":"4. ‚úÖ ACK - \"Confirmado, usa esta IP\"","text":"<p><pre><code>Servidor DHCP ‚Üí Cliente: \"Confirmado, usa 192.168.1.100 por 24 horas\"\n</code></pre> - Confirmaci√≥n final del servidor - Incluye tiempo de arrendamiento (lease time)</p>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#renovacion-de-ip","level":2,"title":"‚è∞ Renovaci√≥n de IP","text":"<pre><code># A LOS 50% DEL TIEMPO DE ARRENDAMIENTO:\nCliente ‚Üí Servidor: \"¬øPuedo seguir usando esta IP?\"\nServidor ‚Üí Cliente: \"S√≠, renuevas por X tiempo m√°s\"\n\n# SI NO HAY RESPUESTA, INTENTA DE NUEVO AL 87.5%\n# SI EXPIRA ‚Üí VUELVE AL PASO 1 (DISCOVER)\n</code></pre>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#en-resumen","level":2,"title":"üéØ En Resumen","text":"<p>DHCP = Sistema autom√°tico que evita tener que configurar manualmente cada dispositivo en la red, asignando y gestionando direcciones IP de forma din√°mica.</p> <p>Funciona como un \"alquiler de direcciones\" con renovaci√≥n autom√°tica.</p>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#que-es-dhcp-snooping","level":3,"title":"¬øQu√© es DHCP Snooping?","text":"<p>La funci√≥n exacta de DHCP Snooping es actuar como un guardi√°n de seguridad que previene ataques DHCP maliciosos mediante la creaci√≥n de una base de datos confiable de asignaciones IP-MAC, diferenciando entre puertos trusted (donde se conectan servidores DHCP leg√≠timos) y untrusted (clientes), bloqueando respuestas DHCP no autorizadas y proporcionando la base de datos que tecnolog√≠as como DAI e IP Source Guard utilizan para validar la legitimidad del tr√°fico ARP y las direcciones IP en la red.</p> <p>En esencia: DHCP Snooping es el sistema de verificaci√≥n de identidades que asegura que solo dispositivos autorizados puedan ofrecer direcciones IP y mantiene un registro confiable de qu√© dispositivo tiene qu√© IP en qu√© puerto. DHCP Snooping es la BASE, DAI es la CAPA DE SEGURIDAD que usa esa base</p>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#analogia-para-entenderlo_1","level":3,"title":"Analog√≠a para Entenderlo","text":"<p>Imagina un edificio con: - Servidores DHCP leg√≠timos = Oficinas de administraci√≥n autorizadas - Clientes DHCP = Inquilinos que necesitan llaves (IPs) - Ataque DHCP Rogue = Alguien fingiendo ser la administraci√≥n - DHCP Snooping = El sistema de seguridad que verifica credenciales</p> <p></p> <p></p>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#problemas-que-resuelve-dhcp-snooping","level":2,"title":"üîç Problemas que Resuelve DHCP Snooping","text":"","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#1-ataque-dhcp-starvation-inanicion","level":3,"title":"1. Ataque DHCP Starvation (Inanici√≥n)","text":"<pre><code># Un atacante env√≠a M√öLTIPLES solicitudes DHCP con MACs falsas\n# Resultado: Agota el pool de IPs del servidor leg√≠timo\n# Clientes leg√≠timos no pueden obtener IP\n</code></pre>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#2-ataque-dhcp-rogue-servidor-falso","level":3,"title":"2. Ataque DHCP Rogue (Servidor Falso)","text":"<pre><code># Atacante configura servidor DHCP no autorizado\n# Ofrece IPs con:\n# - Gateway falso (el atacante)\n# - DNS falso (para redirigir tr√°fico)\n# Resultado: Man-in-the-Middle completo\n</code></pre>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#3-ip-spoofing-suplantacion-de-ip","level":3,"title":"3. IP Spoofing (Suplantaci√≥n de IP)","text":"<pre><code># Clientes usan IPs que no les corresponden\n# Dif√≠cil de rastrear en la red\n# Puede eludir controles de seguridad basados en IP\n</code></pre>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#arquitectura-de-dhcp-snooping","level":2,"title":"üèóÔ∏è Arquitectura de DHCP Snooping","text":"","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#componentes-clave","level":3,"title":"Componentes Clave","text":"<ol> <li> <p>Puertos Trusted (Confiables)</p> <ul> <li>Donde est√°n los servidores DHCP leg√≠timos</li> <li>Aceptan mensajes DHCP de cualquier tipo</li> </ul> </li> <li> <p>Puertos Untrusted (No Confiables)</p> <ul> <li>Donde se conectan clientes</li> <li>Solo aceptan solicitudes DHCP (DISCOVER, REQUEST)</li> <li>Rechazan respuestas DHCP (OFFER, ACK)</li> </ul> </li> <li> <p>Binding Database (Base de Datos de Asignaciones)</p> <ul> <li>Almacena: MAC + IP + VLAN + Puerto + Tiempo de arrendamiento</li> <li>Se usa por DAI y IP Source Guard</li> </ul> </li> </ol>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#configuracion-detallada-paso-a-paso","level":2,"title":"‚öôÔ∏è Configuraci√≥n Detallada Paso a Paso","text":"","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#configuracion-basica","level":3,"title":"Configuraci√≥n B√°sica","text":"<pre><code>! PASO 1: HABILITAR DHCP SNOOPING GLOBALMENTE\nSwitch(config)# ip dhcp snooping\n! Este comando ACTIVA la funcionalidad a nivel global\n! Sin esto, nada de DHCP Snooping funcionar√°\n\n! PASO 2: ESPECIFICAR VLANs DONDE ACTUAR√Å\nSwitch(config)# ip dhcp snooping vlan 10,20,30\n! Solo las VLANs especificadas estar√°n protegidas\n! Puedes usar rangos: vlan 1-100\n\n! PASO 3: CONFIGURAR PUERTOS TRUSTED\nSwitch(config)# interface gigabitethernet 0/1\nSwitch(config-if)# description SERVIDOR_DHCP_LEGITIMO\nSwitch(config-if)# ip dhcp snooping trust\n! MARCA este puerto como confiable para respuestas DHCP\n! Los servidores DHCP leg√≠timos DEBEN estar en puertos trusted\n\n! PASO 4: PUERTOS UNTRUSTED (POR DEFECTO)\nSwitch(config)# interface range fastethernet 0/1-24\nSwitch(config-if-range)# no ip dhcp snooping trust\n! Expl√≠citamente los marca como no confiables\n! Aunque por defecto ya lo son, es buena pr√°ctica\n</code></pre>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#configuracion-avanzada","level":3,"title":"Configuraci√≥n Avanzada","text":"<pre><code>! OPCI√ìN 82 (AGENT INFORMATION OPTION)\nSwitch(config)# ip dhcp snooping information option\n! A√±ade informaci√≥n sobre el switch y puerto donde se origin√≥ la solicitud\n! Ayuda a los servidores DHCP a tomar decisiones basadas en ubicaci√≥n\n\n! LIMITAR TASA DE MENSAJES DHCP\nSwitch(config)# interface fastethernet 0/5\nSwitch(config-if)# ip dhcp snooping limit rate 10\n! Limita a 10 mensajes DHCP por segundo\n! Previene ataques de inundaci√≥n (DHCP starvation)\n\n! CONFIGURACI√ìN DE LA BASE DE DATOS\nSwitch(config)# ip dhcp snooping database flash:dhcp-snooping.txt\nSwitch(config)# ip dhcp snooping database write-delay 15\n! Guarda la base de datos en memoria flash cada 15 segundos\n! Previene p√©rdida de informaci√≥n en reinicios\n</code></pre>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#ejemplos-practicos-de-configuracion","level":2,"title":"üîß Ejemplos Pr√°cticos de Configuraci√≥n","text":"","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#ejemplo-1-pequena-oficina","level":3,"title":"Ejemplo 1: Peque√±a Oficina","text":"<pre><code>! ESCENARIO: 1 servidor DHCP, 24 puertos de usuario\nSwitch(config)# ip dhcp snooping\nSwitch(config)# ip dhcp snooping vlan 10\n\n! Servidor DHCP en puerto Gigabit 0/1\nSwitch(config)# interface gigabitethernet 0/1\nSwitch(config-if)# description SERVIDOR_DHCP\nSwitch(config-if)# ip dhcp snooping trust\n\n! Puertos de usuarios (untrusted por defecto)\nSwitch(config)# interface range fastethernet 0/1-24\nSwitch(config-if-range)# switchport mode access\nSwitch(config-if-range)# switchport access vlan 10\nSwitch(config-if-range)# ip dhcp snooping limit rate 5\n! Limita a 5 mensajes/segundo para prevenir ataques\n</code></pre>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#ejemplo-2-empresa-mediana-con-multiples-vlans","level":3,"title":"Ejemplo 2: Empresa Mediana con M√∫ltiples VLANs","text":"<pre><code>! ESCENARIO: M√∫ltiples departamentos, servidor centralizado\nSwitch(config)# ip dhcp snooping\nSwitch(config)# ip dhcp snooping vlan 10,20,30,99\nSwitch(config)# ip dhcp snooping information option\n\n! Uplink al core donde est√° el servidor DHCP\nSwitch(config)# interface gigabitethernet 0/1\nSwitch(config-if)# description UPLINK_TO_CORE\nSwitch(config-if)# switchport mode trunk\nSwitch(config-if)# ip dhcp snooping trust\n\n! VLAN de Ventas\nSwitch(config)# interface range fastethernet 0/1-8\nSwitch(config-if-range)# switchport access vlan 10\nSwitch(config-if-range)# ip dhcp snooping limit rate 8\n\n! VLAN de IT\nSwitch(config)# interface range fastethernet 0/9-16\nSwitch(config-if-range)# switchport access vlan 20\nSwitch(config-if-range)# ip dhcp snooping limit rate 8\n\n! VLAN de Administraci√≥n\nSwitch(config)# interface range fastethernet 0/17-24\nSwitch(config-if-range)# switchport access vlan 99\nSwitch(config-if-range)# ip dhcp snooping limit rate 8\n</code></pre>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#ejemplo-3-entorno-de-alta-seguridad","level":3,"title":"Ejemplo 3: Entorno de Alta Seguridad","text":"<pre><code>! ESCENARIO: Entorno cr√≠tico con verificaci√≥n estricta\nSwitch(config)# ip dhcp snooping\nSwitch(config)# ip dhcp snooping vlan 1-100\nSwitch(config)# ip dhcp snooping information option\nSwitch(config)# ip dhcp snooping verify mac-address\n! VERIFICA que la MAC origen en DHCP sea la real del cliente\n! Previene suplantaci√≥n de MAC en mensajes DHCP\n\n! Base de datos persistente\nSwitch(config)# ip dhcp snooping database flash:dhcp-snooping.db\nSwitch(config)# ip dhcp snooping database timeout 10\nSwitch(config)# ip dhcp snooping database write-delay 10\n\n! Puertos trusted expl√≠citos\nSwitch(config)# interface range gigabitethernet 0/1-2\nSwitch(config-if-range)# description SERVERS_DHCP_TRUSTED\nSwitch(config-if-range)# ip dhcp snooping trust\n\n! Todos los dem√°s puertos son untrusted con rate limiting estricto\nSwitch(config)# interface range fastethernet 0/1-48\nSwitch(config-if-range)# no ip dhcp snooping trust\nSwitch(config-if-range)# ip dhcp snooping limit rate 5\n! Solo 5 mensajes DHCP por segundo - muy restrictivo\n</code></pre>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#integracion-con-otras-tecnologias-de-seguridad","level":2,"title":"üõ†Ô∏è Integraci√≥n con Otras Tecnolog√≠as de Seguridad","text":"","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#con-dynamic-arp-inspection-dai","level":3,"title":"Con Dynamic ARP Inspection (DAI)","text":"<pre><code>! DHCP Snooping es PRERREQUISITO para DAI\nSwitch(config)# ip dhcp snooping\nSwitch(config)# ip dhcp snooping vlan 10\n\n! DAI usa la tabla de bindings de DHCP Snooping\nSwitch(config)# ip arp inspection vlan 10\nSwitch(config)# ip arp inspection validate src-mac dst-mac ip\n! DAI verifica que las respuestas ARP coincidan con la tabla de DHCP Snooping\n</code></pre>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#con-ip-source-guard","level":3,"title":"Con IP Source Guard","text":"<pre><code>! IP Source Guard tambi√©n depende de DHCP Snooping\nSwitch(config)# ip dhcp snooping\nSwitch(config)# ip dhcp snooping vlan 10\n\nSwitch(config)# interface fastethernet 0/1\nSwitch(config-if)# ip verify source\n! Solo permite tr√°fico de IPs que est√°n en la tabla de DHCP Snooping\n</code></pre>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#comandos-de-verificacion-y-monitoreo","level":2,"title":"üìä Comandos de Verificaci√≥n y Monitoreo","text":"","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#verificacion-basica","level":3,"title":"Verificaci√≥n B√°sica","text":"<pre><code>! VER ESTADO GLOBAL DE DHCP SNOOPING\nSwitch# show ip dhcp snooping\nSwitch DHCP snooping is enabled\nDHCP snooping is configured on following VLANs:\n10,20,30\nDHCP snooping is operational on following VLANs:\n10,20,30\nDHCP snooping is configured on the following L3 Interfaces:\n\nInsertion of option 82 is enabled\n   circuit-id default format: vlan-mod-port\n   remote-id: 0050.5689.ABCD (MAC del switch)\nOption 82 on untrusted port is not allowed\nVerification of hwaddr field is enabled\n\n! MOSTRAR LA TABLA DE BINDINGS\nSwitch# show ip dhcp snooping binding\nMacAddress          IpAddress        Lease(sec)  Type           VLAN  Interface\n------------------  ---------------  ----------  -------------  ----  --------------------\n00:50:56:89:AB:CD   192.168.10.10    86400       dhcp-snooping   10    FastEthernet0/1\n00:50:56:89:AB:CE   192.168.10.11    86320       dhcp-snooping   10    FastEthernet0/2\n00:50:56:89:AB:CF   192.168.20.15    86200       dhcp-snooping   20    FastEthernet0/9\n\n! VER ESTADO DE PUERTOS TRUSTED\nSwitch# show ip dhcp snooping trust\nTrusted | Port | \n------- | ---- | \nyes     | Gi0/1 | \nno      | Fa0/1 | \nno      | Fa0/2 | \n...     | ...  |\n</code></pre>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#estadisticas-y-troubleshooting","level":3,"title":"Estad√≠sticas y Troubleshooting","text":"<pre><code>! ESTAD√çSTICAS DETALLADAS POR INTERFAZ\nSwitch# show ip dhcp snooping interface fastethernet 0/1\nDHCP Snooping is enabled on this interface\nDHCP Snooping trust is disabled\nDHCP Snooping limit rate is 5 packets per second\nDHCP Snooping violation count is 0\n\n! CONTADORES DE MENSAJES DHCP\nSwitch# show ip dhcp snooping statistics\nDHCP Snooping Statistics:\n  Packets Dropped:\n    DHCP Discover: 0\n    DHCP Offer: 15\n    DHCP Request: 0\n    DHCP Ack: 12\n    Others: 3\n  Total Packets Dropped: 30\n\n! VERIFICAR LA BASE DE DATOS\nSwitch# show ip dhcp snooping database\nAgent URL : flash:dhcp-snooping.db\nWrite delay : 15 seconds\nAbort delay : 300 seconds\nAgent running : No\nDelay timer : not running\nReconfigure timer : not running\nLast succeeded : Never\nLast failed : Never\n</code></pre>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#comandos-de-depuracion-debug","level":3,"title":"Comandos de Depuraci√≥n (Debug)","text":"<pre><code>! SOLO USAR EN TROUBLESHOOTING - PUEDE GENERAR MUCHO OUTPUT\nSwitch# debug ip dhcp snooping events\nDHCP_SNOOPING: received new DHCP packet from interface FastEthernet0/1\nDHCP_SNOOPING: process new DHCP packet, message type: DHCPDISCOVER\nDHCP_SNOOPING: packet passed validation check\n\nSwitch# debug ip dhcp snooping packet\nDHCP_SNOOPING: received packet on FastEthernet0/1: \n  OP: 1, HTYPE: 1, HLEN: 6, HOPS: 0\n  XID: 0x45A3F1C2, SECS: 0, FLAGS: 0\n  CIADDR: 0.0.0.0, YIADDR: 0.0.0.0, SIADDR: 0.0.0.0, GIADDR: 0.0.0.0\n  CHADDR: 0050.5689.ABCD\n</code></pre>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#flujo-de-trabajo-completo-de-dhcp-snooping","level":2,"title":"üîÑ Flujo de Trabajo Completo de DHCP Snooping","text":"","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#proceso-paso-a-paso","level":3,"title":"Proceso Paso a Paso","text":"<ol> <li> <p>Inicializaci√≥n: <pre><code>Switch arranca ‚Üí DHCP Snooping deshabilitado por defecto\nAdministrador ejecuta: ip dhcp snooping\nSe crea tabla de bindings vac√≠a\n</code></pre></p> </li> <li> <p>Aprendizaje: <pre><code>Cliente conecta en Fa0/1 (untrusted)\nEnv√≠a DHCP DISCOVER ‚Üí Switch permite (solicitud)\nServidor leg√≠timo en Gi0/1 (trusted) env√≠a DHCP OFFER ‚Üí Switch permite (trusted)\nCliente env√≠a DHCP REQUEST ‚Üí Switch permite\nServidor env√≠a DHCP ACK ‚Üí Switch permite (trusted)\nSwitch a√±ade binding a la tabla: MAC + IP + VLAN + Puerto\n</code></pre></p> </li> <li> <p>Protecci√≥n: <pre><code>Atacante conecta servidor rogue en Fa0/10 (untrusted)\nEnv√≠a DHCP OFFER no solicitado ‚Üí Switch BLOQUEA y registra violaci√≥n\nCliente leg√≠timo solo ve ofertas del servidor autorizado\n</code></pre></p> </li> <li> <p>Mantenimiento: <pre><code>Switch monitorea renewals y expiraciones\nActualiza tabla de bindings autom√°ticamente\nGuarda base de datos peri√≥dicamente en memoria no vol√°til\n</code></pre></p> </li> </ol>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#mejores-practicas-y-recomendaciones","level":2,"title":"üí° Mejores Pr√°cticas y Recomendaciones","text":"","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#configuracion-recomendada","level":3,"title":"Configuraci√≥n Recomendada","text":"<pre><code>! CONFIGURACI√ìN √ìPTIMA PARA ENTORNOS CORPORATIVOS\nSwitch(config)# ip dhcp snooping\nSwitch(config)# ip dhcp snooping vlan [TODAS_LAS_VLANs_CON_CLIENTES]\nSwitch(config)# ip dhcp snooping information option\nSwitch(config)# ip dhcp snooping verify mac-address\nSwitch(config)# ip dhcp snooping database flash:dhcp-snooping.db\nSwitch(config)# ip dhcp snooping database write-delay 15\n\n! PUERTOS TRUSTED - SOLO DONDE HAY SERVIDORES DHCP LEG√çTIMOS\nSwitch(config)# interface [PUERTOS_A_SERVIDORES_DHCP]\nSwitch(config-if)# ip dhcp snooping trust\n\n! PUERTOS UNTRUSTED - TODOS LOS DEM√ÅS\nSwitch(config)# interface range [TODOS_LOS_PUERTOS_DE_CLIENTES]\nSwitch(config-if-range)# no ip dhcp snooping trust\nSwitch(config-if-range)# ip dhcp snooping limit rate 10\n</code></pre>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#consideraciones-importantes","level":3,"title":"Consideraciones Importantes","text":"<ol> <li> <p>Planificaci√≥n:</p> <ul> <li>Implementar en ventana de mantenimiento</li> <li>Comenzar en VLANs de prueba</li> <li>Tener rollback plan</li> </ul> </li> <li> <p>Rendimiento:</p> <ul> <li>Rate limiting muy bajo puede afectar clientes leg√≠timos</li> <li>Base de datos grande puede consumir memoria</li> </ul> </li> <li> <p>Compatibilidad:</p> <ul> <li>Verificar que dispositivos legados funcionen</li> <li>Algunos dispositivos IoT pueden tener comportamientos DHCP extra√±os</li> </ul> </li> <li> <p>Monitoreo:</p> <ul> <li>Configurar SNMP traps para violaciones</li> <li>Monitorear contadores de paquetes descartados</li> <li>Revisar logs regularmente</li> </ul> </li> </ol>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#resumen-final","level":2,"title":"üéØ Resumen Final","text":"<p>DHCP Snooping es la base fundamental para:</p> <ul> <li>‚úÖ Prevenir servidores DHCP no autorizados</li> <li>‚úÖ Construir la tabla de bindings para DAI e IP Source Guard</li> <li>‚úÖ Detectar y prevenir ataques de inundaci√≥n DHCP</li> <li>‚úÖ Mejorar la trazabilidad de dispositivos en la red</li> </ul> <p>Sin DHCP Snooping, las dem√°s tecnolog√≠as de seguridad (DAI, IP Source Guard) no pueden funcionar correctamente.</p>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#3-dynamic-arp-inspection-dai","level":2,"title":"üõ°Ô∏è 3. Dynamic ARP Inspection (DAI)","text":"","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#concepto-teorico-detallado_2","level":3,"title":"Concepto Te√≥rico Detallado","text":"<p>¬øQu√© es DAI? Es un mecanismo de seguridad que previene ataques ARP spoofing validando paquetes ARP en la red.</p> <p>Problema del ARP:</p> <ul> <li>ARP no tiene autenticaci√≥n ‚Üí Cualquiera puede enviar respuestas ARP</li> <li>ARP poisoning: Atacante se hace pasar por el gateway</li> <li>Man-in-the-middle: Intercepta tr√°fico entre v√≠ctima y gateway</li> </ul> <p>C√≥mo funciona DAI:</p> <ol> <li>Intercepta todos los paquetes ARP</li> <li>Valida contra base de datos confiable (DHCP Snooping)</li> <li>Descarta paquetes ARP no v√°lidos</li> <li>Registra intentos de violaci√≥n</li> </ol> <p>DAI utiliza la tabla de DHCP Snooping EXCLUSIVAMENTE cuando recibe un ARP Response (Respuesta ARP)</p>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#comandos-explicados-paso-a-paso_2","level":3,"title":"Comandos Explicados Paso a Paso","text":"<pre><code>! CONFIGURACI√ìN B√ÅSICA DE DAI\nSwitch(config)# ip arp inspection vlan 10,20\n! Habilita DAI para las VLANs especificadas\n! Sin este comando, DAI no est√° activo en ninguna VLAN\n\n! DEFINIR PUERTOS TRUSTED (CONFIABLES)\nSwitch(config)# interface gigabitethernet 0/1\nSwitch(config-if)# ip arp inspection trust\n! Los puertos 'trusted' NO son inspeccionados por DAI\n! USAR SOLO en: routers, servidores, switches superiores\n! NUNCA en puertos de usuarios finales\n\n! VALIDACIONES ESPEC√çFICAS\nSwitch(config)# ip arp inspection validate src-mac dst-mac ip\n! 'src-mac' - Verifica que MAC origen en ARP = MAC origen en Ethernet\n! 'dst-mac' - Verifica que MAC destino en ARP = MAC destino en Ethernet  \n! 'ip' - Verifica direcciones IP v√°lidas (no 0.0.0.0, 255.255.255.255, etc.)\n\n! RATE LIMITING - CR√çTICO PARA PREVENIR DOS\nSwitch(config)# interface fastethernet 0/5\nSwitch(config-if)# ip arp inspection limit rate 15\n! Limita a 15 paquetes ARP por segundo\n! Paquetes excedentes son descartados\n! Previene flood de ARP que podr√≠a saturar la CPU\n</code></pre>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#configuracion-integrada-con-dhcp-snooping","level":3,"title":"Configuraci√≥n Integrada con DHCP Snooping","text":"<pre><code>! PRIMERO: Configurar DHCP Snooping (requisito para DAI)\nSwitch(config)# ip dhcp snooping\n! Habilita la funcionalidad global de DHCP Snooping\n\nSwitch(config)# ip dhcp snooping vlan 10,20\n! Especifica en qu√© VLANs actuar√° DHCP Snooping\n\nSwitch(config)# interface gigabitethernet 0/1\nSwitch(config-if)# ip dhcp snooping trust\n! Puertos trusted para DHCP (hacia servidores DHCP leg√≠timos)\n\n! SEGUNDO: Configurar DAI que usa la tabla de DHCP Snooping\nSwitch(config)# ip arp inspection vlan 10,20\n! DAI usar√° la tabla de bindings de DHCP Snooping para validar\n\nSwitch(config)# ip arp inspection log-buffer entries 1024\n! Buffer para almacenar logs de violaciones ARP\n\nSwitch(config)# ip arp inspection log-buffer logs 10 interval 60\n! Genera logs cada 60 segundos si hay m√°s de 10 violaciones\n\n! CONFIGURACI√ìN POR PUERTO DE USUARIO\nSwitch(config)# interface range fastethernet 0/1-24\nSwitch(config-if-range)# switchport mode access\nSwitch(config-if-range)# ip arp inspection limit rate 10\n! Todos los puertos de usuario tienen rate limiting\n! Por defecto son untrusted (inspeccionados)\n</code></pre>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#ejemplo-practico-completo_2","level":3,"title":"Ejemplo Pr√°ctico Completo","text":"<pre><code>! ESCENARIO: Red corporativa con m√∫ltiples VLANs\n\n! 1. Configurar DHCP Snooping\nSwitch(config)# ip dhcp snooping\nSwitch(config)# ip dhcp snooping vlan 10,20,30\nSwitch(config)# ip dhcp snooping information option\n! 'information option' a√±ade informaci√≥n adicional (option 82)\n\n! 2. Definir puertos trusted\nSwitch(config)# interface gigabitethernet 0/1\nSwitch(config-if)# description UPLINK_TO_CORE_SWITCH\nSwitch(config-if)# ip dhcp snooping trust\nSwitch(config-if)# ip arp inspection trust\n\nSwitch(config)# interface gigabitethernet 0/2  \nSwitch(config-if)# description LINK_TO_DHCP_SERVER\nSwitch(config-if)# ip dhcp snooping trust\nSwitch(config-if)# ip arp inspection trust\n\n! 3. Configurar DAI\nSwitch(config)# ip arp inspection vlan 10,20,30\nSwitch(config)# ip arp inspection validate src-mac dst-mac ip\nSwitch(config)# ip arp inspection log-buffer entries 2048\n\n! 4. Configurar puertos de usuario\nSwitch(config)# interface range fastethernet 0/1-48\nSwitch(config-if-range)# switchport mode access\nSwitch(config-if-range)# ip arp inspection limit rate 15\nSwitch(config-if-range)# no ip dhcp snooping trust\n! Expl√≠citamente configurados como untrusted\n\n! VERIFICACI√ìN\nSwitch# show ip arp inspection\n! Muestra configuraci√≥n global de DAI\n\nSwitch# show ip arp inspection statistics\n! Muestra contadores de paquetes procesados y descartados\n\nSwitch# show ip dhcp snooping binding\n! Muestra la tabla de bindings IP-MAC-puerto\n! ESTA TABLA ES LA QUE USA DAI PARA VALIDAR\n\nSwitch# show ip arp inspection interface fastethernet 0/10\n! Muestra estad√≠sticas espec√≠ficas por puerto\n</code></pre>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#4-bpdu-guard-bpdu-filter","level":2,"title":"üåâ 4. BPDU Guard &amp; BPDU Filter","text":"","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#concepto-teorico-detallado_3","level":3,"title":"Concepto Te√≥rico Detallado","text":"<p>¬øQu√© son las BPDUs? BPDU (Bridge Protocol Data Units) son mensajes que intercambian los switches para construir y mantener el spanning-tree.</p> <p>Problemas que resuelven:</p> <ul> <li>Switches no autorizados: Usuario conecta un switch casero</li> <li>Bucles de red: Configuraciones incorrectas crean loops</li> <li>Interrupciones de servicio: Topolog√≠a STP cambia inesperadamente</li> </ul>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#bpdu-guard-explicacion-detallada","level":3,"title":"BPDU Guard - Explicaci√≥n Detallada","text":"<p>Prop√≥sito: Proteger puertos de acceso contra recepci√≥n de BPDUs</p> <p>Comportamiento: - Si recibe BPDU ‚Üí err-disable inmediato - Ideal para puertos con usuarios finales - Se activa solo en puertos con PortFast</p>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#comandos-bpdu-guard","level":3,"title":"Comandos BPDU Guard","text":"<pre><code>! M√âTODO 1: Global (recomendado para consistencia)\nSwitch(config)# spanning-tree portfast bpduguard default\n! Aplica BPDU Guard autom√°ticamente a TODOS los puertos con PortFast\n! M√âTODO M√ÅS EFICIENTE para despliegues grandes\n\n! M√âTODO 2: Por interfaz\nSwitch(config)# interface fastethernet 0/1\nSwitch(config-if)# spanning-tree portfast\n! PortFast salta estados temporales (listening/learning)\nSwitch(config-if)# spanning-tree bpduguard enable\n! Habilita BPDU Guard espec√≠ficamente en este puerto\n\n! RECUPERACI√ìN AUTOM√ÅTICA\nSwitch(config)# errdisable recovery cause bpduguard\nSwitch(config)# errdisable recovery interval 300\n! Reactiva puertos autom√°ticamente despu√©s de 5 minutos\n</code></pre>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#bpdu-filter-explicacion-detallada","level":3,"title":"BPDU Filter - Explicaci√≥n Detallada","text":"<p>Prop√≥sito: Silenciar BPDUs en puertos espec√≠ficos</p> <p>Comportamiento:</p> <ul> <li>Bloquea env√≠o y recepci√≥n de BPDUs</li> <li>Peligroso: Puede crear bucles si no se usa correctamente</li> <li>Caso de uso: Conectar dispositivos que env√≠an BPDUs pero no deben participar en STP</li> </ul>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#comandos-bpdu-filter","level":3,"title":"Comandos BPDU Filter","text":"<pre><code>! M√âTODO 1: Global\nSwitch(config)# spanning-tree portfast bpdufilter default\n! Aplica BPDU Filter a todos los puertos con PortFast\n! CUIDADO: Puede causar bucles si se conecta un switch\n\n! M√âTODO 2: Por interfaz\nSwitch(config)# interface fastethernet 0/2\nSwitch(config-if)# spanning-tree bpdufilter enable\n! Habilita BPDU Filter espec√≠ficamente en este puerto\n</code></pre>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#ejemplo-practico-cuando-usar-cada-uno","level":3,"title":"Ejemplo Pr√°ctico: Cu√°ndo Usar Cada Uno","text":"<pre><code>! ESCENARIO: Oficina con diferentes tipos de puertos\n\n! 1. Puertos de usuario normal - USAR BPDU GUARD\nSwitch(config)# interface range fastethernet 0/1-20\nSwitch(config-if-range)# switchport mode access\nSwitch(config-if-range)# spanning-tree portfast\nSwitch(config-if-range)# spanning-tree bpduguard enable\nSwitch(config-if-range)# description USUARIOS_FINALES\n! Si alguien conecta un switch, el puerto se desactiva\n\n! 2. Servidor que env√≠a BPDUs - USAR BPDU FILTER\nSwitch(config)# interface fastethernet 0/21\nSwitch(config-if)# switchport mode access  \nSwitch(config-if)# spanning-tree bpdufilter enable\nSwitch(config-if)# description SERVIDOR_VMWARE\n! El servidor puede enviar BPDUs pero no queremos que participe en STP\n\n! 3. Configuraci√≥n global de seguridad\nSwitch(config)# spanning-tree portfast bpduguard default\n! Para todos los nuevos puertos con PortFast\n\nSwitch(config)# errdisable recovery cause bpduguard\nSwitch(config)# errdisable recovery interval 600\n! Recuperaci√≥n autom√°tica despu√©s de 10 minutos\n\n! VERIFICACI√ìN\nSwitch# show spanning-tree summary\n! Muestra estado global de spanning-tree incluyendo BPDU Guard/Filter\n\nSwitch# show spanning-tree interface fastethernet 0/1 detail\n! Muestra configuraci√≥n espec√≠fica de BPDU Guard/Filter por puerto\n\nSwitch# show errdisable recovery\n! Muestra configuraci√≥n de recuperaci√≥n autom√°tica\n</code></pre>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#5-ip-source-guard","level":2,"title":"üîç 5. IP Source Guard","text":"","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#concepto-teorico-detallado_4","level":3,"title":"Concepto Te√≥rico Detallado","text":"<p>¬øQu√© es IP Source Guard? Es un mecanismo que filtra tr√°fico IP bas√°ndose en la tabla de bindings de DHCP Snooping.</p> <p>Problemas que resuelve:</p> <ul> <li>IP spoofing: Usuario usa IP que no le pertenece</li> <li>Ataques DoS: Dispositivos maliciosos suplantando IPs</li> <li>Robo de servicios: Usar IPs de otros departamentos</li> </ul> <p>C√≥mo funciona:</p> <ol> <li>Aprende bindings IP-MAC de DHCP Snooping</li> <li>Instala filtros en hardware del switch</li> <li>Permite solo tr√°fico de IPs autorizadas</li> <li>Actualiza din√°micamente cuando expiran leases DHCP</li> </ol>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#comandos-explicados-paso-a-paso_3","level":3,"title":"Comandos Explicados Paso a Paso","text":"<pre><code>! PRERREQUISITO: DHCP Snooping debe estar configurado\nSwitch(config)# ip dhcp snooping\nSwitch(config)# ip dhcp snooping vlan 10\n\n! CONFIGURACI√ìN B√ÅSICA DE IP SOURCE GUARD\nSwitch(config)# interface fastethernet 0/1\nSwitch(config-if)# ip verify source\n! Habilita verificaci√≥n de direcci√≥n IP origen\n! Solo permite tr√°fico de IPs que est√°n en la tabla de DHCP Snooping\n\n! CONFIGURACI√ìN AVANZADA CON VERIFICACI√ìN MAC\nSwitch(config-if)# ip verify source port-security\n! 'port-security' a√±ade verificaci√≥n de direcci√≥n MAC tambi√©n\n! M√°s seguro pero requiere que Port Security est√© configurado\n\nSwitch(config-if)# ip verify source vlan dhcp-snooping port-security\n! Verificaci√≥n completa: IP + MAC + VLAN\n! M√ÅXIMA SEGURIDAD pero m√°s complejo de implementar\n</code></pre>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#ejemplo-practico-completo_3","level":3,"title":"Ejemplo Pr√°ctico Completo","text":"<pre><code>! ESCENARIO: Red segura con validaci√≥n m√∫ltiple\n\n! 1. CONFIGURAR DHCP SNOOPING (BASE PARA TODO)\nSwitch(config)# ip dhcp snooping\nSwitch(config)# ip dhcp snooping vlan 10,20\nSwitch(config)# ip dhcp snooping information option\n\n! Definir puertos trusted\nSwitch(config)# interface gigabitethernet 0/1\nSwitch(config-if)# ip dhcp snooping trust\nSwitch(config-if)# description TO_DHCP_SERVER\n\n! 2. CONFIGURAR PORT SECURITY\nSwitch(config)# interface range fastethernet 0/1-24\nSwitch(config-if-range)# switchport mode access\nSwitch(config-if-range)# switchport port-security\nSwitch(config-if-range)# switchport port-security maximum 2\nSwitch(config-if-range)# switchport port-security violation restrict\nSwitch(config-if-range)# switchport port-security mac-address sticky\n\n! 3. CONFIGURAR IP SOURCE GUARD\nSwitch(config)# interface range fastethernet 0/1-24\nSwitch(config-if-range)# ip verify source port-security\n! Verifica tanto IP como direcci√≥n MAC\n! Solo permite tr√°fico de dispositivos con binding v√°lido\n\n! 4. CONFIGURACI√ìN ALTERNATIVA PARA DISPOSITIVOS EST√ÅTICOS\nSwitch(config)# interface fastethernet 0/25\nSwitch(config-if)# description SERVIDOR_ESTATICO\nSwitch(config-if)# switchport mode access\nSwitch(config-if)# switchport port-security\nSwitch(config-if)# switchport port-security mac-address 0050.5687.1234\nSwitch(config-if)# ip verify source\n! Para servidores con IP est√°tica, solo verificaci√≥n de IP\n\n! VERIFICACI√ìN COMPLETA\nSwitch# show ip verify source\n! Muestra tabla de bindings activos y estado de verificaci√≥n\n\nSwitch# show ip source binding\n! Muestra toda la tabla de bindings IP-MAC-VLAN\n\nSwitch# show ip dhcp snooping binding\n! Muestra bindings aprendidos via DHCP\n\nSwitch# show port-security address\n! Muestra direcciones MAC seguras\n\n! MONITOREO EN TIEMPO REAL\nSwitch# debug ip dhcp snooping events\n! Para troubleshooting detallado (usar con cuidado en producci√≥n)\n</code></pre>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#configuracion-integrada-completa","level":2,"title":"üèóÔ∏è CONFIGURACI√ìN INTEGRADA COMPLETA","text":"","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#switch-de-acceso-corporativo-seguro","level":3,"title":"Switch de Acceso Corporativo Seguro","text":"<pre><code>! INICIALIZACI√ìN B√ÅSICA\nSwitch&gt; enable\nSwitch# configure terminal\nSwitch(config)# hostname SW-ACCESO-01\n\n! CONFIGURACI√ìN DE VLANs\nSW-ACCESO-01(config)# vlan 10\nSW-ACCESO-01(config-vlan)# name USUARIOS\nSW-ACCESO-01(config-vlan)# vlan 20\nSW-ACCESO-01(config-vlan)# name SERVIDORES\nSW-ACCESO-01(config-vlan)# vlan 99\nSW-ACCESO-01(config-vlan)# name ADMIN\nSW-ACCESO-01(config-vlan)# vlan 999\nSW-ACCESO-01(config-vlan)# name NATIVA\nSW-ACCESO-01(config-vlan)# exit\n\n! CONFIGURACI√ìN DE ADMINISTRACI√ìN\nSW-ACCESO-01(config)# interface vlan 99\nSW-ACCESO-01(config-if)# ip address 192.168.99.10 255.255.255.0\nSW-ACCESO-01(config-if)# no shutdown\nSW-ACCESO-01(config-if)# exit\n\n! CONFIGURACI√ìN DE PUERTOS UPLINK (TRUSTED)\nSW-ACCESO-01(config)# interface gigabitethernet 0/1\nSW-ACCESO-01(config-if)# description UPLINK_TO_CORE_SWITCH\nSW-ACCESO-01(config-if)# switchport mode trunk\nSW-ACCESO-01(config-if)# switchport trunk native vlan 999\nSW-ACCESO-01(config-if)# switchport trunk allowed vlan 10,20,99\nSW-ACCESO-01(config-if)# ip dhcp snooping trust\nSW-ACCESO-01(config-if)# ip arp inspection trust\nSW-ACCESO-01(config-if)# spanning-tree guard root\nSW-ACCESO-01(config-if)# no shutdown\n\n! CONFIGURACI√ìN DE PUERTOS DE USUARIO (UNTRUSTED)\nSW-ACCESO-01(config)# interface range fastethernet 0/1-24\nSW-ACCESO-01(config-if-range)# description PUERTOS_USUARIOS\nSW-ACCESO-01(config-if-range)# switchport mode access\nSW-ACCESO-01(config-if-range)# switchport access vlan 10\nSW-ACCESO-01(config-if-range)# switchport port-security\nSW-ACCESO-01(config-if-range)# switchport port-security maximum 3\nSW-ACCESO-01(config-if-range)# switchport port-security violation shutdown\nSW-ACCESO-01(config-if-range)# switchport port-security mac-address sticky\nSW-ACCESO-01(config-if-range)# switchport port-security aging time 120\nSW-ACCESO-01(config-if-range)# spanning-tree portfast\nSW-ACCESO-01(config-if-range)# spanning-tree bpduguard enable\nSW-ACCESO-01(config-if-range)# ip verify source port-security\nSW-ACCESO-01(config-if-range)# ip arp inspection limit rate 15\nSW-ACCESO-01(config-if-range)# no ip dhcp snooping trust\nSW-ACCESO-01(config-if-range)# no shutdown\n\n! CONFIGURACI√ìN DE PUERTOS DE SERVIDORES\nSW-ACCESO-01(config)# interface range gigabitethernet 0/2-4\nSW-ACCESO-01(config-if-range)# description SERVIDORES\nSW-ACCESO-01(config-if-range)# switchport mode access\nSW-ACCESO-01(config-if-range)# switchport access vlan 20\nSW-ACCESO-01(config-if-range)# switchport port-security\nSW-ACCESO-01(config-if-range)# switchport port-security maximum 1\nSW-ACCESO-01(config-if-range)# switchport port-security violation shutdown\nSW-ACCESO-01(config-if-range)# spanning-tree portfast\nSW-ACCESO-01(config-if-range)# spanning-tree bpduguard enable\nSW-ACCESO-01(config-if-range)# ip verify source\nSW-ACCESO-01(config-if-range)# no shutdown\n\n! CONFIGURACIONES GLOBALES DE SEGURIDAD\nSW-ACCESO-01(config)# ip dhcp snooping\nSW-ACCESO-01(config)# ip dhcp snooping vlan 10,20\nSW-ACCESO-01(config)# ip dhcp snooping information option\n\nSW-ACCESO-01(config)# ip arp inspection vlan 10,20\nSW-ACCESO-01(config)# ip arp inspection validate src-mac dst-mac ip\nSW-ACCESO-01(config)# ip arp inspection log-buffer entries 1024\n\nSW-ACCESO-01(config)# spanning-tree portfast bpduguard default\nSW-ACCESO-01(config)# spanning-tree portfast bpdufilter default\n\n! RECUPERACI√ìN AUTOM√ÅTICA\nSW-ACCESO-01(config)# errdisable recovery cause all\nSW-ACCESO-01(config)# errdisable recovery interval 600\n\n! GUARDAR CONFIGURACI√ìN\nSW-ACCESO-01(config)# end\nSW-ACCESO-01# copy running-config startup-config\n</code></pre>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#comandos-de-verificacion-y-monitoreo_1","level":3,"title":"Comandos de Verificaci√≥n y Monitoreo","text":"<pre><code>! VERIFICACI√ìN COMPLETA DEL ESTADO\nSW-ACCESO-01# show running-config\nSW-ACCESO-01# show vlan brief\nSW-ACCESO-01# show interfaces status\n\n! VERIFICACI√ìN DE SEGURIDAD\nSW-ACCESO-01# show port-security\nSW-ACCESO-01# show port-security address\nSW-ACCESO-01# show ip dhcp snooping\nSW-ACCESO-01# show ip arp inspection\nSW-ACCESO-01# show ip verify source\n\n! ESTAD√çSTICAS Y MONITOREO\nSW-ACCESO-01# show interface counters errors\nSW-ACCESO-01# show errdisable recovery\nSW-ACCESO-01# show logging\n\n! TROUBLESHOOTING ESPEC√çFICO\nSW-ACCESO-01# show mac address-table interface fastethernet 0/1\nSW-ACCESO-01# show ip dhcp snooping binding\nSW-ACCESO-01# show spanning-tree interface fastethernet 0/1 detail\n</code></pre>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#resumen-final-de-mejores-practicas","level":2,"title":"üéØ RESUMEN FINAL DE MEJORES PR√ÅCTICAS","text":"","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#recomendaciones-por-tecnologia","level":3,"title":"Recomendaciones por Tecnolog√≠a:","text":"<ol> <li> <p>VLANs:</p> <ul> <li>Nunca usar VLAN 1 para tr√°fico de usuario</li> <li>VLAN nativa diferente para cada trunk</li> <li>Segmentar por funci√≥n, no solo por ubicaci√≥n</li> </ul> </li> <li> <p>Port Security:</p> <ul> <li>Usar \"violation shutdown\" en entornos seguros</li> <li>\"sticky\" para despliegues iniciales</li> <li>Rate limiting en puertos de alta densidad</li> </ul> </li> <li> <p>DAI:</p> <ul> <li>Siempre con DHCP Snooping primero</li> <li>Rate limiting esencial para prevenir DoS</li> <li>Validaci√≥n completa (src-mac + dst-mac + ip)</li> </ul> </li> <li> <p>BPDU Guard:</p> <ul> <li>Global + PortFast para consistencia</li> <li>Recuperaci√≥n autom√°tica configurada</li> <li>Nunca en puertos trunk</li> </ul> </li> <li> <p>IP Source Guard:</p> <ul> <li>Requiere DHCP Snooping funcionando</li> <li>\"port-security\" para m√°xima seguridad</li> <li>Monitorizar bindings regularmente</li> </ul> </li> </ol>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#flujo-de-implementacion-recomendado","level":3,"title":"Flujo de Implementaci√≥n Recomendado:","text":"<ol> <li>VLANs y segmentaci√≥n</li> <li>Port Security b√°sica</li> <li>DHCP Snooping</li> <li>DAI con validaciones</li> <li>BPDU Guard</li> <li>IP Source Guard</li> <li>Verificaci√≥n y ajuste</li> </ol>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#portfast","level":2,"title":"Portfast","text":"<p>PortFast es una funcionalidad de los switches Cisco que se configura en puertos de acceso que conectan estaciones de trabajo finales (como PCs, impresoras, servidores) y nunca otros switches o dispositivos de red. ¬øQu√© hace PortFast?</p> <pre><code>Objetivo principal: Acelerar el inicio de un puerto cuando se enciende un dispositivo conectado a √©l.\n\nFuncionamiento normal (sin PortFast): Cuando un puerto de switch se activa, el protocolo Spanning Tree (STP) pasa por una serie de estados antes de permitir el tr√°fico de datos:\nBloqueando ‚Üí Escuchando ‚Üí Aprendiendo ‚Üí Reenv√≠o\nEste proceso puede tomar unos 30 segundos.\n\nFuncionamiento con PortFast: El puerto se salta los estados de \"Escuchando\" y \"Aprendiendo\" y pasa inmediatamente al estado de \"Reenv√≠o\", permitiendo el tr√°fico casi al instante.\n</code></pre> <p>Analog√≠a R√°pida</p> <pre><code>Sin PortFast: Es como arrancar un coche en un d√≠a fr√≠o: dejar que el motor se caliente antes de poder circular.\n\nCon PortFast: Es como tener el coche ya caliente y listo para circular en cuanto giras la llave.\n</code></pre> <p>Puntos Clave y Advertencias</p> <pre><code>¬øD√≥nde se usa? Solo en puertos de acceso que conectan dispositivos finales.\n\n¬øQu√© evita? La espera de 30 segundos para que un usuario obtenga una direcci√≥n IP (DHCP) o pueda empezar a navegar.\n\n¬°ADVERTENCIA CRUCIAL! NUNCA actives PortFast en un puerto que conecte a otro switch, hub o router. Esto podr√≠a crear bucles de capa 2 en la red, ya que STP no tendr√≠a tiempo de detectarlos y bloquearlos.\n</code></pre> <p>Relaci√≥n con BPDU Guard</p> <p>PortFast suele ir de la mano con BPDU Guard. Si un usuario conecta por error un switch a un puerto con PortFast, BPDU Guard detectar√° el paquete BPDU (propio de STP) y desactivar√° el puerto inmediatamente, evitando as√≠ un posible bucle. Es el \"seguro de seguridad\" de PortFast.</p> <p>En resumen: PortFast es una optimizaci√≥n para puertos de usuarios finales que acelera el acceso a la red, salt√°ndose los lentos estados de STP.</p>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#configuracion-de-portfast","level":3,"title":"Configuraci√≥n de PortFast","text":"","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#1-por-interfaz-recomendado","level":4,"title":"1. Por interfaz (recomendado)","text":"<pre><code>Switch# configure terminal\nSwitch(config)# interface [tipo-n√∫mero]  # Ej: gigabitethernet 0/1\nSwitch(config-if)# spanning-tree portfast\n</code></pre> <p>Para habilitar BPDU Guard en la misma interfaz: <pre><code>Switch(config-if)# spanning-tree bpduguard enable\n</code></pre></p>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#2-de-forma-global-mas-rapido","level":4,"title":"2. De forma global (m√°s r√°pido)","text":"<p>Habilita PortFast en todas las interfaces que no son trunk y est√°n en estado connected: <pre><code>Switch# configure terminal\nSwitch(config)# spanning-tree portfast default\n</code></pre></p> <p>Para habilitar BPDU Guard de forma global: <pre><code>Switch(config)# spanning-tree portfast bpduguard default\n</code></pre></p>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#verificacion","level":3,"title":"Verificaci√≥n","text":"<p><pre><code>Switch# show spanning-tree interface [tipo-n√∫mero] detail\n</code></pre> Busca en la salida: - <code>Portfast enabled</code> - <code>Bpdu guard enabled</code></p>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#comandos-importantes-para-aclarar-dudas","level":3,"title":"Comandos importantes para aclarar dudas","text":"<p>¬øLa interfaz es de acceso o trunk? <pre><code>Switch# show interfaces [tipo-n√∫mero] switchport\n</code></pre></p> <p>¬øSe han recibido BPDUs en el puerto? <pre><code>Switch# show spanning-tree interface [tipo-n√∫mero] detail\n</code></pre></p> <p>Si BPDU Guard desactiva un puerto: <pre><code>Switch# show interfaces status err-disabled\nSwitch# enable\nSwitch# configure terminal\nSwitch(config)# interface [tipo-n√∫mero]\nSwitch(config-if)# shutdown\nSwitch(config-if)# no shutdown\n</code></pre></p>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#recordatorio-importante","level":3,"title":"‚ö†Ô∏è Recordatorio importante","text":"<p>SOLO uses PortFast en puertos que conecten dispositivos finales (PCs, impresoras, servidores). NUNCA en puertos que conecten a otros switches, routers o puntos de acceso inal√°mbricos, ya que podr√≠as causar bucles en la red.</p> <p>La combinaci√≥n PortFast + BPDU Guard es la pr√°ctica m√°s segura y com√∫n.</p>","path":["üöÄ Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"cheatsheet_routers/","level":1,"title":"Cheatsheet routers","text":"<p>¬°Claro! Aqu√≠ tienes una cheatsheet completa con comandos b√°sicos de configuraci√≥n en routers Cisco, ideal para quienes est√°n empezando.</p>","path":["Cheatsheet routers"],"tags":[]},{"location":"cheatsheet_routers/#cheatsheet-configuracion-basica-router-cisco","level":2,"title":"üöÄ Cheatsheet: Configuraci√≥n B√°sica Router Cisco","text":"","path":["Cheatsheet routers"],"tags":[]},{"location":"cheatsheet_routers/#1-modos-de-operacion","level":3,"title":"1. Modos de Operaci√≥n","text":"<pre><code>User EXEC Mode        &gt; \nPrivileged EXEC Mode  # enable\nGlobal Config Mode    # configure terminal\nInterface Config Mode (config-if)# interface &lt;tipo&gt; &lt;n√∫m&gt;\nLine Config Mode      (config-line)# line &lt;tipo&gt; &lt;n√∫m&gt;\n</code></pre>","path":["Cheatsheet routers"],"tags":[]},{"location":"cheatsheet_routers/#2-comandos-basicos-de-navegacion","level":3,"title":"2. Comandos B√°sicos de Navegaci√≥n","text":"<pre><code># Entrar a modo privilegiado\n&gt; enable\n\n# Entrar a configuraci√≥n global\n# configure terminal\n\n# Salir de un modo o guardar config\n(config)# exit\n(config)# end\n# write memory       # Guardar configuraci√≥n\n# copy running-config startup-config\n</code></pre>","path":["Cheatsheet routers"],"tags":[]},{"location":"cheatsheet_routers/#3-configuracion-de-passwords","level":3,"title":"3. Configuraci√≥n de Passwords","text":"","path":["Cheatsheet routers"],"tags":[]},{"location":"cheatsheet_routers/#password-para-modo-privilegiado-enable","level":4,"title":"Password para Modo Privilegiado (Enable)","text":"<pre><code>(config)# enable secret miPasswordSeguro\n</code></pre>","path":["Cheatsheet routers"],"tags":[]},{"location":"cheatsheet_routers/#password-para-consola","level":4,"title":"Password para Consola","text":"<pre><code>(config)# line console 0\n(config-line)# password consolePass\n(config-line)# login\n(config-line)# exit\n</code></pre>","path":["Cheatsheet routers"],"tags":[]},{"location":"cheatsheet_routers/#password-para-lineas-vty-telnetssh","level":4,"title":"Password para L√≠neas VTY (Telnet/SSH)","text":"<pre><code>(config)# line vty 0 4\n(config-line)# password vtyPass\n(config-line)# login\n(config-line)# exit\n</code></pre>","path":["Cheatsheet routers"],"tags":[]},{"location":"cheatsheet_routers/#4-cifrado-de-passwords","level":3,"title":"4. Cifrado de Passwords","text":"<pre><code># Cifrar todas las passwords en texto claro\n(config)# service password-encryption\n\n# Ver passwords cifradas\n# show running-config\n</code></pre>","path":["Cheatsheet routers"],"tags":[]},{"location":"cheatsheet_routers/#5-configuracion-de-banners","level":3,"title":"5. Configuraci√≥n de Banners","text":"<pre><code># Banner de aviso (MOTD)\n(config)# banner motd #\n ¬°Acceso Autorizado Solo a Personal Autorizado! \n#\n\n# Banner de login\n(config)# banner login #\n Bienvenido. Introduzca sus credenciales.\n#\n</code></pre>","path":["Cheatsheet routers"],"tags":[]},{"location":"cheatsheet_routers/#6-configuracion-de-interfaces","level":3,"title":"6. Configuraci√≥n de Interfaces","text":"","path":["Cheatsheet routers"],"tags":[]},{"location":"cheatsheet_routers/#interfaz-fastethernet","level":4,"title":"Interfaz FastEthernet","text":"<pre><code>(config)# interface fastethernet 0/0\n(config-if)# ip address 192.168.1.1 255.255.255.0\n(config-if)# no shutdown\n(config-if)# description LAN-Office\n(config-if)# exit\n</code></pre>","path":["Cheatsheet routers"],"tags":[]},{"location":"cheatsheet_routers/#interfaz-serial-wan","level":4,"title":"Interfaz Serial (WAN)","text":"<pre><code>(config)# interface serial 0/0/0\n(config-if)# ip address 10.0.0.1 255.255.255.252\n(config-if)# clock rate 64000    # Solo en lado DCE\n(config-if)# no shutdown\n(config-if)# exit\n</code></pre>","path":["Cheatsheet routers"],"tags":[]},{"location":"cheatsheet_routers/#7-configuracion-basica-de-seguridad","level":3,"title":"7. Configuraci√≥n B√°sica de Seguridad","text":"","path":["Cheatsheet routers"],"tags":[]},{"location":"cheatsheet_routers/#deshabilitar-dns-lookup","level":4,"title":"Deshabilitar DNS Lookup","text":"<pre><code>(config)# no ip domain-lookup\n</code></pre>","path":["Cheatsheet routers"],"tags":[]},{"location":"cheatsheet_routers/#configurar-nombre-de-host","level":4,"title":"Configurar Nombre de Host","text":"<pre><code>(config)# hostname R1-Madrid\n</code></pre>","path":["Cheatsheet routers"],"tags":[]},{"location":"cheatsheet_routers/#configurar-domain-name","level":4,"title":"Configurar Domain Name","text":"<pre><code>(config)# ip domain-name empresa.com\n</code></pre>","path":["Cheatsheet routers"],"tags":[]},{"location":"cheatsheet_routers/#8-configuracion-ssh-recomendado-sobre-telnet","level":3,"title":"8. Configuraci√≥n SSH (Recomendado sobre Telnet)","text":"<pre><code># Generar claves RSA\n(config)# crypto key generate rsa modulus 2048\n\n# Configurar SSH\n(config)# ip ssh version 2\n(config)# username admin secret admin123\n\n# Configurar l√≠neas VTY para SSH\n(config)# line vty 0 4\n(config-line)# transport input ssh\n(config-line)# login local\n(config-line)# exit\n</code></pre>","path":["Cheatsheet routers"],"tags":[]},{"location":"cheatsheet_routers/#9-comandos-de-verificacion-utiles","level":3,"title":"9. Comandos de Verificaci√≥n √ötiles","text":"<pre><code># Ver configuraci√≥n actual\n# show running-config\n\n# Ver interfaces y estado\n# show ip interface brief\n\n# Ver tabla de routing\n# show ip route\n\n# Ver resumen de interfaces\n# show interfaces description\n\n# Ver conexiones SSH\n# show ssh\n</code></pre>","path":["Cheatsheet routers"],"tags":[]},{"location":"cheatsheet_routers/#10-configuracion-basica-de-routing-estatico","level":3,"title":"10. Configuraci√≥n B√°sica de Routing Est√°tico","text":"<pre><code># Ruta est√°tica hacia red remota\n(config)# ip route 192.168.2.0 255.255.255.0 10.0.0.2\n\n# Ruta por defecto\n(config)# ip route 0.0.0.0 0.0.0.0 10.0.0.2\n</code></pre>","path":["Cheatsheet routers"],"tags":[]},{"location":"cheatsheet_routers/#11-comandos-de-administracion","level":3,"title":"11. Comandos de Administraci√≥n","text":"<pre><code># Guardar configuraci√≥n\n# copy running-config startup-config\n\n# Recargar router\n# reload\n\n# Ver versi√≥n del IOS\n# show version\n\n# Ver tiempo de actividad\n# show uptime\n</code></pre>","path":["Cheatsheet routers"],"tags":[]},{"location":"cheatsheet_routers/#ejemplo-de-configuracion-completa-basica","level":3,"title":"üåê Ejemplo de Configuraci√≥n Completa B√°sica","text":"<pre><code>enable\nconfigure terminal\n\n! Configuraci√≥n b√°sica\nhostname R1-Oficina\nno ip domain-lookup\nservice password-encryption\n\n! Passwords\nenable secret MiSecurePass123\nline console 0\n password console123\n login\n exit\n\nline vty 0 4\n password vty123\n login\n transport input ssh\n exit\n\n! Interfaces\ninterface fastethernet 0\n</code></pre>","path":["Cheatsheet routers"],"tags":[]},{"location":"dtp/","level":1,"title":"DTP (Dynamic Trunking Protocol)","text":"","path":["DTP (Dynamic Trunking Protocol)"],"tags":[]},{"location":"dtp/#que-es-dtp","level":2,"title":"¬øQu√© es DTP?","text":"<p>DTP (Dynamic Trunking Protocol) es un protocolo propietario de Cisco que negocia autom√°ticamente la formaci√≥n de enlaces trunk entre switches Cisco. Opera en la capa 2 del modelo OSI.</p>","path":["DTP (Dynamic Trunking Protocol)"],"tags":[]},{"location":"dtp/#proposito-principal","level":2,"title":"Prop√≥sito Principal","text":"<p>DTP elimina la necesidad de configurar manualmente los enlaces trunk, permitiendo que los switches negocien autom√°ticamente si un puerto debe operar como: - Access (puerto de acceso) - Trunk (puerto troncal)</p>","path":["DTP (Dynamic Trunking Protocol)"],"tags":[]},{"location":"dtp/#modos-de-operacion-dtp","level":2,"title":"Modos de Operaci√≥n DTP","text":"","path":["DTP (Dynamic Trunking Protocol)"],"tags":[]},{"location":"dtp/#1-dynamic-auto","level":3,"title":"1. Dynamic Auto","text":"<pre><code>Switch(config-if)# switchport mode dynamic auto\n</code></pre> <ul> <li> <p>Espera a que el otro dispositivo solicite formar trunk</p> </li> <li> <p>No env√≠a frames DTP, pero responde a ellos</p> </li> <li> <p>Resultado: Forma trunk solo si el otro lado es \"desirable\"</p> </li> </ul> <p>Escenarios t√≠picos:</p> <ul> <li> <p>Enlaces entre switches donde NO quieres ser el iniciador</p> </li> <li> <p>Entornos con pol√≠tica \"esperar a ser invitado\"</p> </li> <li> <p>Conexiones a dispositivos que pueden cambiar configuraci√≥n</p> </li> <li> <p>Cuando el otro lado debe decidir si forma trunk</p> </li> </ul> <p>Por qu√© usarlo:</p> <pre><code>‚úÖ Menos agresivo - No inicia trunks no deseados\n\n‚úÖ Seguridad moderada - Solo forma trunk si el otro lado lo pide\n\n‚úÖ Flexibilidad - Se adapta a la configuraci√≥n del peer\n\n‚úÖ Bajo overhead - No env√≠a DTP activamente\n</code></pre>","path":["DTP (Dynamic Trunking Protocol)"],"tags":[]},{"location":"dtp/#2-dynamic-desirable","level":3,"title":"2. Dynamic Desirable","text":"<p><pre><code>Switch(config-if)# switchport mode dynamic desirable\n</code></pre> - Env√≠a activamente frames DTP para negociar trunk - Forma trunk si el otro lado es \"auto\", \"desirable\" o \"trunk\" - Modo m√°s agresivo</p> <p>Escenarios t√≠picos:</p> <ul> <li> <p>Enlaces troncales entre switches en mismo dominio administrativo</p> </li> <li> <p>Entornos din√°micos donde se a√±aden/eliminan VLANs frecuentemente</p> </li> <li> <p>Conexiones entre switches de mismo nivel</p> </li> <li> <p>Cuando quieres auto-configuraci√≥n pero con iniciativa</p> </li> </ul> <p>Por qu√© usarlo:</p> <pre><code>‚úÖ Auto-configuraci√≥n - Forma trunks autom√°ticamente\n\n‚úÖ Flexibilidad - Se adapta a cambios de configuraci√≥n\n\n‚úÖ Conveniencia - Reduce configuraci√≥n manual\n\n‚úÖ Compatibilidad - Funciona con \"auto\" y \"trunk\"\n</code></pre>","path":["DTP (Dynamic Trunking Protocol)"],"tags":[]},{"location":"dtp/#3-trunk","level":3,"title":"3. Trunk","text":"<p><pre><code>Switch(config-if)# switchport mode trunk\n</code></pre> - Fuerza el puerto como trunk permanentemente - Env√≠a frames DTP - Espera que el otro lado sea \"auto\", \"desirable\" o \"trunk\"</p> <p>Escenarios t√≠picos:</p> <ul> <li> <p>Enlaces a routers o firewalls</p> </li> <li> <p>Conexiones a servidores con m√∫ltiples VLANs</p> </li> <li> <p>Enlaces troncales cr√≠ticos que NO deben cambiar</p> </li> <li> <p>Entornos de alta seguridad</p> </li> </ul> <p>Por qu√© usarlo:</p> <pre><code>‚úÖ M√°xima estabilidad - No cambia de estado\n\n‚úÖ Seguridad - No negocia con dispositivos no autorizados\n\n‚úÖ Control total - Configuraci√≥n expl√≠cita\n\n‚úÖ Rendimiento - Sin overhead de negociaci√≥n constante\n</code></pre>","path":["DTP (Dynamic Trunking Protocol)"],"tags":[]},{"location":"dtp/#4-access","level":3,"title":"4. Access","text":"<p><pre><code>Switch(config-if)# switchport mode access\n</code></pre> - Fuerza el puerto como acceso - No env√≠a frames DTP - Rechaza negociaci√≥n de trunk</p> <p>Escenarios t√≠picos:</p> <ul> <li> <p>Puertos para usuarios finales (PCs, tel√©fonos, impresoras)</p> </li> <li> <p>Puertos de guest/wifi</p> </li> <li> <p>Conexiones a dispositivos que no soportan trunking</p> </li> <li> <p>Entornos de m√°xima seguridad</p> </li> </ul> <p>Por qu√© usarlo:</p> <pre><code>‚úÖ M√°xima seguridad - Sin negociaci√≥n de trunk\n\n‚úÖ Estabilidad - Comportamiento predecible\n\n‚úÖ Prevenci√≥n de VLAN hopping - Elimina riesgo de ataques\n\n‚úÖ Simplicidad - F√°cil troubleshooting\n</code></pre>","path":["DTP (Dynamic Trunking Protocol)"],"tags":[]},{"location":"dtp/#5-nonegotiate","level":3,"title":"5. Nonegotiate","text":"<p><pre><code>Switch(config-if)# switchport nonegotiate\n</code></pre> - Configura trunk pero deshabilita DTP - No env√≠a frames de negociaci√≥n</p> <p>Escenarios t√≠picos:</p> <ul> <li> <p>Enlaces a equipos no-Cisco (que no entienden DTP)</p> </li> <li> <p>Conexiones a firewalls, load balancers</p> </li> <li> <p>Enlaces donde DTP causa problemas</p> </li> <li> <p>Entornos multi-vendor</p> </li> </ul> <p>Por qu√© usarlo:</p> <pre><code>‚úÖ Compatibilidad multi-vendor - Sin protocolos propietarios\n\n‚úÖ Seguridad - Sin anuncios DTP\n\n‚úÖ Estabilidad - Trunk est√°tico sin negociaci√≥n\n\n‚úÖ Control - Configuraci√≥n manual expl√≠cita\n</code></pre>","path":["DTP (Dynamic Trunking Protocol)"],"tags":[]},{"location":"dtp/#tabla-de-compatibilidad-de-modos","level":2,"title":"Tabla de Compatibilidad de Modos","text":"Lado A Lado B Resultado Dynamic Auto Dynamic Auto Access Dynamic Auto Dynamic Desirable Trunk Dynamic Desirable Dynamic Desirable Trunk Trunk Dynamic Auto Trunk Trunk Dynamic Desirable Trunk Access Cualquier modo Access","path":["DTP (Dynamic Trunking Protocol)"],"tags":[]},{"location":"dtp/#comandos-de-configuracion","level":2,"title":"Comandos de Configuraci√≥n","text":"","path":["DTP (Dynamic Trunking Protocol)"],"tags":[]},{"location":"dtp/#configuracion-basica","level":3,"title":"Configuraci√≥n B√°sica:","text":"<pre><code># Ver estado DTP\nSwitch# show dtp interface [interface]\n\n# Configurar modo DTP\nSwitch(config)# interface gigabitethernet 0/1\nSwitch(config-if)# switchport mode dynamic auto\nSwitch(config-if)# switchport mode dynamic desirable\nSwitch(config-if)# switchport mode trunk\nSwitch(config-if)# switchport mode access\n\n# Deshabilitar DTP\nSwitch(config-if)# switchport nonegotiate\n</code></pre>","path":["DTP (Dynamic Trunking Protocol)"],"tags":[]},{"location":"dtp/#configuracion-de-vlan-nativa","level":3,"title":"Configuraci√≥n de VLAN Nativa:","text":"<pre><code>Switch(config-if)# switchport trunk native vlan [vlan-id]\n</code></pre>","path":["DTP (Dynamic Trunking Protocol)"],"tags":[]},{"location":"dtp/#ventajas-de-dtp","level":2,"title":"Ventajas de DTP","text":"<p>‚úÖ Configuraci√≥n autom√°tica ‚úÖ Reduce errores manuales ‚úÖ Facilita la administraci√≥n ‚úÖ Compatibilidad entre dispositivos Cisco </p>","path":["DTP (Dynamic Trunking Protocol)"],"tags":[]},{"location":"dtp/#desventajas-y-consideraciones","level":2,"title":"Desventajas y Consideraciones","text":"<p>‚ùå Solo funciona entre equipos Cisco ‚ùå Puede crear problemas de seguridad ‚ùå Overhead en la red ‚ùå En entornos seguros, se recomienda deshabilitar</p>","path":["DTP (Dynamic Trunking Protocol)"],"tags":[]},{"location":"dtp/#mejores-practicas","level":2,"title":"Mejores Pr√°cticas","text":"","path":["DTP (Dynamic Trunking Protocol)"],"tags":[]},{"location":"dtp/#para-seguridad","level":3,"title":"Para Seguridad:","text":"<pre><code># En puertos de acceso\nSwitch(config-if)# switchport mode access\nSwitch(config-if)# switchport nonegotiate\n\n# En puertos trunk (configuraci√≥n manual)\nSwitch(config-if)# switchport mode trunk\nSwitch(config-if)# switchport nonegotiate\nSwitch(config-if)# switchport trunk allowed vlan [vlan-list]\n</code></pre>","path":["DTP (Dynamic Trunking Protocol)"],"tags":[]},{"location":"dtp/#verificacion","level":3,"title":"Verificaci√≥n:","text":"<pre><code># Ver estado DTP\nSwitch# show dtp interface gigabitethernet 0/1\n\n# Ver resumen de interfaces\nSwitch# show interfaces trunk\n\n# Ver configuraci√≥n de puerto\nSwitch# show interfaces [interface] switchport\n</code></pre>","path":["DTP (Dynamic Trunking Protocol)"],"tags":[]},{"location":"dtp/#ejemplo-practico","level":2,"title":"Ejemplo Pr√°ctico","text":"","path":["DTP (Dynamic Trunking Protocol)"],"tags":[]},{"location":"dtp/#escenario-dos-switches-interconectados","level":3,"title":"Escenario: Dos switches interconectados","text":"<p><pre><code># Switch 1\nSwitch1(config)# interface gigabitethernet 0/1\nSwitch1(config-if)# switchport mode dynamic desirable\n\n# Switch 2  \nSwitch2(config)# interface gigabitethernet 0/1\nSwitch2(config-if)# switchport mode dynamic auto\n</code></pre> Resultado: Se formar√° un enlace trunk autom√°ticamente.</p>","path":["DTP (Dynamic Trunking Protocol)"],"tags":[]},{"location":"dtp/#seguridad-con-dtp","level":2,"title":"Seguridad con DTP","text":"<p>En entornos de producci√≥n, se recomienda: - Deshabilitar DTP en puertos de acceso - Configurar trunks manualmente - Usar <code>switchport nonegotiate</code> en trunks configurados manualmente</p>","path":["DTP (Dynamic Trunking Protocol)"],"tags":[]},{"location":"routers_y_rutas_estaticas/","level":1,"title":"Routers y rutas estaticas","text":"<p>En esta unidad vamos a tratar los siguientes puntos:</p> <ul> <li>C√≥mo los hosts finales env√≠an paquetes IP a destinos locales y remotos</li> <li>El proceso de enrutamiento</li> <li>Lectura e interpretaci√≥n de la tabla de enrutamiento de un router</li> <li>Configuraci√≥n de rutas est√°ticas en un router</li> <li>Uso de rutas predeterminadas para proporcionar conectividad a Internet</li> </ul> <p>Estos aspectos aspectos tienen cierta correspondencia con los siguientes puntos del CCNA:</p> <ol> <li>Interpretar los componentes de una tabla de enrutamiento</li> <li>Determinar c√≥mo un router toma una decisi√≥n de reenv√≠o (forwarding) por defecto</li> <li>Configurar y verificar el enrutamiento est√°tico IPv4 e IPv6</li> </ol> <p>El t√©rmino enrutamiento puede referirse a dos procesos diferentes: el proceso mediante el cual los routers crean su tabla de enrutamiento (una base de datos de destinos conocidos y c√≥mo reenviar paquetes hacia ellos) y el proceso de reenv√≠o de paquetes.</p> <p>Abordaremos pues ambos aspectos del enrutamiento.</p>","path":["Routers y rutas estaticas"],"tags":[]},{"location":"routers_y_rutas_estaticas/#como-envian-paquetes-los-hosts-finales","level":2,"title":"C√≥mo env√≠an paquetes los hosts finales","text":"<p>Antes de examinar los detalles de c√≥mo los routers reenv√≠an paquetes IP, echemos un ojo a los hosts finales que se env√≠an dichos paquetes entre s√≠. Despu√©s de que un host prepare un paquete para enviarlo a otro, debe encapsularlo en una trama. Si bien nos centramos en el enrutamiento, es decir un proceso de Capa 3, ¬°no nos olvidemos de la Capa 2! Los paquetes nunca se env√≠an por cable (u ondas de radio) sin estar encapsulados en una trama.</p> <p>La direcci√≥n MAC de destino de la trama depende de la direcci√≥n IP de destino del paquete. Si el paquete est√° destinado a un host en la misma red que el emisor, la direcci√≥n MAC de destino ser√° la del host de destino; en este caso, no se necesita un router porque ya sabemos que el router sirve para conectar redes diferentes.</p> <p>La imagen de abajo muestra este proceso cuando el PC1 env√≠a un paquete a el PC2. Las direcciones IP y MAC de destino son ambas de el PC2; No es necesario que R1 enrute el paquete porque el origen y el destino est√°n en la misma red (la red 192.168.1.0/24).</p> <p></p> <p>El PC1 (192.168.1.11) env√≠a un paquete al PC2 (192.168.1.12). Dado que ambos se encuentran en la misma red (192.168.1.0/24), el PC1 encapsula el paquete en una trama dirigida a la direcci√≥n MAC de el PC2. El PC1 no necesita enviar el paquete a R1 para su enrutamiento.</p> <p>Este diagrama presupone que el PC1 ya conoce la direcci√≥n MAC de el PC2; de lo contrario, primero enviar√° una solicitud ARP para obtenerla, tal y como ya hemos visto anteriormente en el curso.</p> <p>Nota</p> <p>Un icono de nube, como el que se muestra en la figura anterior, se utiliza a menudo para representar Internet, aunque no siempre. Un icono de nube puede utilizarse para obviar elementos que no son relevantes para el diagrama. La nube en la figura indica que R1 se conecta a otra red, cuyos detalles no son relevantes para el diagrama. Esa otra red podr√≠a ser internet o otra parte de la red de la misma empresa.</p> <p>Por otro lado, si un host final, como un PC, desea enviar un paquete a un destino fuera de su red local, debe enviarlo a su puerta de enlace predeterminada (el router que proporciona conectividad a otras redes,  tambi√©n conocido como gateway). En la imagen de abajo, R1 es la puerta de enlace predeterminada de la red 192.168.1.0/24.</p> <p>Para que PC1 y PC2 env√≠en paquetes a destinos fuera de 192.168.1.0/24, deben encapsular el paquete en una trama dirigida a la direcci√≥n MAC de la interfaz G0/0 de R1.</p> <p>En la imagen se muestra c√≥mo PC1 env√≠a un paquete a PC3: encapsula el paquete en una trama dirigida a la direcci√≥n MAC de la interfaz G0/0 de R1. A continuaci√≥n, R1 reenv√≠a el paquete fuera de su interfaz G0/1, encapsulado en una nueva trama dirigida a la direcci√≥n MAC de PC3.</p> <p></p> <p>PC1 (192.168.1.11) env√≠a un paquete a PC3 (192.168.2.11). Dado que PC1 y PC3 se encuentran en redes separadas, PC1 env√≠a el paquete en una trama dirigida a la direcci√≥n MAC de su puerta de enlace predeterminada: la de la interfaz G0/0 de R1. R1 reenv√≠a el paquete desde su interfaz G0/1, encapsulado en una nueva trama dirigida a la direcci√≥n MAC de PC3.</p> <p>Este diagrama supone que PC1 ya conoce la direcci√≥n MAC G0/0 de R1; de lo contrario, PC1 enviar√° una solicitud ARP para obtenerla. Asimismo, R1 tambi√©n debe obtener la direcci√≥n MAC de PC3.</p> <p>Nota</p> <p>La direcci√≥n IP de la puerta de enlace predeterminada suele ser la primera direcci√≥n utilizable de la red. Por ejemplo, en la red 192.168.1.0/24, es 192.168.1.1, y en la red 192.168.2.0/24, es 192.168.2.1. Esto no tiene por qu√© ser as√≠, pero es una pr√°ctica muy com√∫n. Las direcciones IP de los ordenadores, por otro lado, son arbitrarias. En los ejemplos las direcciones IP de los ordenadores terminan en .11 y .12, pero por ning√∫n motivo concreto.</p> <p>¬øC√≥mo sabe el PC1 cu√°l es su puerta de enlace predeterminada?</p> <p>Un host final puede conocer la direcci√≥n IP de su puerta de enlace predeterminada de dos maneras. La primera es mediante la configuraci√≥n manual, en la que un administrador especifica manualmente la puerta de enlace predeterminada en cada dispositivo. Sin embargo, esto es muy poco com√∫n en dispositivos de usuario como los PC; suelen utilizar el segundo m√©todo (el Protocolo de Configuraci√≥n Din√°mica de Host o DHCP) para conocer autom√°ticamente informaci√≥n como la direcci√≥n IP de su puerta de enlace predeterminada, as√≠ como su propia direcci√≥n IP.</p> <p>En un dispositivo Windows, podemos usar el comando <code>ipconfig</code> en la aplicaci√≥n S√≠mbolo del sistema para ver informaci√≥n como la direcci√≥n IP del dispositivo, la m√°scara de red (Subnet Mask en la salida del comando) y la puerta de enlace predeterminada. El siguiente ejemplo muestra la salida de este comando en el PC1:</p> <pre><code>C:\\Users\\alumno&gt; ipconfig\n. . .\nEthernet adapter Local Area Connection:\n   Connection-specific DNS Suffix  . : \n   IPv4 Address. . . . . . . . . . . : 192.168.1.11\n   Subnet Mask . . . . . . . . . . . : 255.255.255.0\n   Default Gateway . . . . . . . . . : 192.168.1.1\n. . .\n</code></pre> <p>Nota</p> <p>La puerta de enlace predeterminada de un host se configura como una direcci√≥n IP, no como una direcci√≥n MAC. Para conocer la direcci√≥n MAC de la puerta de enlace predeterminada, el host debe enviar una solicitud ARP a su direcci√≥n IP.</p> <p>Hay un par de puntos principales que se deben tener en cuenta en esta secci√≥n: primero, para enviar un paquete a un destino en la misma red, un host encapsular√° el paquete (dirigido a la direcci√≥n IP del host de destino) en una trama dirigida a la direcci√≥n MAC del host de destino. El segundo punto es que, para enviar un paquete a un destino en una red diferente, el host emisor encapsular√° el paquete (dirigido a la direcci√≥n IP del host de destino) en una trama dirigida a la direcci√≥n MAC de la puerta de enlace predeterminada. En cualquier caso, se debe usar ARP para obtener la direcci√≥n MAC adecuada (la del host de destino o la de la puerta de enlace predeterminada).</p>","path":["Routers y rutas estaticas"],"tags":[]},{"location":"routers_y_rutas_estaticas/#fundamentos-de-routing","level":2,"title":"Fundamentos de routing","text":"<p>En el apartado anterior hemos visto c√≥mo un host env√≠a paquetes a destinos fuera de su red local; env√≠a cada paquete en una trama dirigida a la direcci√≥n MAC de la puerta de enlace predeterminada. Ahora examinaremos c√≥mo la puerta de enlace predeterminada (un router) realiza su funci√≥n de reenv√≠o de paquetes entre redes, lo que se denomina enrutamiento. La imagen de m√°s abajo ofrece una descripci√≥n general de c√≥mo R1 reenv√≠a un paquete de PC1 a PC3.</p> <p>Nota</p> <p>La tabla de enrutamiento de R1 en la imagen est√° simplificada; examinaremos la tabla de enrutamiento completa de R1 m√°s adelante.</p> <p>Cuando un router recibe una trama destinada a su propia direcci√≥n MAC, la desencapsula para examinar el paquete que contiene (si el destino no es su propia direcci√≥n MAC, la descarta). Si la direcci√≥n IP de destino del paquete es su propia direcci√≥n IP, contin√∫a desencapsulando el mensaje; es un mensaje para el router.</p> <p>Sin embargo, si la direcci√≥n IP de destino del paquete no es su propia direcci√≥n IP, el router intentar√° enrutarlo hacia su destino. Para ello, busca la direcci√≥n IP de destino del paquete en su tabla de enrutamiento para encontrar una ruta adecuada. Si encuentra una ruta adecuada, reenv√≠a el paquete seg√∫n esa ruta. De lo contrario, lo descarta.</p> <p></p> <p>En la figura de arriba, R1 recibe un paquete de PC1 y lo reenv√≠a a PC3:</p> <ol> <li>R1 recibe una trama en su interfaz G0/0. La trama est√° dirigida a la direcci√≥n MAC de R1, por lo que examina el paquete que contiene.</li> <li>R1 busca la direcci√≥n IP de destino del paquete en su tabla de enrutamiento. 192.168.2.11 pertenece a la red 192.168.2.0/24, por lo que selecciona esa ruta para reenviarlo. </li> <li>R1 encapsula el paquete en una nueva trama destinada a la direcci√≥n MAC de PC3 y lo reenv√≠a fuera de la interfaz especificada por la ruta (G0/1).</li> </ol>","path":["Routers y rutas estaticas"],"tags":[]},{"location":"routers_y_rutas_estaticas/#la-tabla-de-enrutamiento","level":2,"title":"La tabla de enrutamiento","text":"<p>La tabla de enrutamiento de un router es una base de datos de destinos conocidos por el router. Puede considerarse como un conjunto de instrucciones:</p> <ul> <li>Para enviar un paquete al destino X, reenv√≠alo al siguiente salto Y.</li> <li>O bien, si el destino est√° en una red conectada directamente, reenv√≠alo directamente al destino.</li> <li>O bien, si el destino es la direcci√≥n IP del router, contin√∫a desencapsulando el mensaje (no reenv√≠es el paquete).</li> </ul> <p>El ejemplo que ve√≠amos en la figura anterior es un ejemplo del segundo tipo de instrucci√≥n: el destino del paquete (PC3, 192.168.2.11) se encuentra en una red conectada directamente a R1 (192.168.2.0/24), por lo que R1 reenv√≠a el paquete directamente al destino (encapsul√°ndolo en una trama dirigida a PC3).</p> <p>A diferencia de los switches, que pueden generar su tabla de direcciones MAC autom√°ticamente sin necesidad de configuraci√≥n, la tabla de enrutamiento de un router estar√° vac√≠a por defecto; no podr√° reenviar paquetes. El siguiente ejemplo muestra la tabla de enrutamiento de R1 antes de cualquier configuraci√≥n. El comando para ver la tabla de enrutamiento es <code>show ip route</code>:`</p> <pre><code>R1# show ip route\nCodes: L - local, C - connected, S - static, R - RIP, M - mobile, B - BGP\n       D - EIGRP, EX - EIGRP external, O - OSPF, IA - OSPF inter area\n       N1 - OSPF NSSA external type 1, N2 - OSPF NSSA external type 2\n       E1 - OSPF external type 1, E2 - OSPF external type 2\n       i - IS-IS, su - IS-IS summary, L1 - IS-IS level-1, L2 - IS-IS level-2\n       ia - IS-IS inter area, * - candidate default, U - per-user static route\n       o - ODR, P - periodic downloaded static route, H - NHRP, l - LISP\n       a - application route\n       + - replicated route, % - next hop override, p - overrides from PfR\n\nGateway of last resort is not set\n</code></pre> <p>Sin ninguna configuraci√≥n, la salida muestra algunos c√≥digos que representan los diferentes tipos de ruta que podr√≠an aparecer en la tabla de enrutamiento. Finalmente, \"Gateway of last resort is not set\" indica que R1 no tiene una ruta predeterminada, algo que abordaremos m√°s adelante.</p> <p>Configuremos R1 y veamos c√≥mo cambia la salida de <code>show ip route</code>. Primero, no configuraremos ninguna ruta; en lugar de eso, configuremos las direcciones IP de R1 y habilitemos sus interfaces, como en el siguiente ejemplo:</p> <pre><code>R1# configure terminal\nR1(config)# interface g0/0\nR1(config-if)# ip address 192.168.1.1 255.255.255.0\nR1(config-if)# no shutdown\nR1(config-if)# interface g0/1\nR1(config-if)# ip address 192.168.2.1 255.255.255.0\nR1(config-if)# no shutdown\n</code></pre> <p>Las interfaces de R1 ahora est√°n configuradas seg√∫n los diagramas anteriores: 192.168.1.1/24 en G0/0 y 192.168.2.1/24 en G0/1. Ahora, examinemos de nuevo la tabla de enrutamiento de R1 y veamos qu√© ha cambiado (omitiendo algunos c√≥digos para ahorrar espacio):</p> <pre><code>R1# show ip route\nCodes: L - local, C - connected, S - static, R - RIP, M - mobile, B - BGP\n. . .\nGateway of last resort is not set\n      192.168.1.0/24 is variably subnetted, 2 subnets, 2 masks\nC        192.168.1.0/24 is directly connected, GigabitEthernet0/0\nL        192.168.1.1/32 is directly connected, GigabitEthernet0/0\n      192.168.2.0/24 is variably subnetted, 2 subnets, 2 masks\nC        192.168.2.0/24 is directly connected, GigabitEthernet0/1\nL        192.168.2.1/32 is directly connected, GigabitEthernet0/1\n</code></pre> <p>Con solo configurar las direcciones IP y habilitar las dos interfaces de R1, R1 insert√≥ cuatro rutas en su tabla de enrutamiento: dos rutas conectadas (indicadas por el c√≥digo <code>C</code>) y dos rutas locales (indicadas por el c√≥digo <code>L</code>).</p> <p>Nota</p> <p>La l√≠nea 192.168.1.0/24 tiene subredes variables; 2 subredes, 2 m√°scaras no es una ruta. Esta afirmaci√≥n significa que en la tabla de enrutamiento hay dos rutas a subredes que encajan en la red de clase C 192.168.1.0/24, con dos m√°scaras de red diferentes (/24 y /32). Lo mismo aplica a la l√≠nea similar sobre 192.168.2.0/24. </p>","path":["Routers y rutas estaticas"],"tags":[]},{"location":"routers_y_rutas_estaticas/#rutas-conectadas","level":3,"title":"Rutas conectadas","text":"<p>Una ruta conectada es una ruta a la red a la que est√° conectada una interfaz. Se a√±ade autom√°ticamente una ruta conectada a la tabla de enrutamiento por cada interfaz que tenga una direcci√≥n IP y est√© activa (puede comprobar el estado de la interfaz con <code>show ip interface brief</code>). Por ejemplo, la interfaz G0/0 de R1 tiene la direcci√≥n IP 192.168.1.1/24, por lo que agrega autom√°ticamente una ruta a la red 192.168.1.0/24 a su tabla de enrutamiento.</p> <p>Nota</p> <p>192.168.1.0/24 es la direcci√≥n de red, con todos los bits de la porci√≥n de host establecidos en 0. Esto se puede determinar simplemente cambiando el octeto final de 1 a 0, ya que la m√°scara de red de la interfaz es /24.</p> <p>Una ruta conectada indicar√° que la red est√° conectada directamente y tambi√©n indicar√° a qu√© interfaz est√° conectada. Para ver solo las rutas conectadas en la tabla de enrutamiento de R1, en el siguiente ejemplo, filtro la salida usando la barra vertical <code>|</code> seguida de <code>include C</code> para mostrar solo las l√≠neas que incluyen <code>C</code>:</p> <pre><code>R1# show ip route | include C\nCodes: L - local, C - connected, S - static, R - RIP, M - mobile, B - BGP\nC        192.168.1.0/24 is directly connected, GigabitEthernet0/0\nC        192.168.2.0/24 is directly connected, GigabitEthernet0/1\n</code></pre> <p>Con estas rutas en su tabla de enrutamiento, R1 sabe que para reenviar un paquete a un host con una direcci√≥n IP en las redes 192.168.1.0/24 o 192.168.2.0/24, debe enviar el paquete desde la interfaz especificada en la ruta en una trama dirigida directamente al host de destino. Esto se vio en la figura 9.3; la direcci√≥n IP de destino del paquete era 192.168.2.11 (PC3), por lo que R1 reenvi√≥ el paquete desde la interfaz G0/1 en una trama dirigida a la direcci√≥n MAC de PC3.</p> <p>La siguiente imagen muestra c√≥mo la ruta a 192.168.1.0/24 incluye todas las direcciones IP desde 192.168.1.0 hasta 192.168.1.255. La parte de red de la direcci√≥n de la ruta es fija, pero la parte del host puede ser cualquier n√∫mero de 8 bits.</p> <p></p> <p>Direcci√≥n IP y longitud del prefijo (expresada como m√°scara de red) de la ruta a 192.168.1.0/24. Debido a la longitud del prefijo /24, los primeros tres octetos son fijos (los bits no pueden cambiar). Sin embargo, el √∫ltimo octeto puede ser cualquier n√∫mero de 8 bits: .1, .11, .100, .179, etc. Esto significa que cualquier paquete con una direcci√≥n IP de destino que comience por 192.168.1 puede reenviarse mediante esta ruta.</p>","path":["Routers y rutas estaticas"],"tags":[]},{"location":"routers_y_rutas_estaticas/#rutas-locales","level":3,"title":"Rutas locales","text":"<p>Una ruta local es una ruta a la direcci√≥n IP exacta configurada en la interfaz del router. Al igual que las rutas conectadas, se agrega autom√°ticamente una ruta local a la tabla de enrutamiento por cada interfaz que tenga una direcci√≥n IP y est√© activa. En el siguiente ejemplo, utilizo <code>show ip route | include L</code> para ver solo las rutas locales de R1. Tenga en cuenta que, al igual que las rutas conectadas, las rutas locales tambi√©n indican que X est√° conectado directamente, seguido de la interfaz:</p> <pre><code>R1# show ip route | include L\nCodes: L - local, C - connected, S - static, R - RIP, M - mobile, B - BGP\n. . .\nL        192.168.1.1/32 is directly connected, GigabitEthernet0/0\nL        192.168.2.1/32 is directly connected, GigabitEthernet0/1\n</code></pre> <p>Para especificar la direcci√≥n IP exacta de la interfaz, una ruta local utiliza una longitud de prefijo /32; todos los bits de la m√°scara de red se establecen en 1. Esto se aplica independientemente de la m√°scara de red configurada en la interfaz. Por ejemplo, aunque ambas interfaces de R1 tienen una longitud de prefijo /24, sus rutas locales son /32. Esto se debe a que una ruta local solo especifica una direcci√≥n IP. Como se mencion√≥ anteriormente, una ruta a 192.168.1.0/24 incluye todas las direcciones IP desde 192.168.1.0 hasta 192.168.1.255; dado que la longitud del prefijo es /24, el octeto final puede ser cualquier n√∫mero entre 0 y 255. Por otro lado, una ruta a 192.168.1.1/32 incluye solo 192.168.1.1, debido a su longitud de prefijo /32; todos los bits se consideran parte de la porci√≥n de red y no se pueden modificar. La figura 9.5 muestra la direcci√≥n IP de R1 G0/0 con una longitud de prefijo /32 (escrita como una m√°scara de red).</p> <p>Una ruta local indica al router que los paquetes destinados a la direcci√≥n IP especificada en la ruta son para √©l mismo; debe continuar desencapsulando el mensaje y examinando su contenido. En este caso, el router no reenv√≠a el paquete, sino que lo recibe. La ruta local es necesaria para distinguir la direcci√≥n IP del router de otras direcciones IP en la red conectada. Si R1 solo tuviera una ruta conectada a 192.168.1.0/24, pero ninguna ruta local, reenviar√≠a los paquetes destinados a 192.168.1.1 desde su interfaz G0/0, en lugar de recibirlos.</p>","path":["Routers y rutas estaticas"],"tags":[]},{"location":"routers_y_rutas_estaticas/#eleccion-de-rutas","level":2,"title":"Elecci√≥n de rutas","text":"<p>Cuando un router reenv√≠a un paquete, debe decidir qu√© ruta de su tabla de enrutamiento utilizar√° para reenviarlo, lo que se denomina selecci√≥n de ruta. Para determinar c√≥mo reenviar un paquete en particular, el router seleccionar√° la ruta coincidente m√°s espec√≠fica. Definamos este t√©rmino:</p> <ul> <li>Ruta coincidente: La direcci√≥n IP de destino del paquete forma parte de la red especificada en la ruta. De lo contrario, el paquete no se puede reenviar utilizando esta ruta.</li> <li>M√°s espec√≠fica: La ruta con la longitud de prefijo m√°s larga.</li> </ul> <p>Usemos un ejemplo para aclarar este concepto. La siguiente figura muestra el proceso de selecci√≥n de ruta cuando R1 recibe un paquete dirigido a 192.168.1.1. La direcci√≥n IP de destino del paquete coincide con dos rutas en la tabla de enrutamiento de R1, por lo que selecciona la m√°s espec√≠fica.</p> <p></p> <p>R1 recibe un paquete y selecciona la mejor ruta para √©l.  1. R1 recibe una trama en su interfaz G0/0. La MAC de destino es la suya, por lo que la desencapsula y examina el paquete que contiene. 2. La direcci√≥n IP de destino del paquete es 192.168.1.1. R1 realiza una b√∫squeda en la tabla de enrutamiento y descubre que dos rutas coinciden con la direcci√≥n IP de destino del paquete: la ruta conectada a 192.168.1.0/24 y la ruta local a 192.168.1.1/32. R1 selecciona la ruta m√°s espec√≠fica: 192.168.1.1/32. 3. Dado que R1 selecciona una ruta local, recibe el paquete por s√≠ mismo; no lo reenv√≠a.</p> <p>Una ruta con un prefijo /24 incluye 256 direcciones IP diferentes. Por ejemplo, 192.168.1.0/24 incluye las rutas de 192.168.1.0 a 192.168.1.255. Por otro lado, una ruta con un prefijo /32 solo incluye una direcci√≥n IP, por lo que una ruta /32 es m√°s espec√≠fica que una ruta /24. De hecho, una ruta /32 es la m√°s espec√≠fica posible; si la direcci√≥n IP de destino de un paquete coincide con una ruta /32, esa ruta siempre se seleccionar√° para ese paquete, independientemente de cu√°ntas otras rutas coincidentes haya. </p> <p>¬øQu√© sucede si no hay ninguna ruta en la tabla de enrutamiento que coincida con la direcci√≥n IP de destino de un paquete? En ese caso, el enrutador descartar√° el paquete; no lo inundar√° de todos los puertos como lo hacen los conmutadores con tramas unicast desconocidas. Un conmutador a veces inunda de tramas, pero un enrutador nunca inunda de paquetes; reenv√≠a el paquete, lo recibe para s√≠ mismo o lo descarta. La Tabla 9.1 resume las acciones que un enrutador puede realizar en un paquete.</p> Condiciones de coincidencia Acci√≥n del enrutador La direcci√≥n IP de destino del paquete coincide con una o m√°s rutas no locales. Reenviar el paquete seg√∫n la ruta coincidente m√°s espec√≠fica La direcci√≥n IP de destino del paquete coincide con una ruta local. Recibir el paquete La direcci√≥n IP de destino del paquete no coincide con ninguna ruta. Descartar el paquete","path":["Routers y rutas estaticas"],"tags":[]},{"location":"routers_y_rutas_estaticas/#rutas-estaticas","level":2,"title":"Rutas est√°ticas","text":"<p>El proceso de reenv√≠o de paquetes descrito en la secci√≥n 9.2 se denomina enrutamiento, pero el t√©rmino enrutamiento tambi√©n se utiliza para referirse a los procesos que utilizan los enrutadores para aprender rutas. Adem√°s de las rutas conectadas y locales que un enrutador inserta autom√°ticamente en su tabla de enrutamiento, existen dos m√©todos principales mediante los cuales los enrutadores pueden aprender rutas:</p> <p>Enrutamiento din√°mico: Los enrutadores utilizan protocolos de enrutamiento din√°mico (es decir, OSPF) para compartir informaci√≥n entre s√≠ y crear sus tablas de enrutamiento.</p> <p>Enrutamiento est√°tico: Un ingeniero/administrador configura manualmente las rutas en el enrutador.</p> <p>Las rutas conectadas permiten al enrutador reenviar paquetes a destinos en redes conectadas directamente a √©l, y las rutas locales permiten al enrutador recibir paquetes destinados a sus propias direcciones IP. Sin embargo, para reenviar paquetes a destinos que no est√°n en redes conectadas directamente, el enrutador debe aprender de esos destinos mediante uno de los m√©todos mencionados anteriormente (abordaremos el enrutamiento din√°mico en los cap√≠tulos 17 y 18).</p> <p>Al reenviar un paquete a un destino que no est√° conectado directamente al enrutador, este debe encapsularlo en una trama dirigida a la direcci√≥n MAC del siguiente salto, que corresponde al siguiente enrutador en la ruta hacia el destino. La Figura 9.7 muestra este proceso.</p> <p></p> <p>PC1 env√≠a un paquete a PC3 a trav√©s de R1, R2 y R3. 1) PC1 env√≠a el paquete en una trama a R1 G0/1. R1 lo recibe y realiza una b√∫squeda en la tabla de enrutamiento. 2) R1 reenv√≠a el paquete en una trama a R2 G0/0. R2 lo recibe y realiza una b√∫squeda en la tabla de enrutamiento. 3) R2 reenv√≠a el paquete en una trama a la MAC de R3 G0/0. R3 recibe el paquete y realiza una b√∫squeda en la tabla de enrutamiento. (4) R3 reenv√≠a el paquete en una trama a PC3, que lo recibe y lo procesa.</p> <p>La imagen anterior muestra c√≥mo los enrutadores reenv√≠an paquetes hacia destinos remotos (no conectados directamente). Sin embargo, los enrutadores no tienen estas rutas en sus tablas de enrutamiento por defecto; estas rutas deben configurarse manualmente. Sin configurar ninguna ruta est√°tica, si R1 recibe un paquete de PC1 con destino a 192.168.3.11, no encontrar√° ninguna ruta coincidente al realizar la b√∫squeda en la tabla de enrutamiento. No tendr√° m√°s remedio que descartar el paquete. La siguiente tabla enumera las redes que cada enrutador de la figura 9.7 reconoce sin configurar rutas est√°ticas.</p> Router Redes conocidas Redes desconocidas R1 192.168.1.0/24192.168.12.0/24 192.168.3.0/24192.168.23.0/24 R2 192.168.12.0/24192.168.23.0/24 192.168.1.0/24192.168.3.0/24 R3 192.168.3.0/24192.168.23.0/24 192.168.1.0/24192.168.12.0/24 <p>Dado el objetivo de habilitar la comunicaci√≥n bidireccional entre PC1 y PC3, ¬øqu√© rutas debemos configurar? Al observar la tabla 9.2, se podr√≠a suponer que debemos configurar seis rutas para que cada enrutador conozca todas las redes dentro de la red principal.</p> <p>Sin embargo, para reenviar paquetes entre dos hosts, cada enrutador solo necesita rutas a las redes de los hosts que se comunican (PC1 y PC3). R1, por ejemplo, no necesita conocer la red entre R2 y R3 (192.168.23.0/24); R1 solo necesita saber que para reenviar un paquete a un destino en 192.168.3.0/24, debe reenviarlo a R2. La Figura 9.8 demuestra este concepto: si configuramos una ruta a 192.168.3.0/24 en R1, con la direcci√≥n IP de R2 especificada como el siguiente salto, R1 podr√° reenviar el paquete a R2. No necesita saber los detalles de la ruta que tomar√° el paquete despu√©s de R2; solo necesita saber que R2 es el siguiente salto.</p> <p>R1 reenv√≠a un paquete destinado a 192.168.3.11 (PC3). R1 ‚Äã‚Äãtiene una ruta est√°tica a 192.168.3.0/24 a trav√©s de 192.168.12.2 (R2). R1 ‚Äã‚Äãsabe que para reenviar un paquete hacia la red 192.168.3.0/24, debe reenviarlo a R2. R1 desconoce los detalles de la ruta que tomar√° el paquete despu√©s de R2, y no est√° obligado a conocerlos.</p> <p>En resumen, cada router necesita una ruta a 192.168.3.0/24 para poder reenviar paquetes de PC1 a PC3 y una ruta a 192.168.1.0/24 para poder reenviar paquetes de PC3 a PC1. El R1 ya tiene una ruta conectada a 192.168.1.0/24, y el R3 ya tiene una ruta conectada a 192.168.3.0/24. La Tabla 9.3 enumera las rutas est√°ticas que debemos configurar para habilitar la comunicaci√≥n bidireccional entre el PC1 y el PC3.</p> Router Rutas necesarias Pr√≥ximo salto R1 192.168.3.0/24 192.168.12.2 (R2 G0/0) R2 192.168.1.0/24 192.168.12.1 (R1 G0/0) R2 192.168.3.0/24 192.168.23.2 (R3 G0/0) R3 192.168.1.0/24 192.168.23.1 (R2 G0/1) <p>Nota</p> <p>En este ejemplo, nos referimos a las rutas necesarias para habilitar la comunicaci√≥n bidireccional entre el PC1 y el PC3. Si bien no es necesario para tal fin, no hay problema en configurar una ruta a 192.168.23.0/24 en el R1 y una ruta a 192.168.12.0/24 en el R3.</p>","path":["Routers y rutas estaticas"],"tags":[]},{"location":"routers_y_rutas_estaticas/#configurando-rutas-estaticas","level":3,"title":"Configurando rutas est√°ticas","text":"<p>El comando para configurar una ruta est√°tica es, desde el modo de configuraci√≥n global, <code>ip route</code>. Sin embargo, existen diferentes opciones en cuanto a los argumentos que se proporcionan con el comando:</p> <ul> <li><code>ip route red-destino m√°scara pr√≥ximo-salto</code></li> <li><code>ip route red-destino m√°scara interfaz-salida</code></li> <li><code>ip route red-destino m√°scara interfaz-salida pr√≥ximo-salto</code></li> </ul>","path":["Routers y rutas estaticas"],"tags":[]},{"location":"routers_y_rutas_estaticas/#rutas-estaticas-especificando-el-proximo-salto","level":3,"title":"Rutas est√°ticas especificando el pr√≥ximo salto","text":"<p>Se puede configurar una ruta est√°tica especificando la direcci√≥n de red de destino, la m√°scara de red y la direcci√≥n IP del siguiente salto. La Figura 9.9 muestra los comandos para configurar cada una de las rutas necesarias en R1, R2 y R3.</p> <p></p> <p>Configuraci√≥n de rutas est√°ticas en R1, R2 y R3 para habilitar la comunicaci√≥n bidireccional entre PC1 y PC3. Las rutas especifican la direcci√≥n IP del siguiente salto. R1 requiere una ruta a 192.168.3.0/24, R2 requiere rutas a 192.168.1.0/24 y 192.168.3.0/24, y R3 requiere una ruta a 192.168.1.0/24.</p> <p>Una ruta est√°tica que especifica √∫nicamente la direcci√≥n IP del siguiente salto se denomina ruta est√°tica recursiva. El nombre recursivo se debe a que requiere m√∫ltiples b√∫squedas en la tabla de enrutamiento para reenviar un paquete:</p> <p>Una b√∫squeda para encontrar la direcci√≥n IP del siguiente salto Una b√∫squeda para encontrar la interfaz a la que est√° conectado el siguiente salto</p> <p>Para demostrarlo, observemos la tabla de enrutamiento de R1 en el siguiente ejemplo. Cuando R1 recibe un paquete destinado a 192.168.3.11, descubre que la ruta coincidente m√°s espec√≠fica (de hecho, la √∫nica ruta coincidente) es la est√°tica:</p> <pre><code>R1# show ip route\nCodes: L - local, C - connected, S - static, R - RIP, M - mobile, B - BGP\n. . .\n      192.168.1.0/24 is variably subnetted, 2 subnets, 2 masks\nC        192.168.1.0/24 is directly connected, GigabitEthernet0/1\nL        192.168.1.1/32 is directly connected, GigabitEthernet0/1\nS     192.168.3.0/24 [1/0] via 192.168.12.2\n      192.168.12.0/24 is variably subnetted, 2 subnets, 2 masks\nC        192.168.12.0/24 is directly connected, GigabitEthernet0/0\nL        192.168.12.1/32 is directly connected, GigabitEthernet0/0\n</code></pre> <p>Nota</p> <p>El [1/0] en la ruta est√°tica indica la distancia administrativa (AD) y la m√©trica de la ruta, respectivamente. La AD y la m√©trica se abordar√°n en el cap√≠tulo 17; no son relevantes para este cap√≠tulo.</p> <p>La ruta est√°tica indica <code>S 192.168.3.0/24 [1/0] v√≠a 192.168.12.2</code> (n√≥tese el c√≥digo <code>S</code> para est√°tica), pero esta informaci√≥n por s√≠ sola no le indica a R1 por qu√© interfaz reenviar el paquete. Para obtenerla, realiza una segunda b√∫squeda de la direcci√≥n IP del siguiente salto: 192.168.12.2. La ruta m√°s espec√≠fica (y la √∫nica) que coincide con 192.168.12.2 es la ruta conectada a 192.168.12.0/24, que especifica la interfaz G0/0. Ahora, despu√©s de dos b√∫squedas, R1 conoce la direcci√≥n IP del siguiente salto y la interfaz por la que reenviar el paquete.</p> <p>Nota</p> <p>R1 conoce la direcci√≥n IP del siguiente salto, pero la informaci√≥n que realmente necesita es la direcci√≥n MAC del siguiente salto. Para obtenerla, debe enviar una solicitud ARP a la direcci√≥n IP del siguiente salto.</p>","path":["Routers y rutas estaticas"],"tags":[]},{"location":"routers_y_rutas_estaticas/#rutas-estaticas-especificando-la-interfaz-de-salida","level":3,"title":"Rutas est√°ticas especificando la interfaz de salida","text":"<p>En lugar de especificar la direcci√≥n IP del siguiente salto de la ruta, puede especificar la interfaz de salida, es decir, la interfaz desde la que el enrutador debe reenviar los paquetes. El siguiente ejemplo muestra las mismas rutas est√°ticas que vimos en la figura 9.9, pero configuradas con la interfaz de salida:</p> <ul> <li><code>R1(config)# ip route 192.168.3.0 255.255.255.0 g0/0</code></li> <li><code>R2(config)# ip route 192.168.1.0 255.255.255.0 g0/0</code></li> <li><code>R2(config)# ip route 192.168.3.0 255.255.255.0 g0/1</code></li> <li><code>R3(config)# ip route 192.168.1.0 255.255.255.0 g0/0</code></li> </ul> <p>Una ruta est√°tica que especifica solo la interfaz de salida se denomina ruta est√°tica conectada directamente. Esto se debe a que la ruta aparecer√° como una red conectada directamente en la tabla de enrutamiento. El siguiente ejemplo muestra la ruta a 192.168.3.0/24 en la tabla de enrutamiento de R1:</p> <pre><code>R1# show ip route\nCodes: L - local, C - connected, S - static, R - RIP, M - mobile, B - BGP\n. . .\nS     192.168.3.0/24 is directly connected, GigabitEthernet0/0\n. . .\n</code></pre> <p>Este tipo de ruta est√°tica tiene una desventaja: dado que R1 considera que la red 192.168.3.0/24 est√° conectada directamente a su interfaz G0/0, intentar√° enviar paquetes en tramas dirigidas directamente a PC3, en lugar de al siguiente salto.</p> <p>Esto significa que R1 no enviar√° una solicitud ARP para conocer la direcci√≥n MAC del siguiente salto; en su lugar, enviar√° una solicitud ARP para conocer la direcci√≥n MAC de PC3. El problema es que esta solicitud ARP no llegar√° a PC3, sino a R2 (los mensajes de difusi√≥n no van m√°s all√° de su red local). Sin embargo, R2 puede usar una funci√≥n llamada proxy ARP para responder en nombre de PC3, indic√°ndole a R1 que env√≠e el paquete a la direcci√≥n MAC G0/0 de R2. Esto se muestra en la figura 9.10.</p> <p></p> <p>Un intercambio ARP proxy entre R1 y R2. (1) R1 env√≠a una solicitud ARP para conocer la direcci√≥n MAC de PC3. (2) 192.168.3.11 no es la direcci√≥n IP de R2, pero R2 tiene una ruta a 192.168.3.0/24 en su tabla de enrutamiento, por lo que R2 usa ARP proxy para responder en nombre de PC3.</p> <p>Nota</p> <p>Un enrutador solo usar√° proxy ARP para responder a una solicitud ARP si tiene una ruta al destino en su tabla de enrutamiento. De lo contrario, ignorar√° la solicitud.</p> <p>El siguiente ejemplo muestra la tabla ARP de R1 (puede visualizarla con el comando <code>show arp</code>). Observe que se muestra la misma direcci√≥n MAC (<code>Hardware Addr</code>) para 192.168.12.2 y 192.168.3.11: la direcci√≥n MAC de la interfaz G0/0 de R2.</p> <pre><code>R1# show arp\nProtocol  Address          Age (min)  Hardware Addr   Type   Interface\n. . .\nInternet  192.168.3.11            0   5254.0003.e684  ARPA   GigabitEthernet0/0\n. . .\nInternet  192.168.12.2            0   5254.0003.e684  ARPA   GigabitEthernet0/0\n</code></pre> <p>La dependencia del proxy ARP es una desventaja de las rutas est√°ticas conectadas directamente por dos razones. En primer lugar, aunque el proxy ARP est√° habilitado en los routers Cisco por defecto, en algunos casos puede estar deshabilitado (por ejemplo, si R2 no es un router Cisco). Si el proxy ARP est√° deshabilitado en R2, no responder√° a la solicitud ARP de R1 y R1 no podr√° reenviar el paquete a PC3.</p> <p>La segunda desventaja es que R1 necesitar√° crear una entrada ARP independiente para cada host en 192.168.3.0/24. Considera que cada host en 192.168.3.0/24 est√° conectado directamente, por lo que intentar√° obtener la direcci√≥n MAC de cada host; esto podr√≠a desperdiciar memoria en R1 si hay muchos hosts en la red. Por otro lado, si se especifica la direcci√≥n IP del siguiente salto en lugar de la interfaz de salida, R1 solo necesitar√° una entrada ARP para reenviar paquetes a 192.168.3.0/24: una entrada ARP para el siguiente salto.</p> <p>Nota</p> <p>Aunque nos centramos en el R1 como ejemplo, lo mismo aplica para el R2, que considerar√° que las redes 192.168.1.0/24 y 192.168.3.0/24 est√°n conectadas directamente, as√≠ como para el R3, que considerar√° que la red 192.168.1.0/24 est√° conectada directamente.</p> <p>Deber√≠a conocer la definici√≥n de rutas est√°ticas conectadas directamente y poder configurarlas, pero debido a las desventajas de depender de ARP proxy, le recomiendo no usarlas en una red real. En su lugar, utilice rutas est√°ticas recursivas o la siguiente opci√≥n: rutas est√°ticas completamente especificadas.</p>","path":["Routers y rutas estaticas"],"tags":[]},{"location":"routers_y_rutas_estaticas/#rutas-estaticas-especificando-tanto-el-interfaz-de-salida-como-el-proximo-salto","level":3,"title":"Rutas est√°ticas especificando tanto el interfaz de salida como el pr√≥ximo salto","text":"<p>La tercera opci√≥n al configurar una ruta est√°tica es especificar tanto la interfaz de salida como el siguiente salto, lo que se denomina ruta est√°tica completamente especificada. Las siguientes son las mismas cuatro rutas est√°ticas, esta vez configuradas como rutas est√°ticas completamente especificadas:</p> <ul> <li><code>R1(config)# ip route 192.168.3.0 255.255.255.0 g0/0 192.168.12.2</code></li> <li><code>R2(config)# ip route 192.168.1.0 255.255.255.0 g0/0 192.168.12.1</code></li> <li><code>R2(config)# ip route 192.168.3.0 255.255.255.0 g0/1 192.168.23.2</code></li> <li><code>R3(config)# ip route 192.168.1.0 255.255.255.0 g0/0 192.168.23.1</code></li> </ul> <p>La ventaja de este tipo de ruta est√°tica es que el router sabe Tanto la direcci√≥n IP del siguiente salto como la interfaz desde la que se reenv√≠a el paquete; no es necesario realizar una b√∫squeda recursiva ni depender de ARP proxy. El siguiente ejemplo muestra c√≥mo aparece una ruta completamente especificada en la tabla de enrutamiento:</p> <pre><code>R1# show ip route\nCodes: L - local, C - connected, S - static, R - RIP, M - mobile, B - BGP\n. . .\nS     192.168.3.0/24 [1/0] via 192.168.12.2, GigabitEthernet0/0\n. . .\n</code></pre> <p>Este tipo de ruta est√°tica puede parecer la mejor de las tres, pero en realidad, se pueden usar rutas recursivas o est√°ticas completamente especificadas sin una diferencia notable en el rendimiento. Sin embargo, generalmente se deben evitar las rutas est√°ticas conectadas directamente.</p>","path":["Routers y rutas estaticas"],"tags":[]},{"location":"routers_y_rutas_estaticas/#configurando-una-ruta-por-defecto","level":3,"title":"Configurando una ruta por defecto","text":"<p>La ruta predeterminada es una ruta al destino menos espec√≠fico posible: 0.0.0.0/0. Esta ruta coincide con todas las direcciones IP posibles, desde 0.0.0.0 hasta 255.255.255.255. Al ser la ruta menos espec√≠fica posible, la ruta predeterminada solo se seleccionar√° si no hay rutas m√°s espec√≠ficas en la tabla de enrutamiento del enrutador.</p> <p>Una ruta predeterminada se utiliza a menudo para proporcionar una ruta a internet. Hay m√°s de un mill√≥n de rutas en la tabla de enrutamiento global de internet, una cantidad muy superior a la que la mayor√≠a de los enrutadores pueden gestionar. Afortunadamente, un enrutador no necesita conocer ninguna red de destino espec√≠fica en internet; si tiene una ruta predeterminada a internet, puede usarla para reenviar paquetes hacia internet, y la infraestructura del proveedor de servicios de internet (ISP) se encargar√° de reenviarlos al destino correcto.</p> <p>Se pueden usar rutas m√°s espec√≠ficas para destinos en la red corporativa interna, y el resto del tr√°fico (que no coincida con ninguna otra ruta) se enrutar√° utilizando la ruta predeterminada. La Figura 9.11 muestra un ejemplo: R1 tiene rutas espec√≠ficas a 192.168.2.0/24 y 192.168.3.0/24, y luego una ruta predeterminada a internet; los paquetes con destinos que no coincidan con 192.168.2.0/24 o 192.168.3.0/24 (o las rutas conectadas y locales de R1) se reenviar√°n utilizando la ruta predeterminada.</p> <p></p> <p>El R1 tiene dos rutas a redes de destino espec√≠ficas y una ruta predeterminada a Internet. (1) Una ruta a 192.168.2.0/24, con R2 G0/0 como siguiente salto. (2) Una ruta a 192.168.3.0/24, con R3 G0/0 como siguiente salto. (3) Una ruta predeterminada, con la direcci√≥n IP del ISP (203.0.113.2) como siguiente salto.</p> <p>Para configurar una ruta predeterminada, especifique la red de destino 0.0.0.0 y la m√°scara de red 0.0.0.0 en el comando ip route; esto da como resultado 0.0.0.0/0, que incluye todas las direcciones IP posibles. Si un enrutador no tiene una ruta predeterminada configurada, ver√° la instrucci√≥n ¬´Gateway of last resort is not set¬ª encima de las rutas en la tabla de enrutamiento, como se muestra en el siguiente ejemplo. Esto significa que el enrutador no tiene una ruta predeterminada:</p> <pre><code>R1# show ip route\nCodes: L - local, C - connected, S - static, R - RIP, M - mobile, B - BGP\n. . .\nGateway of last resort is not set\n. . .\n</code></pre> <p>Nota</p> <p>Puerta de enlace de √∫ltimo recurso (gateway of last resort) es otro t√©rmino para la puerta de enlace predeterminada (default gateway). La ruta predeterminada en un router es como la puerta de enlace predeterminada de un PC; se utiliza para reenviar tr√°fico a destinos fuera de las redes conocidas del router.</p> <p>Tras configurar las rutas est√°ticas que se muestran en la figura 9.11, el resultado cambia. En el siguiente ejemplo, utilizo el comando show ip route static para ver solo las rutas est√°ticas de R1. Observe que la direcci√≥n IP del ISP (203.0.113.2) ahora aparece como la puerta de enlace de √∫ltimo recurso:</p> <pre><code>R1# show ip route static\nCodes: L - local, C - connected, S - static, R - RIP, M - mobile, B - BGP\n. . .\n       ia - IS-IS inter area, * - candidate default, U - per-user static route\n. . .\nGateway of last resort is 203.0.113.2 to network 0.0.0.0\nS*    0.0.0.0/0 [1/0] via 203.0.113.2\nS     192.168.2.0/24 [1/0] via 192.168.12.2\nS     192.168.3.0/24 [1/0] via 192.168.13.2\n</code></pre> <p>Nota</p> <p>Anteriormente en este cap√≠tulo, mencion√© que un enrutador descartar√° los paquetes que no coincidan con ninguna ruta en su tabla de enrutamiento. Sin embargo, si el enrutador tiene una ruta predeterminada, esta situaci√≥n no ocurrir√°; la ruta predeterminada coincide con todas las direcciones IP. Si un paquete no coincide con una ruta m√°s espec√≠fica, el enrutador lo reenviar√° por la ruta predeterminada en lugar de descartarlo.</p>","path":["Routers y rutas estaticas"],"tags":[]},{"location":"routers_y_rutas_estaticas/#resumen","level":2,"title":"Resumen","text":"<ul> <li>El t√©rmino enrutamiento puede referirse al proceso de reenv√≠o de paquetes entre redes y a la creaci√≥n de una tabla de enrutamiento.</li> <li>Los hosts de una misma red pueden enviarse paquetes entre s√≠ sin necesidad de un enrutador. Sin embargo, para enviar paquetes a destinos fuera de la red local, se requiere un enrutador.</li> <li>El enrutador al que un host env√≠a paquetes destinados a redes externas se denomina puerta de enlace predeterminada. El host env√≠a los paquetes en tramas dirigidas a la direcci√≥n MAC de la puerta de enlace predeterminada.</li> <li>La puerta de enlace predeterminada de un host puede configurarse manualmente o aprenderse autom√°ticamente mediante DHCP.</li> <li>Puede usar el comando ipconfig en el S√≠mbolo del sistema de Windows para ver informaci√≥n como la direcci√≥n IP, la m√°scara de red y la puerta de enlace predeterminada del PC.</li> <li>La tabla de enrutamiento es la base de datos de destinos conocidos del enrutador. Es un conjunto de instrucciones sobre qu√© hacer con los paquetes. La tabla de enrutamiento se puede ver con show ip route.</li> <li>Para cada interfaz que tenga una direcci√≥n IP y est√© activa/activa, el enrutador agregar√° autom√°ticamente dos rutas a su tabla de enrutamiento: una ruta conectada y una ruta local. Una ruta conectada es una ruta a la red a la que est√° conectada una interfaz. Las rutas conectadas se indican mediante el c√≥digo C en la tabla de enrutamiento. Si un enrutador recibe un paquete destinado a un host en una red conectada directamente, lo reenviar√° directamente al host de destino (en una trama dirigida a la direcci√≥n MAC del host).</li> <li>Una ruta local es una ruta a la misma direcci√≥n IP configurada en la interfaz. Las rutas locales utilizan un prefijo /32 para especificar una √∫nica direcci√≥n IP. Si un enrutador recibe un paquete destinado a la direcci√≥n IP de una ruta local, significa que el paquete est√° destinado al propio enrutador; este lo recibir√° para s√≠ mismo, no lo reenviar√°.</li> <li>Una ruta a m√°s de una direcci√≥n IP de destino (cualquier ruta con un prefijo menor que /32) se denomina ruta de red. Una ruta conectada es un ejemplo de ruta de red.</li> <li>Una ruta a una √∫nica direcci√≥n IP de destino (una ruta con un prefijo /32) se denomina ruta de host. Una ruta local es un ejemplo de ruta de host. El proceso de decidir qu√© ruta es la adecuada para reenviar un paquete se denomina selecci√≥n de ruta. Para determinar c√≥mo reenviar un paquete en particular, el enrutador seleccionar√° la ruta m√°s espec√≠fica (la que tenga el prefijo m√°s largo).</li> <li>Una ruta /32 es la m√°s espec√≠fica posible; especifica solo una direcci√≥n IP. Una ruta /0 (ruta predeterminada) es la menos espec√≠fica posible; especifica todas las direcciones IP posibles.</li> <li>Mientras que el reenv√≠o de capa 3 implica buscar en la tabla de enrutamiento la ruta m√°s espec√≠fica, el reenv√≠o de capa 2 implica buscar una coincidencia exacta en la tabla de direcciones MAC; las coincidencias parciales no cuentan.</li> <li>Si no hay rutas que coincidan con la direcci√≥n IP de destino de un paquete, el enrutador lo descartar√°.</li> <li>Para enrutar paquetes a destinos que no est√°n conectados directamente al enrutador, este necesita aprender las rutas a esos destinos mediante enrutamiento din√°mico (mediante un protocolo como OSPF) o enrutamiento est√°tico (en el que las rutas se configuran manualmente en el enrutador). Para reenviar un paquete a un destino remoto, el enrutador lo encapsula en una trama destinada a la direcci√≥n MAC del siguiente salto (el siguiente enrutador en la ruta hacia el destino).</li> <li>Para que un enrutador reenv√≠e paquetes entre dos hosts, necesita rutas a la red de cada host; no necesita rutas a todas las redes en la ruta entre cada destino.</li> <li>El comando para configurar una ruta est√°tica es ip route destination-network netmask {next-hop | exit-interface | exit-interface next-hop}.</li> <li>Una ruta est√°tica que especifica solo el siguiente salto se denomina ruta est√°tica recursiva; requiere m√∫ltiples b√∫squedas en la tabla de enrutamiento para reenviar un paquete: una para encontrar la direcci√≥n IP del siguiente salto y otra para encontrar la interfaz a la que est√° conectado el siguiente salto.</li> <li>Una ruta est√°tica que especifica solo la interfaz de salida se denomina ruta est√°tica conectada directamente porque hace que el enrutador trate la red como una red conectada directamente.</li> <li>Las rutas est√°ticas conectadas directamente requieren ARP proxy para funcionar. ARP proxy permite que un enrutador responda a las solicitudes ARP en nombre de otros hosts. El proxy ARP est√° habilitado en los routers Cisco de forma predeterminada, pero podr√≠a no estarlo en los routers de otros proveedores.</li> <li>Una ruta est√°tica que especifica tanto la interfaz de salida como el siguiente salto se denomina ruta est√°tica completamente especificada.</li> <li>Una ruta predeterminada es una ruta a 0.0.0.0/0. Al ser la ruta menos espec√≠fica posible, solo se utilizar√° para reenviar paquetes que no coincidan con ninguna otra ruta en la tabla de enrutamiento.</li> <li>Si un router tiene una ruta predeterminada, no descartar√° los paquetes que no coincidan con otras rutas; en su lugar, los reenviar√° utilizando la ruta predeterminada.</li> <li>La ruta predeterminada se utiliza a menudo para proporcionar una ruta a internet; no es posible que un router aprenda rutas espec√≠ficas para cada posible...</li> </ul>","path":["Routers y rutas estaticas"],"tags":[]}]}