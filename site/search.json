{"config":{"separator":"[\\s\\-_,:!=\\[\\]()\\\\\"`/]+|\\.(?!\\d)"},"items":[{"location":"","level":1,"title":"Index","text":"<p>P√°gina de apuntes del m√≥dulo de Planificaci√≥n y administraci√≥n de redes (PARE), de 1¬∫ de ASIR en el IES Severo Ochoa de Elche.</p>","path":["Index"],"tags":[]},{"location":"RIP_RIPv2/","level":1,"title":"RIP (Routing Information Protocol)","text":"","path":["Enrutamiento","RIP (Routing Information Protocol)"],"tags":[]},{"location":"RIP_RIPv2/#1-introduccion-a-rip","level":2,"title":"1. Introducci√≥n a RIP","text":"<p>RIP (Routing Information Protocol) es un protocolo de enrutamiento din√°mico dise√±ado para permitir que los routers intercambien informaci√≥n de rutas de forma autom√°tica. Pertenece a la categor√≠a de protocolos IGP (Interior Gateway Protocol) y se utiliza dentro de un mismo sistema aut√≥nomo.</p> <p>RIP es un protocolo de tipo vector-distancia, lo que significa que cada router toma decisiones bas√°ndose √∫nicamente en la informaci√≥n recibida de sus vecinos directos, sin conocer la topolog√≠a completa de la red. Aunque hoy en d√≠a est√° pr√°cticamente obsoleto en entornos profesionales, su estudio es clave para entender los fundamentos del enrutamiento din√°mico.</p>","path":["Enrutamiento","RIP (Routing Information Protocol)"],"tags":[]},{"location":"RIP_RIPv2/#2-funcionamiento-general-de-rip","level":2,"title":"2. Funcionamiento general de RIP","text":"<p>El funcionamiento de RIP se basa en la m√©trica del n√∫mero de saltos. Cada router que atraviesa un paquete cuenta como un salto, y la ruta con menor n√∫mero de saltos es considerada la mejor. RIP establece un l√≠mite m√°ximo de 15 saltos, lo que restringe su uso a redes peque√±as. Cualquier ruta con m√©trica 16 se considera inalcanzable.</p> <p>Los routers que ejecutan RIP env√≠an peri√≥dicamente su tabla de enrutamiento completa cada 30 segundos. Estas actualizaciones peri√≥dicas simplifican el dise√±o del protocolo, pero hacen que la convergencia sea lenta y que se genere tr√°fico incluso cuando no hay cambios en la red.</p>","path":["Enrutamiento","RIP (Routing Information Protocol)"],"tags":[]},{"location":"RIP_RIPv2/#3-protocolos-vector-distancia-y-problemas-asociados","level":2,"title":"3. Protocolos vector-distancia y problemas asociados","text":"<p>En los protocolos vector-distancia, cada router conf√≠a en la informaci√≥n que le proporcionan sus vecinos. Cuando un router recibe una ruta anunciada, incrementa la m√©trica en una unidad y la compara con la que ya tiene en su tabla. Si la nueva ruta es mejor, la sustituye.</p> <p>Este mecanismo puede provocar problemas como bucles de enrutamiento o rutas inconsistentes cuando se producen fallos. Para mitigar estos problemas, RIP incorpora mecanismos como split horizon, route poisoning y temporizadores de espera.</p>","path":["Enrutamiento","RIP (Routing Information Protocol)"],"tags":[]},{"location":"RIP_RIPv2/#4-ripv1-vision-general","level":2,"title":"4. RIPv1: visi√≥n general","text":"<p>RIPv1 es la primera versi√≥n del protocolo y est√° definida en el RFC 1058. Es un protocolo classful, lo que implica que no incluye la m√°scara de red en sus anuncios. Los routers asumen autom√°ticamente las m√°scaras por defecto seg√∫n la clase de la direcci√≥n IP, lo que impide el uso de VLSM y CIDR.</p> <p>Adem√°s, RIPv1 no incluye ning√∫n mecanismo de autenticaci√≥n, por lo que es vulnerable a anuncios de rutas falsos. Las actualizaciones se env√≠an mediante broadcast, lo que provoca que todos los dispositivos de la red reciban estos mensajes, incluso aunque no participen en el protocolo.</p>","path":["Enrutamiento","RIP (Routing Information Protocol)"],"tags":[]},{"location":"RIP_RIPv2/#5-ripv2-version-moderna-de-rip","level":2,"title":"5. RIPv2: versi√≥n moderna de RIP","text":"<p>RIPv2 surge para corregir las limitaciones de RIPv1 y est√° definido en el RFC 2453. Mantiene la simplicidad del protocolo original, pero introduce mejoras fundamentales que lo hacen mucho m√°s flexible y seguro, especialmente en entornos educativos y de laboratorio.</p> <p>La mejora m√°s importante es que RIPv2 es un protocolo classless. Esto significa que cada ruta anunciada incluye su m√°scara de red, permitiendo el uso de VLSM y CIDR. Gracias a esto, es posible dise√±ar esquemas de direccionamiento m√°s eficientes, con subredes de distintos tama√±os y sin desperdiciar direcciones IP.</p> <p>Otra mejora clave es el uso de multicast en lugar de broadcast. RIPv2 env√≠a sus actualizaciones a la direcci√≥n 224.0.0.9, lo que reduce la carga en los dispositivos que no participan en RIP. Adem√°s, RIPv2 permite la autenticaci√≥n de las actualizaciones, lo que evita que routers no autorizados inyecten rutas falsas en la red.</p>","path":["Enrutamiento","RIP (Routing Information Protocol)"],"tags":[]},{"location":"RIP_RIPv2/#6-temporizadores-en-ripv2","level":2,"title":"6. Temporizadores en RIPv2","text":"<p>El comportamiento de RIPv2 est√° gobernado por varios temporizadores que determinan c√≥mo y cu√°ndo se intercambia la informaci√≥n de enrutamiento. Cada 30 segundos se env√≠a una actualizaci√≥n peri√≥dica con todas las rutas conocidas. Si un router deja de recibir informaci√≥n sobre una ruta durante 180 segundos, la marca como inv√°lida. Tras este periodo, entra en funcionamiento el temporizador de limpieza, que elimina definitivamente la ruta de la tabla.</p> <p>Estos temporizadores explican por qu√© RIPv2 tiene una convergencia lenta en comparaci√≥n con protocolos m√°s modernos como OSPF.</p>","path":["Enrutamiento","RIP (Routing Information Protocol)"],"tags":[]},{"location":"RIP_RIPv2/#7-configuracion-basica-de-ripv2-en-cisco","level":2,"title":"7. Configuraci√≥n b√°sica de RIPv2 en Cisco","text":"<p>En dispositivos Cisco, la configuraci√≥n de RIPv2 se realiza desde el proceso de enrutamiento RIP. Es fundamental especificar expl√≠citamente la versi√≥n 2 y desactivar la sumarizaci√≥n<sup>1</sup> autom√°tica para evitar problemas en redes con VLSM.</p> <pre><code>Router&gt; enable\nRouter# configure terminal\nRouter(config)# router rip\nRouter(config-router)# version 2\nRouter(config-router)# no auto-summary\nRouter(config-router)# network 192.168.1.0\nRouter(config-router)# network 10.0.0.0\nRouter(config-router)# end\n</code></pre> <p>El comando <code>network</code> no indica directamente qu√© rutas se anuncian, sino en qu√© interfaces se activa RIP. Todas las interfaces cuya direcci√≥n IP pertenezca a esa red participar√°n en el protocolo.</p>","path":["Enrutamiento","RIP (Routing Information Protocol)"],"tags":[]},{"location":"RIP_RIPv2/#8-control-del-envio-de-actualizaciones-rip","level":2,"title":"8. Control del env√≠o de actualizaciones RIP","text":"<p>En muchos escenarios es recomendable limitar el env√≠o de actualizaciones RIP hacia determinadas interfaces, especialmente hacia redes LAN donde no hay otros routers. Esto se consigue mediante interfaces pasivas.</p> <pre><code>Router(config)# router rip\nRouter(config-router)# passive-interface g0/0\n</code></pre> <p>Con este comando, la interfaz sigue anunciando su red, pero deja de enviar actualizaciones RIP por ella.</p>","path":["Enrutamiento","RIP (Routing Information Protocol)"],"tags":[]},{"location":"RIP_RIPv2/#9-redistribucion-de-rutas-estaticas-en-ripv2","level":2,"title":"9. Redistribuci√≥n de rutas est√°ticas en RIPv2","text":"<p>RIPv2 permite redistribuir rutas est√°ticas dentro del proceso de enrutamiento din√°mico. Esto es √∫til cuando existen redes que no se pueden aprender din√°micamente.</p> <pre><code>Router(config)# ip route 192.168.50.0 255.255.255.0 10.0.0.2\nRouter(config)# router rip\nRouter(config-router)# redistribute static\n</code></pre> <p>Las rutas est√°ticas redistribuidas aparecer√°n como rutas RIP en los routers vecinos.</p>","path":["Enrutamiento","RIP (Routing Information Protocol)"],"tags":[]},{"location":"RIP_RIPv2/#10-autenticacion-en-ripv2","level":2,"title":"10. Autenticaci√≥n en RIPv2","text":"<p>Para proteger las actualizaciones RIP, RIPv2 permite el uso de autenticaci√≥n. En entornos Cisco, la opci√≥n m√°s habitual es la autenticaci√≥n mediante MD5, que proporciona integridad y autenticaci√≥n de origen.</p> <p>Primero se crea una cadena de claves:</p> <pre><code>Router(config)# key chain RIP_KEYS\nRouter(config-keychain)# key 1\nRouter(config-keychain-key)# key-string cisco123\n</code></pre> <p>A continuaci√≥n, se aplica la autenticaci√≥n a la interfaz correspondiente:</p> <pre><code>Router(config)# interface g0/1\nRouter(config-if)# ip rip authentication mode md5\nRouter(config-if)# ip rip authentication key-chain RIP_KEYS\n</code></pre> <p>Ambos extremos del enlace deben tener la misma configuraci√≥n para que las actualizaciones se acepten correctamente.</p>","path":["Enrutamiento","RIP (Routing Information Protocol)"],"tags":[]},{"location":"RIP_RIPv2/#11-verificacion-y-diagnostico-en-ripv2","level":2,"title":"11. Verificaci√≥n y diagn√≥stico en RIPv2","text":"<p>Una parte esencial de la configuraci√≥n de RIPv2 es la verificaci√≥n. El comando <code>show ip route</code> permite comprobar que las rutas RIP se est√°n aprendiendo correctamente y muestra la m√©trica y el siguiente salto.</p> <pre><code>Router# show ip route\n</code></pre> <p>El comando <code>show ip protocols</code> proporciona informaci√≥n detallada sobre el proceso RIP, incluyendo temporizadores, redes anunciadas y versi√≥n del protocolo.</p> <pre><code>Router# show ip protocols\n</code></pre> <p>Para observar el funcionamiento interno del protocolo, se puede utilizar:</p> <pre><code>Router# debug ip rip\n</code></pre> <p>Este comando muestra en tiempo real el intercambio de actualizaciones, aunque debe utilizarse con precauci√≥n en redes grandes.</p>","path":["Enrutamiento","RIP (Routing Information Protocol)"],"tags":[]},{"location":"RIP_RIPv2/#12-conclusion","level":2,"title":"12. Conclusi√≥n","text":"<p>RIPv2 es un protocolo sencillo pero muy valioso desde el punto de vista formativo. Su estudio permite comprender conceptos esenciales como el enrutamiento din√°mico, el uso de m√©tricas, la convergencia, el impacto de los temporizadores y la importancia de la autenticaci√≥n en protocolos de red. Estos conocimientos sirven como base s√≥lida para abordar posteriormente protocolos m√°s avanzados como OSPF o EIGRP.</p> <p>Sin embargo, su uso es pr√°cticamente residual en escenarios nicho (redes TO o tecnolog√≠a operativa p.ej. ), legacy o redes muy peque√±as donde la simplicidad es preferible a los beneficios de protocolos m√°s modernos.</p>","path":["Enrutamiento","RIP (Routing Information Protocol)"],"tags":[]},{"location":"RIP_RIPv2/#referencias","level":2,"title":"Referencias","text":"<ul> <li>RIP: Routing Information Protocol</li> </ul> <ol> <li> <p>Agregaci√≥n de rutas ‚Ü©</p> </li> </ol>","path":["Enrutamiento","RIP (Routing Information Protocol)"],"tags":[]},{"location":"SecSwitches/","level":1,"title":"Gu√≠a Completa de Seguridad en Switches Cisco","text":"","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#1-vlans-virtual-local-area-networks","level":2,"title":"1. VLANs (Virtual Local Area Networks)","text":"","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#concepto-teorico-detallado","level":3,"title":"Concepto Te√≥rico Detallado","text":"<p>¬øQu√© es una VLAN? Una VLAN es una red l√≥gica independiente dentro de una red f√≠sica. Imagina un edificio de oficinas donde cada departamento tiene su propio espacio privado aunque compartan el mismo edificio f√≠sico.</p> <p>Problema que resuelve:</p> <ul> <li>Dominios de broadcast grandes: Sin VLANs, toda la red recibe tr√°fico broadcast</li> <li>Seguridad: Dispositivos en diferentes departamentos pueden comunicarse libremente</li> <li>Rendimiento: Tr√°fico innecesario en todos los puertos</li> </ul> <p>Tipos de VLANs:</p> <ul> <li>VLAN de datos: Para usuarios finales</li> <li>VLAN de voz: Para tr√°fico VoIP (prioridad alta)</li> <li>VLAN de administraci√≥n: Para gesti√≥n del switch</li> <li>VLAN nativa: Para tr√°fico sin etiquetar en trunks</li> </ul> <p></p> <p></p>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#que-es-un-trunk","level":3,"title":"¬øQu√© es un trunk?","text":"<p>Un trunk es un enlace de red que transporta m√∫ltiples VLANs simult√°neamente entre switches o entre un switch y un router.*</p>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#analogia-para-entenderlo","level":3,"title":"Analog√≠a para Entenderlo","text":"<pre><code># SIN TRUNK (Access Ports):\nCada VLAN = Carretera separada\nPuerto access = Rampa de entrada/salida a UNA carretera\n\n# CON TRUNK:\nTrunk = Autopista con M√öLTIPLES carriles (cada carril = una VLAN)\nCada frame lleva \"etiqueta\" que dice a qu√© carril (VLAN) pertenece\n</code></pre>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#problema-que-resuelve","level":3,"title":"Problema que Resuelve","text":"<pre><code># ESCENARIO SIN TRUNK:\nSwitch A (VLAN 10,20,30) --- Switch B (VLAN 10,20,30)\nNecesitar√≠as: 3 cables separados (uno por VLAN)\n‚ùå Ineficiente ‚ùå Costoso ‚ùå No escalable\n\n# ESCENARIO CON TRUNK:\nSwitch A (VLAN 10,20,30) ---[UN CABLE]--- Switch B (VLAN 10,20,30)\n‚úÖ Un solo cable transporta TODAS las VLANs\n‚úÖ Eficiente ‚úÖ Escalable ‚úÖ Flexible\n</code></pre>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#como-funciona-el-trunking-tecnicamente","level":2,"title":"üèóÔ∏è C√≥mo Funciona el Trunking T√©cnicamente","text":"","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#protocolo-8021q-dot1q","level":3,"title":"Protocolo 802.1Q (Dot1Q)","text":"","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#ejemplo-de-etiquetado","level":3,"title":"Ejemplo de Etiquetado","text":"","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#configuracion-de-trunks-en-cisco","level":2,"title":"‚öôÔ∏è Configuraci√≥n de Trunks en Cisco","text":"","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#comandos-basicos","level":3,"title":"Comandos B√°sicos","text":"<pre><code>! CONFIGURAR PUERTO COMO TRUNK\nSwitch(config)# interface gigabitethernet 0/1\nSwitch(config-if)# switchport mode trunk\n! El puerto ahora transporta TODAS las VLANs\n\n! LIMITAR VLANs PERMITIDAS EN EL TRUNK\nSwitch(config-if)# switchport trunk allowed vlan 10,20,30\n! Solo estas VLANs pueden pasar por el trunk\n\n! VERIFICACI√ìN\nSwitch# show interfaces trunk\nPort        Mode         Encapsulation  Status        Native vlan\nGi0/1       on           802.1q         trunking      1\n\nPort        Vlans allowed on trunk\nGi0/1       10,20,30\n</code></pre>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#modos-de-operacion-de-puertos","level":3,"title":"Modos de Operaci√≥n de Puertos","text":"<pre><code># SWITCHPORT MODE TRUNK ‚Üí Forza trunk, negocia DTP\n# SWITCHPORT MODE DYNAMIC DESIRABLE ‚Üí Intenta formar trunk\n# SWITCHPORT MODE DYNAMIC AUTO ‚Üí Espera que otro inicie trunk  \n# SWITCHPORT MODE ACCESS ‚Üí Solo una VLAN (no trunk)\n</code></pre>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#que-es-la-vlan-nativa","level":2,"title":"üè∑Ô∏è ¬øQu√© es la VLAN NATIVA?","text":"","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#concepto-fundamental","level":3,"title":"Concepto Fundamental","text":"<p>La VLAN nativa es la √∫nica VLAN cuyos frames viajan SIN etiqueta 802.1Q a trav√©s de un trunk.</p>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#proposito-de-la-vlan-nativa","level":3,"title":"Prop√≥sito de la VLAN Nativa","text":"<pre><code># COMUNICACI√ìN CON DISPOSITIVOS QUE NO ENTIENDEN 802.1Q\n- Dispositivos legacy\n- Algunos servidores\n- Equipos de red antiguos\n- Dispositivos que no soportan VLAN tagging\n</code></pre>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#comportamiento","level":3,"title":"Comportamiento","text":"<pre><code># PARA TR√ÅFICO DE VLAN NATIVA:\nFrame entra al trunk ‚Üí NO se a√±ade etiqueta 802.1Q\nFrame sale del trunk ‚Üí Se asume que pertenece a VLAN nativa\n\n# PARA TR√ÅFICO DE OTRAS VLANs:\nFrame entra al trunk ‚Üí SE A√ëADE etiqueta 802.1Q con VLAN ID\nFrame sale del trunk ‚Üí SE REMUEVE etiqueta, se env√≠a a VLAN correcta\n</code></pre>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#importante-consideraciones-de-seguridad","level":2,"title":"‚ö†Ô∏è IMPORTANTE: Consideraciones de Seguridad","text":"","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#problema-de-seguridad-con-vlan-nativa","level":3,"title":"Problema de Seguridad con VLAN Nativa","text":"<pre><code># ATAQUE DE SALTO DE VLAN (VLAN HOPPING)\nAtacante puede:\n1. Enviar frames etiquetados con VLAN nativa\n2. Switch puede remover etiqueta y enviar a VLAN nativa\n3. Posible acceso no autorizado a VLAN nativa\n\n# SOLUCI√ìN RECOMENDADA:\nNUNCA usar VLAN 1 como nativa\nUsar VLAN \"basura\" no utilizada para nativa\n</code></pre>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#configuracion-segura","level":3,"title":"Configuraci√≥n Segura","text":"<pre><code>! CONFIGURACI√ìN NO SEGURA (POR DEFECTO)\nSwitch(config-if)# switchport trunk native vlan 1\n! ‚ùå VLAN 1 es default y puede tener dispositivos\n\n! CONFIGURACI√ìN SEGURA (RECOMENDADA)\nSwitch(config-if)# switchport trunk native vlan 999\nSwitch(config)# vlan 999  \nSwitch(config-vlan)# name VLAN_BASURA_NATIVA\nSwitch(config-vlan)# exit\n! ‚úÖ VLAN 999 no tiene dispositivos, solo existe para tr√°fico nativo\n</code></pre>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#configuracion-completa-y-segura","level":2,"title":"üîß Configuraci√≥n Completa y Segura","text":"","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#ejemplo-practico-corporativo","level":3,"title":"Ejemplo Pr√°ctico Corporativo","text":"<pre><code>! ESCENARIO: Empresa con 3 departamentos + VLAN de administraci√≥n\n\n! CREAR VLANs\nSwitch(config)# vlan 10\nSwitch(config-vlan)# name VENTAS\nSwitch(config-vlan)# vlan 20\nSwitch(config-vlan)# name IT\nSwitch(config-vlan)# vlan 30\nSwitch(config-vlan)# name CONTABILIDAD\nSwitch(config-vlan)# vlan 99\nSwitch(config-vlan)# name ADMIN\nSwitch(config-vlan)# vlan 999\nSwitch(config-vlan)# name NATIVA_SEGURA\nSwitch(config-vlan)# exit\n\n! CONFIGURAR TRUNK SEGURO\nSwitch(config)# interface gigabitethernet 0/1\nSwitch(config-if)# description TRUNK_TO_CORE_SWITCH\nSwitch(config-if)# switchport mode trunk\nSwitch(config-if)# switchport trunk native vlan 999\nSwitch(config-if)# switchport trunk allowed vlan 10,20,30,99\n! ‚úÖ Solo las VLANs necesarias\n! ‚úÖ VLAN nativa segura (999)\n! ‚úÖ Explic√≠tamente no permite VLAN 1\n\n! CONFIGURAR EL OTRO EXTREMO (SWITCH CORE)\nCoreSwitch(config)# interface gigabitethernet 0/1  \nCoreSwitch(config-if)# description TRUNK_TO_ACCESS_SWITCH\nCoreSwitch(config-if)# switchport mode trunk\nCoreSwitch(config-if)# switchport trunk native vlan 999\nCoreSwitch(config-if)# switchport trunk allowed vlan 10,20,30,99\n</code></pre>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#configuracion-de-puertos-de-acceso","level":3,"title":"Configuraci√≥n de Puertos de Acceso","text":"<pre><code>! PUERTOS PARA USUARIOS (NO TRUNK)\nSwitch(config)# interface range fastethernet 0/1-8\nSwitch(config-if-range)# switchport mode access\nSwitch(config-if-range)# switchport access vlan 10\nSwitch(config-if-range)# description USUARIOS_VENTAS\n\nSwitch(config)# interface range fastethernet 0/9-16  \nSwitch(config-if-range)# switchport mode access\nSwitch(config-if-range)# switchport access vlan 20\nSwitch(config-if-range)# description USUARIOS_IT\n</code></pre>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#verificacion-y-troubleshooting","level":2,"title":"üìä Verificaci√≥n y Troubleshooting","text":"","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#comandos-de-verificacion","level":3,"title":"Comandos de Verificaci√≥n","text":"<pre><code>! VER ESTADO DE TRUNKS\nSwitch# show interfaces trunk\nPort        Mode         Encapsulation  Status        Native vlan\nGi0/1       on           802.1q         trunking      999\nGi0/2       auto         802.1q         trunking      1\n\nPort        Vlans allowed on trunk\nGi0/1       10,20,30,99\nGi0/2       1-4094\n\n! VER CONFIGURACI√ìN DE INTERFAZ ESPEC√çFICA\nSwitch# show interfaces gigabitethernet 0/1 switchport\nName: Gi0/1\nSwitchport: Enabled\nAdministrative Mode: trunk\nOperational Mode: trunk\nAdministrative Trunking Encapsulation: dot1q\nOperational Trunking Encapsulation: dot1q\nNegotiation of Trunking: On\nAccess Mode VLAN: 1 (default)\nTrunking Native Mode VLAN: 999 (VLAN_BASURA_NATIVA)\nTrunking VLANs Enabled: 10,20,30,99\n\n! VER ESTAD√çSTICAS DE TRUNK\nSwitch# show interfaces gigabitethernet 0/1 trunk\nPort        Vlans allowed on trunk\nGi0/1       10,20,30,99\n\nPort        Vlans allowed and active in management domain\nGi0/1       10,20,30,99\n\nPort        Vlans in spanning tree forwarding state and not pruned\nGi0/1       10,20,30,99\n</code></pre>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#troubleshooting-comun","level":3,"title":"Troubleshooting Com√∫n","text":"<pre><code># PROBLEMA 1: Trunk no se forma\nCAUSA: Mismatch en configuraci√≥n de trunk\nSOLUCI√ìN: Verificar que ambos lados est√©n en \"switchport mode trunk\"\n\n# PROBLEMA 2: VLAN nativa mismatch  \nCAUSA: Diferente VLAN nativa en cada extremo\nS√çNTOMA: P√©rdida de conectividad para VLAN nativa\nSOLUCI√ìN: Configurar misma VLAN nativa en ambos extremos\n\n# PROBLEMA 3: VLAN no permitida en trunk\nCAUSA: VLAN no est√° en \"allowed vlan list\"\nS√çNTOMA: Dispositivos en esa VLAN no pueden comunicarse through trunk\nSOLUCI√ìN: A√±adir VLAN a la lista permitida\n</code></pre>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#resumen-de-conceptos-clave","level":2,"title":"Resumen de Conceptos Clave","text":"","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#trunk","level":3,"title":"TRUNK:","text":"<pre><code>‚úÖ Transporta M√öLTIPLES VLANs en un solo enlace f√≠sico\n‚úÖ Usa etiquetado 802.1Q para identificar a qu√© VLAN pertenece cada frame\n‚úÖ Esencial para conectar switches en redes con m√∫ltiples VLANs\n‚úÖ Debe configurarse igual en ambos extremos del enlace\n</code></pre>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#vlan-nativa","level":3,"title":"VLAN NATIVA:","text":"<pre><code>‚úÖ √önica VLAN que viaja SIN etiqueta 802.1Q en un trunk\n‚úÖ Por defecto es VLAN 1 (‚ùå INSECURO)\n‚úÖ Mejor pr√°ctica: Usar VLAN no utilizada (ej: 999)\n‚úÖ Debe coincidir en ambos extremos del trunk\n</code></pre>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#mejores-practicas","level":3,"title":"MEJORES PR√ÅCTICAS:","text":"<pre><code>1. ‚úÖ NUNCA usar VLAN 1 para nada\n2. ‚úÖ Usar VLAN dedicada no utilizada como nativa (999, 4094, etc.)\n3. ‚úÖ Limitar VLANs permitidas en trunk solo a las necesarias\n4. ‚úÖ Deshabilitar puertos no utilizados\n5. ‚úÖ Configurar manualmente trunks en lugar de usar auto-negotiation\n6. ‚úÖ Documentar configuraci√≥n de trunks\n</code></pre>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#comandos-explicados-paso-a-paso","level":3,"title":"Comandos Explicados Paso a Paso","text":"<pre><code>! CREACI√ìN DE VLANs\nSwitch# configure terminal\nSwitch(config)# vlan 10\n! El comando 'vlan 10' crea o entra en la configuraci√≥n de la VLAN 10\n! Las VLANs 1-1005 son est√°ndar, 1006-4094 son extendidas\n\nSwitch(config-vlan)# name VENTAS\n! 'name' asigna un nombre descriptivo para identificar la VLAN f√°cilmente\n\nSwitch(config-vlan)# exit\n! Sale del modo de configuraci√≥n de VLAN\n\n! ASIGNACI√ìN DE PUERTOS A VLANs\nSwitch(config)# interface fastethernet 0/1\n! Selecciona el puerto f√≠sico para configurar\n\nSwitch(config-if)# switchport mode access\n! 'switchport mode access' configura el puerto como acceso (solo una VLAN)\n! Esto significa que el dispositivo conectado no espera etiquetas VLAN\n\nSwitch(config-if)# switchport access vlan 10\n! Asigna el puerto espec√≠ficamente a la VLAN 10\n! El dispositivo conectado estar√° en la red l√≥gica de VENTAS\n\n! CONFIGURACI√ìN DE PUERTOS TRUNK\nSwitch(config)# interface gigabitethernet 0/1\nSwitch(config-if)# switchport mode trunk\n! 'switchport mode trunk' configura el puerto para transportar m√∫ltiples VLANs\n! Los trunks usan etiquetas 802.1Q para identificar a qu√© VLAN pertenece cada frame\n\nSwitch(config-if)# switchport trunk native vlan 999\n! 'native vlan' define qu√© VLAN viaja sin etiquetar\n! Por seguridad, NUNCA usar VLAN 1 como nativa\n\nSwitch(config-if)# switchport trunk allowed vlan 10,20,30\n! 'allowed vlan' especifica qu√© VLANs pueden pasar por el trunk\n! Esto proporciona control granular sobre qu√© VLANs se propagan\n\n! VERIFICACI√ìN\nSwitch# show vlan brief\n! Muestra todas las VLANs y qu√© puertos est√°n asignados a cada una\nSwitch# show interfaces trunk\n! Muestra informaci√≥n detallada sobre puertos trunk\n</code></pre>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#ejemplo-practico-completo","level":3,"title":"Ejemplo Pr√°ctico Completo","text":"<pre><code>! ESCENARIO: Empresa con 3 departamentos\nSwitch(config)# vlan 10\nSwitch(config-vlan)# name VENTAS\nSwitch(config-vlan)# exit\n\nSwitch(config)# vlan 20\nSwitch(config-vlan)# name IT\nSwitch(config-vlan)# exit\n\nSwitch(config)# vlan 30\nSwitch(config-vlan)# name CONTABILIDAD\nSwitch(config-vlan)# exit\n\nSwitch(config)# vlan 99\nSwitch(config-vlan)# name ADMINISTRACION\nSwitch(config-vlan)# exit\n\n! Asignar puertos a departamentos\nSwitch(config)# interface range fastethernet 0/1-8\nSwitch(config-if-range)# switchport mode access\nSwitch(config-if-range)# switchport access vlan 10\nSwitch(config-if-range)# description PUERTOS_VENTAS\n\nSwitch(config)# interface range fastethernet 0/9-16\nSwitch(config-if-range)# switchport mode access\nSwitch(config-if-range)# switchport access vlan 20\nSwitch(config-if-range)# description PUERTOS_IT\n\n! Configurar IP de gesti√≥n en VLAN de administraci√≥n\nSwitch(config)# interface vlan 99\nSwitch(config-if)# ip address 192.168.99.10 255.255.255.0\nSwitch(config-if)# no shutdown\n! Esto permite administrar el switch remotamente mediante SSH/Telnet\n</code></pre>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#2-port-security","level":2,"title":"2. Port Security","text":"","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#concepto-teorico-detallado_1","level":3,"title":"Concepto Te√≥rico Detallado","text":"<p>¬øQu√© es Port Security? Es un mecanismo que restringe qu√© dispositivos pueden conectarse a un puerto del switch bas√°ndose en direcciones MAC.</p> <p></p> <p>Problemas que resuelve:</p> <ul> <li>Conectividad no autorizada: Evita que usuarios conecten dispositivos no autorizados</li> <li>Ataques MAC flooding: Previene que atacantes saturen la tabla MAC</li> <li>Robo de puertos: Impide usar puertos f√≠sicos para acceso no autorizado</li> </ul> <p>Mecanismos de aprendizaje de MAC:</p> <ul> <li>Est√°ticas: Se configuran manualmente</li> <li>Din√°micas: El switch aprende autom√°ticamente</li> <li>Sticky: Combina ambos - aprende y luego las hace est√°ticas</li> </ul>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#comandos-explicados-paso-a-paso_1","level":3,"title":"Comandos Explicados Paso a Paso","text":"<pre><code>! HABILITAR PORT SECURITY B√ÅSICO\nSwitch(config)# interface fastethernet 0/1\nSwitch(config-if)# switchport mode access\n! PRIMERO debe ser puerto de acceso para habilitar port security\n\nSwitch(config-if)# switchport port-security\n! Este comando ACTIVA la funcionalidad de port security en el puerto\n! Sin esto, los dem√°s comandos de port security no funcionar√°n\n\nSwitch(config-if)# switchport port-security maximum 2\n! 'maximum' define el n√∫mero m√°ximo de direcciones MAC permitidas\n! En este caso, permite hasta 2 dispositivos diferentes\n\n! TIPOS DE VIOLACI√ìN - CR√çTICOS PARA ENTENDER\nSwitch(config-if)# switchport port-security violation shutdown\n! 'violation shutdown' - EL M√ÅS SEGURO\n! - Cierra el puerto inmediatamente\n! - Lo coloca en estado err-disable\n! - Requiere intervenci√≥n manual para reactivar\n! - USAR EN ENTORNOS DE ALTA SEGURIDAD\n\nSwitch(config-if)# switchport port-security violation restrict\n! 'violation restrict' - MODO INTERMEDIO\n! - Permite tr√°fico de MACs conocidas\n! - Bloquea tr√°fico de MACs no autorizadas\n! - Genera logs pero mantiene el puerto activo\n! - BUENO para monitoreo sin interrumpir servicio\n\nSwitch(config-if)# switchport port-security violation protect\n! 'violation protect' - MODO MENOS RESTRICTIVO\n! - Solo bloquea frames de MACs no autorizadas\n! - No genera logs de violaci√≥n\n! - PUEDE PASAR DESAPERCIBIDO UN ATAQUE\n\n! M√âTODOS DE APRENDIZAJE DE MAC\nSwitch(config-if)# switchport port-security mac-address sticky\n! 'sticky' - EL M√ÅS PR√ÅCTICO\n! - Aprende las MACs que se conectan inicialmente\n! - Las convierte en direcciones est√°ticas autom√°ticamente\n! - Se guardan en la configuraci√≥n\n! - Perfecto para despliegues iniciales\n\nSwitch(config-if)# switchport port-security mac-address 0000.1111.2222\n! Configuraci√≥n MANUAL de MAC espec√≠fica\n! √ötil para dispositivos cr√≠ticos como impresoras o servidores\n\n! CONFIGURACIONES AVANZADAS\nSwitch(config-if)# switchport port-security aging time 120\n! 'aging time' define cu√°nto tiempo se mantiene una MAC en la tabla\n! 120 minutos = 2 horas\n\nSwitch(config-if)# switchport port-security aging type inactivity\n! 'inactivity' significa que el temporizador corre solo si no hay tr√°fico\n! Alternativa: 'absolute' (tiempo fijo independiente del tr√°fico)\n</code></pre>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#ejemplo-practico-completo_1","level":3,"title":"Ejemplo Pr√°ctico Completo","text":"<pre><code>! ESCENARIO: Oficina con pol√≠ticas de seguridad espec√≠ficas\n\n! Puerto para impresora (1 dispositivo fijo)\nSwitch(config)# interface fastethernet 0/5\nSwitch(config-if)# switchport mode access\nSwitch(config-if)# switchport access vlan 10\nSwitch(config-if)# switchport port-security\nSwitch(config-if)# switchport port-security maximum 1\nSwitch(config-if)# switchport port-security violation shutdown\nSwitch(config-if)# switchport port-security mac-address 0050.56AB.CDEF\nSwitch(config-if)# description IMPRESORA_SALA_VENTAS\n\n! Puerto para usuarios generales (hasta 3 dispositivos)\nSwitch(config)# interface fastethernet 0/10\nSwitch(config-if)# switchport mode access\nSwitch(config-if)# switchport access vlan 20\nSwitch(config-if)# switchport port-security\nSwitch(config-if)# switchport port-security maximum 3\nSwitch(config-if)# switchport port-security violation restrict\nSwitch(config-if)# switchport port-security mac-address sticky\nSwitch(config-if)# switchport port-security aging time 240\nSwitch(config-if)# description PUESTO_TRABAJO_USUARIO\n\n! Configurar recuperaci√≥n autom√°tica de err-disable\nSwitch(config)# errdisable recovery cause psecure-violation\nSwitch(config)# errdisable recovery interval 300\n! Esto reactiva autom√°ticamente puertos despu√©s de 5 minutos\n\n! VERIFICACI√ìN DETALLADA\nSwitch# show port-security\n! Muestra resumen de todos los puertos con port security\n\nSwitch# show port-security interface fastethernet 0/10\n! Muestra detalles espec√≠ficos del puerto:\n! - M√°ximo de direcciones permitidas\n! - Direcciones actualmente aprendidas\n! - Contador de violaciones\n! - Tipo de violaci√≥n configurado\n\nSwitch# show port-security address\n! Muestra la tabla de direcciones MAC seguras aprendidas\n</code></pre>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#3-dhcp-snooping","level":2,"title":"3. DHCP Snooping","text":"","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#pero-que-es-dhcp","level":2,"title":"¬øPero qu√© es DHCP?","text":"","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#que-es-dhcp","level":3,"title":"¬øQu√© es DHCP?","text":"<p>DHCP (Dynamic Host Configuration Protocol) es el \"servicio de entrega de direcciones\" autom√°tico de las redes. En lugar de configurar manualmente cada dispositivo, DHCP asigna autom√°ticamente:</p> <ul> <li>‚úÖ Direcci√≥n IP</li> <li>‚úÖ M√°scara de subred </li> <li>‚úÖ Gateway por defecto</li> <li>‚úÖ Servidores DNS</li> </ul>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#el-proceso-de-4-pasos-dora","level":2,"title":"El Proceso de 4 Pasos (DORA)","text":"","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#1discover-hay-algun-servidor-dhcp","level":3,"title":"1.DISCOVER - \"¬øHay alg√∫n servidor DHCP?\"","text":"<p><pre><code>Cliente ‚Üí Broadcast: \"¬°Hola! Necesito una IP, ¬øalguien puede ayudarme?\"\n</code></pre> - El cliente env√≠a broadcast sin IP - Todos los dispositivos en la red local lo reciben</p>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#2offer-si-te-ofrezco-esta-ip","level":3,"title":"2.OFFER - \"S√≠, te ofrezco esta IP\"","text":"<p><pre><code>Servidor DHCP ‚Üí Cliente: \"Te ofrezco la IP 192.168.1.100\"\n</code></pre> - Servidor reserva una IP disponible - Env√≠a oferta con configuraci√≥n de red</p>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#3request-acepto-tu-oferta","level":3,"title":"3.REQUEST - \"Acepto tu oferta\"","text":"<p><pre><code>Cliente ‚Üí Broadcast: \"Acepto la IP 192.168.1.100 del servidor X\"\n</code></pre> - Cliente confirma que acepta la IP - Se hace por broadcast por si hay m√∫ltiples servidores</p>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#4ack-confirmado-usa-esta-ip","level":3,"title":"4.ACK - \"Confirmado, usa esta IP\"","text":"<p><pre><code>Servidor DHCP ‚Üí Cliente: \"Confirmado, usa 192.168.1.100 por 24 horas\"\n</code></pre> - Confirmaci√≥n final del servidor - Incluye tiempo de arrendamiento (lease time)</p>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#renovacion-de-ip","level":2,"title":"Renovaci√≥n de IP","text":"<pre><code># A LOS 50% DEL TIEMPO DE ARRENDAMIENTO:\nCliente ‚Üí Servidor: \"¬øPuedo seguir usando esta IP?\"\nServidor ‚Üí Cliente: \"S√≠, renuevas por X tiempo m√°s\"\n\n# SI NO HAY RESPUESTA, INTENTA DE NUEVO AL 87.5%\n# SI EXPIRA ‚Üí VUELVE AL PASO 1 (DISCOVER)\n</code></pre>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#en-resumen","level":2,"title":"En Resumen","text":"<p>DHCP = Sistema autom√°tico que evita tener que configurar manualmente cada dispositivo en la red, asignando y gestionando direcciones IP de forma din√°mica.</p> <p>Funciona como un \"alquiler de direcciones\" con renovaci√≥n autom√°tica.</p>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#que-es-dhcp-snooping","level":3,"title":"¬øQu√© es DHCP Snooping?","text":"<p>La funci√≥n exacta de DHCP Snooping es actuar como un guardi√°n de seguridad que previene ataques DHCP maliciosos mediante la creaci√≥n de una base de datos confiable de asignaciones IP-MAC, diferenciando entre puertos trusted (donde se conectan servidores DHCP leg√≠timos) y untrusted (clientes), bloqueando respuestas DHCP no autorizadas y proporcionando la base de datos que tecnolog√≠as como DAI e IP Source Guard utilizan para validar la legitimidad del tr√°fico ARP y las direcciones IP en la red.</p> <p>En esencia: DHCP Snooping es el sistema de verificaci√≥n de identidades que asegura que solo dispositivos autorizados puedan ofrecer direcciones IP y mantiene un registro confiable de qu√© dispositivo tiene qu√© IP en qu√© puerto. DHCP Snooping es la BASE, DAI es la CAPA DE SEGURIDAD que usa esa base</p>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#analogia-para-entenderlo_1","level":3,"title":"Analog√≠a para Entenderlo","text":"<p>Imagina un edificio con: - Servidores DHCP leg√≠timos = Oficinas de administraci√≥n autorizadas - Clientes DHCP = Inquilinos que necesitan llaves (IPs) - Ataque DHCP Rogue = Alguien fingiendo ser la administraci√≥n - DHCP Snooping = El sistema de seguridad que verifica credenciales</p> <p></p> <p></p>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#problemas-que-resuelve-dhcp-snooping","level":2,"title":"üîç Problemas que Resuelve DHCP Snooping","text":"","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#1-ataque-dhcp-starvation-inanicion","level":3,"title":"1. Ataque DHCP Starvation (Inanici√≥n)","text":"<pre><code># Un atacante env√≠a M√öLTIPLES solicitudes DHCP con MACs falsas\n# Resultado: Agota el pool de IPs del servidor leg√≠timo\n# Clientes leg√≠timos no pueden obtener IP\n</code></pre>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#2-ataque-dhcp-rogue-servidor-falso","level":3,"title":"2. Ataque DHCP Rogue (Servidor Falso)","text":"<pre><code># Atacante configura servidor DHCP no autorizado\n# Ofrece IPs con:\n# - Gateway falso (el atacante)\n# - DNS falso (para redirigir tr√°fico)\n# Resultado: Man-in-the-Middle completo\n</code></pre>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#3-ip-spoofing-suplantacion-de-ip","level":3,"title":"3. IP Spoofing (Suplantaci√≥n de IP)","text":"<pre><code># Clientes usan IPs que no les corresponden\n# Dif√≠cil de rastrear en la red\n# Puede eludir controles de seguridad basados en IP\n</code></pre>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#arquitectura-de-dhcp-snooping","level":2,"title":"üèóÔ∏è Arquitectura de DHCP Snooping","text":"","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#componentes-clave","level":3,"title":"Componentes Clave","text":"<ol> <li> <p>Puertos Trusted (Confiables)</p> <ul> <li>Donde est√°n los servidores DHCP leg√≠timos</li> <li>Aceptan mensajes DHCP de cualquier tipo</li> </ul> </li> <li> <p>Puertos Untrusted (No Confiables)</p> <ul> <li>Donde se conectan clientes</li> <li>Solo aceptan solicitudes DHCP (DISCOVER, REQUEST)</li> <li>Rechazan respuestas DHCP (OFFER, ACK)</li> </ul> </li> <li> <p>Binding Database (Base de Datos de Asignaciones)</p> <ul> <li>Almacena: MAC + IP + VLAN + Puerto + Tiempo de arrendamiento</li> <li>Se usa por DAI y IP Source Guard</li> </ul> </li> </ol>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#configuracion-detallada-paso-a-paso","level":2,"title":"‚öôÔ∏è Configuraci√≥n Detallada Paso a Paso","text":"","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#configuracion-basica","level":3,"title":"Configuraci√≥n B√°sica","text":"<pre><code>! PASO 1: HABILITAR DHCP SNOOPING GLOBALMENTE\nSwitch(config)# ip dhcp snooping\n! Este comando ACTIVA la funcionalidad a nivel global\n! Sin esto, nada de DHCP Snooping funcionar√°\n\n! PASO 2: ESPECIFICAR VLANs DONDE ACTUAR√Å\nSwitch(config)# ip dhcp snooping vlan 10,20,30\n! Solo las VLANs especificadas estar√°n protegidas\n! Puedes usar rangos: vlan 1-100\n\n! PASO 3: CONFIGURAR PUERTOS TRUSTED\nSwitch(config)# interface gigabitethernet 0/1\nSwitch(config-if)# description SERVIDOR_DHCP_LEGITIMO\nSwitch(config-if)# ip dhcp snooping trust\n! MARCA este puerto como confiable para respuestas DHCP\n! Los servidores DHCP leg√≠timos DEBEN estar en puertos trusted\n\n! PASO 4: PUERTOS UNTRUSTED (POR DEFECTO)\nSwitch(config)# interface range fastethernet 0/1-24\nSwitch(config-if-range)# no ip dhcp snooping trust\n! Expl√≠citamente los marca como no confiables\n! Aunque por defecto ya lo son, es buena pr√°ctica\n</code></pre>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#configuracion-avanzada","level":3,"title":"Configuraci√≥n Avanzada","text":"<pre><code>! OPCI√ìN 82 (AGENT INFORMATION OPTION)\nSwitch(config)# ip dhcp snooping information option\n! A√±ade informaci√≥n sobre el switch y puerto donde se origin√≥ la solicitud\n! Ayuda a los servidores DHCP a tomar decisiones basadas en ubicaci√≥n\n\n! LIMITAR TASA DE MENSAJES DHCP\nSwitch(config)# interface fastethernet 0/5\nSwitch(config-if)# ip dhcp snooping limit rate 10\n! Limita a 10 mensajes DHCP por segundo\n! Previene ataques de inundaci√≥n (DHCP starvation)\n\n! CONFIGURACI√ìN DE LA BASE DE DATOS\nSwitch(config)# ip dhcp snooping database flash:dhcp-snooping.txt\nSwitch(config)# ip dhcp snooping database write-delay 15\n! Guarda la base de datos en memoria flash cada 15 segundos\n! Previene p√©rdida de informaci√≥n en reinicios\n</code></pre>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#ejemplos-practicos-de-configuracion","level":2,"title":"üîß Ejemplos Pr√°cticos de Configuraci√≥n","text":"","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#ejemplo-1-pequena-oficina","level":3,"title":"Ejemplo 1: Peque√±a Oficina","text":"<pre><code>! ESCENARIO: 1 servidor DHCP, 24 puertos de usuario\nSwitch(config)# ip dhcp snooping\nSwitch(config)# ip dhcp snooping vlan 10\n\n! Servidor DHCP en puerto Gigabit 0/1\nSwitch(config)# interface gigabitethernet 0/1\nSwitch(config-if)# description SERVIDOR_DHCP\nSwitch(config-if)# ip dhcp snooping trust\n\n! Puertos de usuarios (untrusted por defecto)\nSwitch(config)# interface range fastethernet 0/1-24\nSwitch(config-if-range)# switchport mode access\nSwitch(config-if-range)# switchport access vlan 10\nSwitch(config-if-range)# ip dhcp snooping limit rate 5\n! Limita a 5 mensajes/segundo para prevenir ataques\n</code></pre>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#ejemplo-2-empresa-mediana-con-multiples-vlans","level":3,"title":"Ejemplo 2: Empresa Mediana con M√∫ltiples VLANs","text":"<pre><code>! ESCENARIO: M√∫ltiples departamentos, servidor centralizado\nSwitch(config)# ip dhcp snooping\nSwitch(config)# ip dhcp snooping vlan 10,20,30,99\nSwitch(config)# ip dhcp snooping information option\n\n! Uplink al core donde est√° el servidor DHCP\nSwitch(config)# interface gigabitethernet 0/1\nSwitch(config-if)# description UPLINK_TO_CORE\nSwitch(config-if)# switchport mode trunk\nSwitch(config-if)# ip dhcp snooping trust\n\n! VLAN de Ventas\nSwitch(config)# interface range fastethernet 0/1-8\nSwitch(config-if-range)# switchport access vlan 10\nSwitch(config-if-range)# ip dhcp snooping limit rate 8\n\n! VLAN de IT\nSwitch(config)# interface range fastethernet 0/9-16\nSwitch(config-if-range)# switchport access vlan 20\nSwitch(config-if-range)# ip dhcp snooping limit rate 8\n\n! VLAN de Administraci√≥n\nSwitch(config)# interface range fastethernet 0/17-24\nSwitch(config-if-range)# switchport access vlan 99\nSwitch(config-if-range)# ip dhcp snooping limit rate 8\n</code></pre>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#ejemplo-3-entorno-de-alta-seguridad","level":3,"title":"Ejemplo 3: Entorno de Alta Seguridad","text":"<pre><code>! ESCENARIO: Entorno cr√≠tico con verificaci√≥n estricta\nSwitch(config)# ip dhcp snooping\nSwitch(config)# ip dhcp snooping vlan 1-100\nSwitch(config)# ip dhcp snooping information option\nSwitch(config)# ip dhcp snooping verify mac-address\n! VERIFICA que la MAC origen en DHCP sea la real del cliente\n! Previene suplantaci√≥n de MAC en mensajes DHCP\n\n! Base de datos persistente\nSwitch(config)# ip dhcp snooping database flash:dhcp-snooping.db\nSwitch(config)# ip dhcp snooping database timeout 10\nSwitch(config)# ip dhcp snooping database write-delay 10\n\n! Puertos trusted expl√≠citos\nSwitch(config)# interface range gigabitethernet 0/1-2\nSwitch(config-if-range)# description SERVERS_DHCP_TRUSTED\nSwitch(config-if-range)# ip dhcp snooping trust\n\n! Todos los dem√°s puertos son untrusted con rate limiting estricto\nSwitch(config)# interface range fastethernet 0/1-48\nSwitch(config-if-range)# no ip dhcp snooping trust\nSwitch(config-if-range)# ip dhcp snooping limit rate 5\n! Solo 5 mensajes DHCP por segundo - muy restrictivo\n</code></pre>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#integracion-con-otras-tecnologias-de-seguridad","level":2,"title":"üõ†Ô∏è Integraci√≥n con Otras Tecnolog√≠as de Seguridad","text":"","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#con-dynamic-arp-inspection-dai","level":3,"title":"Con Dynamic ARP Inspection (DAI)","text":"<pre><code>! DHCP Snooping es PRERREQUISITO para DAI\nSwitch(config)# ip dhcp snooping\nSwitch(config)# ip dhcp snooping vlan 10\n\n! DAI usa la tabla de bindings de DHCP Snooping\nSwitch(config)# ip arp inspection vlan 10\nSwitch(config)# ip arp inspection validate src-mac dst-mac ip\n! DAI verifica que las respuestas ARP coincidan con la tabla de DHCP Snooping\n</code></pre>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#con-ip-source-guard","level":3,"title":"Con IP Source Guard","text":"<pre><code>! IP Source Guard tambi√©n depende de DHCP Snooping\nSwitch(config)# ip dhcp snooping\nSwitch(config)# ip dhcp snooping vlan 10\n\nSwitch(config)# interface fastethernet 0/1\nSwitch(config-if)# ip verify source\n! Solo permite tr√°fico de IPs que est√°n en la tabla de DHCP Snooping\n</code></pre>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#comandos-de-verificacion-y-monitoreo","level":2,"title":"üìä Comandos de Verificaci√≥n y Monitoreo","text":"","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#verificacion-basica","level":3,"title":"Verificaci√≥n B√°sica","text":"<pre><code>! VER ESTADO GLOBAL DE DHCP SNOOPING\nSwitch# show ip dhcp snooping\nSwitch DHCP snooping is enabled\nDHCP snooping is configured on following VLANs:\n10,20,30\nDHCP snooping is operational on following VLANs:\n10,20,30\nDHCP snooping is configured on the following L3 Interfaces:\n\nInsertion of option 82 is enabled\n   circuit-id default format: vlan-mod-port\n   remote-id: 0050.5689.ABCD (MAC del switch)\nOption 82 on untrusted port is not allowed\nVerification of hwaddr field is enabled\n\n! MOSTRAR LA TABLA DE BINDINGS\nSwitch# show ip dhcp snooping binding\nMacAddress          IpAddress        Lease(sec)  Type           VLAN  Interface\n------------------  ---------------  ----------  -------------  ----  --------------------\n00:50:56:89:AB:CD   192.168.10.10    86400       dhcp-snooping   10    FastEthernet0/1\n00:50:56:89:AB:CE   192.168.10.11    86320       dhcp-snooping   10    FastEthernet0/2\n00:50:56:89:AB:CF   192.168.20.15    86200       dhcp-snooping   20    FastEthernet0/9\n\n! VER ESTADO DE PUERTOS TRUSTED\nSwitch# show ip dhcp snooping trust\nTrusted | Port | \n------- | ---- | \nyes     | Gi0/1 | \nno      | Fa0/1 | \nno      | Fa0/2 | \n...     | ...  |\n</code></pre>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#estadisticas-y-troubleshooting","level":3,"title":"Estad√≠sticas y Troubleshooting","text":"<pre><code>! ESTAD√çSTICAS DETALLADAS POR INTERFAZ\nSwitch# show ip dhcp snooping interface fastethernet 0/1\nDHCP Snooping is enabled on this interface\nDHCP Snooping trust is disabled\nDHCP Snooping limit rate is 5 packets per second\nDHCP Snooping violation count is 0\n\n! CONTADORES DE MENSAJES DHCP\nSwitch# show ip dhcp snooping statistics\nDHCP Snooping Statistics:\n  Packets Dropped:\n    DHCP Discover: 0\n    DHCP Offer: 15\n    DHCP Request: 0\n    DHCP Ack: 12\n    Others: 3\n  Total Packets Dropped: 30\n\n! VERIFICAR LA BASE DE DATOS\nSwitch# show ip dhcp snooping database\nAgent URL : flash:dhcp-snooping.db\nWrite delay : 15 seconds\nAbort delay : 300 seconds\nAgent running : No\nDelay timer : not running\nReconfigure timer : not running\nLast succeeded : Never\nLast failed : Never\n</code></pre>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#comandos-de-depuracion-debug","level":3,"title":"Comandos de Depuraci√≥n (Debug)","text":"<pre><code>! SOLO USAR EN TROUBLESHOOTING - PUEDE GENERAR MUCHO OUTPUT\nSwitch# debug ip dhcp snooping events\nDHCP_SNOOPING: received new DHCP packet from interface FastEthernet0/1\nDHCP_SNOOPING: process new DHCP packet, message type: DHCPDISCOVER\nDHCP_SNOOPING: packet passed validation check\n\nSwitch# debug ip dhcp snooping packet\nDHCP_SNOOPING: received packet on FastEthernet0/1: \n  OP: 1, HTYPE: 1, HLEN: 6, HOPS: 0\n  XID: 0x45A3F1C2, SECS: 0, FLAGS: 0\n  CIADDR: 0.0.0.0, YIADDR: 0.0.0.0, SIADDR: 0.0.0.0, GIADDR: 0.0.0.0\n  CHADDR: 0050.5689.ABCD\n</code></pre>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#flujo-de-trabajo-completo-de-dhcp-snooping","level":2,"title":"üîÑ Flujo de Trabajo Completo de DHCP Snooping","text":"","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#proceso-paso-a-paso","level":3,"title":"Proceso Paso a Paso","text":"<ol> <li> <p>Inicializaci√≥n: <pre><code>Switch arranca ‚Üí DHCP Snooping deshabilitado por defecto\nAdministrador ejecuta: ip dhcp snooping\nSe crea tabla de bindings vac√≠a\n</code></pre></p> </li> <li> <p>Aprendizaje: <pre><code>Cliente conecta en Fa0/1 (untrusted)\nEnv√≠a DHCP DISCOVER ‚Üí Switch permite (solicitud)\nServidor leg√≠timo en Gi0/1 (trusted) env√≠a DHCP OFFER ‚Üí Switch permite (trusted)\nCliente env√≠a DHCP REQUEST ‚Üí Switch permite\nServidor env√≠a DHCP ACK ‚Üí Switch permite (trusted)\nSwitch a√±ade binding a la tabla: MAC + IP + VLAN + Puerto\n</code></pre></p> </li> <li> <p>Protecci√≥n: <pre><code>Atacante conecta servidor rogue en Fa0/10 (untrusted)\nEnv√≠a DHCP OFFER no solicitado ‚Üí Switch BLOQUEA y registra violaci√≥n\nCliente leg√≠timo solo ve ofertas del servidor autorizado\n</code></pre></p> </li> <li> <p>Mantenimiento: <pre><code>Switch monitorea renewals y expiraciones\nActualiza tabla de bindings autom√°ticamente\nGuarda base de datos peri√≥dicamente en memoria no vol√°til\n</code></pre></p> </li> </ol>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#mejores-practicas-y-recomendaciones","level":2,"title":"üí° Mejores Pr√°cticas y Recomendaciones","text":"","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#configuracion-recomendada","level":3,"title":"Configuraci√≥n Recomendada","text":"<pre><code>! CONFIGURACI√ìN √ìPTIMA PARA ENTORNOS CORPORATIVOS\nSwitch(config)# ip dhcp snooping\nSwitch(config)# ip dhcp snooping vlan [TODAS_LAS_VLANs_CON_CLIENTES]\nSwitch(config)# ip dhcp snooping information option\nSwitch(config)# ip dhcp snooping verify mac-address\nSwitch(config)# ip dhcp snooping database flash:dhcp-snooping.db\nSwitch(config)# ip dhcp snooping database write-delay 15\n\n! PUERTOS TRUSTED - SOLO DONDE HAY SERVIDORES DHCP LEG√çTIMOS\nSwitch(config)# interface [PUERTOS_A_SERVIDORES_DHCP]\nSwitch(config-if)# ip dhcp snooping trust\n\n! PUERTOS UNTRUSTED - TODOS LOS DEM√ÅS\nSwitch(config)# interface range [TODOS_LOS_PUERTOS_DE_CLIENTES]\nSwitch(config-if-range)# no ip dhcp snooping trust\nSwitch(config-if-range)# ip dhcp snooping limit rate 10\n</code></pre>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#consideraciones-importantes","level":3,"title":"Consideraciones Importantes","text":"<ol> <li> <p>Planificaci√≥n:</p> <ul> <li>Implementar en ventana de mantenimiento</li> <li>Comenzar en VLANs de prueba</li> <li>Tener rollback plan</li> </ul> </li> <li> <p>Rendimiento:</p> <ul> <li>Rate limiting muy bajo puede afectar clientes leg√≠timos</li> <li>Base de datos grande puede consumir memoria</li> </ul> </li> <li> <p>Compatibilidad:</p> <ul> <li>Verificar que dispositivos legados funcionen</li> <li>Algunos dispositivos IoT pueden tener comportamientos DHCP extra√±os</li> </ul> </li> <li> <p>Monitoreo:</p> <ul> <li>Configurar SNMP traps para violaciones</li> <li>Monitorear contadores de paquetes descartados</li> <li>Revisar logs regularmente</li> </ul> </li> </ol>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#resumen-final","level":2,"title":"üéØ Resumen Final","text":"<p>DHCP Snooping es la base fundamental para:</p> <ul> <li>‚úÖ Prevenir servidores DHCP no autorizados</li> <li>‚úÖ Construir la tabla de bindings para DAI e IP Source Guard</li> <li>‚úÖ Detectar y prevenir ataques de inundaci√≥n DHCP</li> <li>‚úÖ Mejorar la trazabilidad de dispositivos en la red</li> </ul> <p>Sin DHCP Snooping, las dem√°s tecnolog√≠as de seguridad (DAI, IP Source Guard) no pueden funcionar correctamente.</p>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#3-dynamic-arp-inspection-dai","level":2,"title":"üõ°Ô∏è 3. Dynamic ARP Inspection (DAI)","text":"","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#concepto-teorico-detallado_2","level":3,"title":"Concepto Te√≥rico Detallado","text":"<p>¬øQu√© es DAI? Es un mecanismo de seguridad que previene ataques ARP spoofing validando paquetes ARP en la red.</p> <p>Problema del ARP:</p> <ul> <li>ARP no tiene autenticaci√≥n ‚Üí Cualquiera puede enviar respuestas ARP</li> <li>ARP poisoning: Atacante se hace pasar por el gateway</li> <li>Man-in-the-middle: Intercepta tr√°fico entre v√≠ctima y gateway</li> </ul> <p>C√≥mo funciona DAI:</p> <ol> <li>Intercepta todos los paquetes ARP</li> <li>Valida contra base de datos confiable (DHCP Snooping)</li> <li>Descarta paquetes ARP no v√°lidos</li> <li>Registra intentos de violaci√≥n</li> </ol> <p>DAI utiliza la tabla de DHCP Snooping EXCLUSIVAMENTE cuando recibe un ARP Response (Respuesta ARP)</p>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#comandos-explicados-paso-a-paso_2","level":3,"title":"Comandos Explicados Paso a Paso","text":"<pre><code>! CONFIGURACI√ìN B√ÅSICA DE DAI\nSwitch(config)# ip arp inspection vlan 10,20\n! Habilita DAI para las VLANs especificadas\n! Sin este comando, DAI no est√° activo en ninguna VLAN\n\n! DEFINIR PUERTOS TRUSTED (CONFIABLES)\nSwitch(config)# interface gigabitethernet 0/1\nSwitch(config-if)# ip arp inspection trust\n! Los puertos 'trusted' NO son inspeccionados por DAI\n! USAR SOLO en: routers, servidores, switches superiores\n! NUNCA en puertos de usuarios finales\n\n! VALIDACIONES ESPEC√çFICAS\nSwitch(config)# ip arp inspection validate src-mac dst-mac ip\n! 'src-mac' - Verifica que MAC origen en ARP = MAC origen en Ethernet\n! 'dst-mac' - Verifica que MAC destino en ARP = MAC destino en Ethernet  \n! 'ip' - Verifica direcciones IP v√°lidas (no 0.0.0.0, 255.255.255.255, etc.)\n\n! RATE LIMITING - CR√çTICO PARA PREVENIR DOS\nSwitch(config)# interface fastethernet 0/5\nSwitch(config-if)# ip arp inspection limit rate 15\n! Limita a 15 paquetes ARP por segundo\n! Paquetes excedentes son descartados\n! Previene flood de ARP que podr√≠a saturar la CPU\n</code></pre>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#configuracion-integrada-con-dhcp-snooping","level":3,"title":"Configuraci√≥n Integrada con DHCP Snooping","text":"<pre><code>! PRIMERO: Configurar DHCP Snooping (requisito para DAI)\nSwitch(config)# ip dhcp snooping\n! Habilita la funcionalidad global de DHCP Snooping\n\nSwitch(config)# ip dhcp snooping vlan 10,20\n! Especifica en qu√© VLANs actuar√° DHCP Snooping\n\nSwitch(config)# interface gigabitethernet 0/1\nSwitch(config-if)# ip dhcp snooping trust\n! Puertos trusted para DHCP (hacia servidores DHCP leg√≠timos)\n\n! SEGUNDO: Configurar DAI que usa la tabla de DHCP Snooping\nSwitch(config)# ip arp inspection vlan 10,20\n! DAI usar√° la tabla de bindings de DHCP Snooping para validar\n\nSwitch(config)# ip arp inspection log-buffer entries 1024\n! Buffer para almacenar logs de violaciones ARP\n\nSwitch(config)# ip arp inspection log-buffer logs 10 interval 60\n! Genera logs cada 60 segundos si hay m√°s de 10 violaciones\n\n! CONFIGURACI√ìN POR PUERTO DE USUARIO\nSwitch(config)# interface range fastethernet 0/1-24\nSwitch(config-if-range)# switchport mode access\nSwitch(config-if-range)# ip arp inspection limit rate 10\n! Todos los puertos de usuario tienen rate limiting\n! Por defecto son untrusted (inspeccionados)\n</code></pre>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#ejemplo-practico-completo_2","level":3,"title":"Ejemplo Pr√°ctico Completo","text":"<pre><code>! ESCENARIO: Red corporativa con m√∫ltiples VLANs\n\n! 1. Configurar DHCP Snooping\nSwitch(config)# ip dhcp snooping\nSwitch(config)# ip dhcp snooping vlan 10,20,30\nSwitch(config)# ip dhcp snooping information option\n! 'information option' a√±ade informaci√≥n adicional (option 82)\n\n! 2. Definir puertos trusted\nSwitch(config)# interface gigabitethernet 0/1\nSwitch(config-if)# description UPLINK_TO_CORE_SWITCH\nSwitch(config-if)# ip dhcp snooping trust\nSwitch(config-if)# ip arp inspection trust\n\nSwitch(config)# interface gigabitethernet 0/2  \nSwitch(config-if)# description LINK_TO_DHCP_SERVER\nSwitch(config-if)# ip dhcp snooping trust\nSwitch(config-if)# ip arp inspection trust\n\n! 3. Configurar DAI\nSwitch(config)# ip arp inspection vlan 10,20,30\nSwitch(config)# ip arp inspection validate src-mac dst-mac ip\nSwitch(config)# ip arp inspection log-buffer entries 2048\n\n! 4. Configurar puertos de usuario\nSwitch(config)# interface range fastethernet 0/1-48\nSwitch(config-if-range)# switchport mode access\nSwitch(config-if-range)# ip arp inspection limit rate 15\nSwitch(config-if-range)# no ip dhcp snooping trust\n! Expl√≠citamente configurados como untrusted\n\n! VERIFICACI√ìN\nSwitch# show ip arp inspection\n! Muestra configuraci√≥n global de DAI\n\nSwitch# show ip arp inspection statistics\n! Muestra contadores de paquetes procesados y descartados\n\nSwitch# show ip dhcp snooping binding\n! Muestra la tabla de bindings IP-MAC-puerto\n! ESTA TABLA ES LA QUE USA DAI PARA VALIDAR\n\nSwitch# show ip arp inspection interface fastethernet 0/10\n! Muestra estad√≠sticas espec√≠ficas por puerto\n</code></pre>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#4-bpdu-guard-bpdu-filter","level":2,"title":"üåâ 4. BPDU Guard &amp; BPDU Filter","text":"","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#concepto-teorico-detallado_3","level":3,"title":"Concepto Te√≥rico Detallado","text":"<p>¬øQu√© son las BPDUs? BPDU (Bridge Protocol Data Units) son mensajes que intercambian los switches para construir y mantener el spanning-tree.</p> <p>Problemas que resuelven:</p> <ul> <li>Switches no autorizados: Usuario conecta un switch casero</li> <li>Bucles de red: Configuraciones incorrectas crean loops</li> <li>Interrupciones de servicio: Topolog√≠a STP cambia inesperadamente</li> </ul>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#bpdu-guard-explicacion-detallada","level":3,"title":"BPDU Guard - Explicaci√≥n Detallada","text":"<p>Prop√≥sito: Proteger puertos de acceso contra recepci√≥n de BPDUs</p> <p>Comportamiento: - Si recibe BPDU ‚Üí err-disable inmediato - Ideal para puertos con usuarios finales - Se activa solo en puertos con PortFast</p>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#comandos-bpdu-guard","level":3,"title":"Comandos BPDU Guard","text":"<pre><code>! M√âTODO 1: Global (recomendado para consistencia)\nSwitch(config)# spanning-tree portfast bpduguard default\n! Aplica BPDU Guard autom√°ticamente a TODOS los puertos con PortFast\n! M√âTODO M√ÅS EFICIENTE para despliegues grandes\n\n! M√âTODO 2: Por interfaz\nSwitch(config)# interface fastethernet 0/1\nSwitch(config-if)# spanning-tree portfast\n! PortFast salta estados temporales (listening/learning)\nSwitch(config-if)# spanning-tree bpduguard enable\n! Habilita BPDU Guard espec√≠ficamente en este puerto\n\n! RECUPERACI√ìN AUTOM√ÅTICA\nSwitch(config)# errdisable recovery cause bpduguard\nSwitch(config)# errdisable recovery interval 300\n! Reactiva puertos autom√°ticamente despu√©s de 5 minutos\n</code></pre>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#bpdu-filter-explicacion-detallada","level":3,"title":"BPDU Filter - Explicaci√≥n Detallada","text":"<p>Prop√≥sito: Silenciar BPDUs en puertos espec√≠ficos</p> <p>Comportamiento:</p> <ul> <li>Bloquea env√≠o y recepci√≥n de BPDUs</li> <li>Peligroso: Puede crear bucles si no se usa correctamente</li> <li>Caso de uso: Conectar dispositivos que env√≠an BPDUs pero no deben participar en STP</li> </ul>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#comandos-bpdu-filter","level":3,"title":"Comandos BPDU Filter","text":"<pre><code>! M√âTODO 1: Global\nSwitch(config)# spanning-tree portfast bpdufilter default\n! Aplica BPDU Filter a todos los puertos con PortFast\n! CUIDADO: Puede causar bucles si se conecta un switch\n\n! M√âTODO 2: Por interfaz\nSwitch(config)# interface fastethernet 0/2\nSwitch(config-if)# spanning-tree bpdufilter enable\n! Habilita BPDU Filter espec√≠ficamente en este puerto\n</code></pre>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#ejemplo-practico-cuando-usar-cada-uno","level":3,"title":"Ejemplo Pr√°ctico: Cu√°ndo Usar Cada Uno","text":"<pre><code>! ESCENARIO: Oficina con diferentes tipos de puertos\n\n! 1. Puertos de usuario normal - USAR BPDU GUARD\nSwitch(config)# interface range fastethernet 0/1-20\nSwitch(config-if-range)# switchport mode access\nSwitch(config-if-range)# spanning-tree portfast\nSwitch(config-if-range)# spanning-tree bpduguard enable\nSwitch(config-if-range)# description USUARIOS_FINALES\n! Si alguien conecta un switch, el puerto se desactiva\n\n! 2. Servidor que env√≠a BPDUs - USAR BPDU FILTER\nSwitch(config)# interface fastethernet 0/21\nSwitch(config-if)# switchport mode access  \nSwitch(config-if)# spanning-tree bpdufilter enable\nSwitch(config-if)# description SERVIDOR_VMWARE\n! El servidor puede enviar BPDUs pero no queremos que participe en STP\n\n! 3. Configuraci√≥n global de seguridad\nSwitch(config)# spanning-tree portfast bpduguard default\n! Para todos los nuevos puertos con PortFast\n\nSwitch(config)# errdisable recovery cause bpduguard\nSwitch(config)# errdisable recovery interval 600\n! Recuperaci√≥n autom√°tica despu√©s de 10 minutos\n\n! VERIFICACI√ìN\nSwitch# show spanning-tree summary\n! Muestra estado global de spanning-tree incluyendo BPDU Guard/Filter\n\nSwitch# show spanning-tree interface fastethernet 0/1 detail\n! Muestra configuraci√≥n espec√≠fica de BPDU Guard/Filter por puerto\n\nSwitch# show errdisable recovery\n! Muestra configuraci√≥n de recuperaci√≥n autom√°tica\n</code></pre>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#5-ip-source-guard","level":2,"title":"üîç 5. IP Source Guard","text":"","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#concepto-teorico-detallado_4","level":3,"title":"Concepto Te√≥rico Detallado","text":"<p>¬øQu√© es IP Source Guard? Es un mecanismo que filtra tr√°fico IP bas√°ndose en la tabla de bindings de DHCP Snooping.</p> <p>Problemas que resuelve:</p> <ul> <li>IP spoofing: Usuario usa IP que no le pertenece</li> <li>Ataques DoS: Dispositivos maliciosos suplantando IPs</li> <li>Robo de servicios: Usar IPs de otros departamentos</li> </ul> <p>C√≥mo funciona:</p> <ol> <li>Aprende bindings IP-MAC de DHCP Snooping</li> <li>Instala filtros en hardware del switch</li> <li>Permite solo tr√°fico de IPs autorizadas</li> <li>Actualiza din√°micamente cuando expiran leases DHCP</li> </ol>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#comandos-explicados-paso-a-paso_3","level":3,"title":"Comandos Explicados Paso a Paso","text":"<pre><code>! PRERREQUISITO: DHCP Snooping debe estar configurado\nSwitch(config)# ip dhcp snooping\nSwitch(config)# ip dhcp snooping vlan 10\n\n! CONFIGURACI√ìN B√ÅSICA DE IP SOURCE GUARD\nSwitch(config)# interface fastethernet 0/1\nSwitch(config-if)# ip verify source\n! Habilita verificaci√≥n de direcci√≥n IP origen\n! Solo permite tr√°fico de IPs que est√°n en la tabla de DHCP Snooping\n\n! CONFIGURACI√ìN AVANZADA CON VERIFICACI√ìN MAC\nSwitch(config-if)# ip verify source port-security\n! 'port-security' a√±ade verificaci√≥n de direcci√≥n MAC tambi√©n\n! M√°s seguro pero requiere que Port Security est√© configurado\n\nSwitch(config-if)# ip verify source vlan dhcp-snooping port-security\n! Verificaci√≥n completa: IP + MAC + VLAN\n! M√ÅXIMA SEGURIDAD pero m√°s complejo de implementar\n</code></pre>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#ejemplo-practico-completo_3","level":3,"title":"Ejemplo Pr√°ctico Completo","text":"<pre><code>! ESCENARIO: Red segura con validaci√≥n m√∫ltiple\n\n! 1. CONFIGURAR DHCP SNOOPING (BASE PARA TODO)\nSwitch(config)# ip dhcp snooping\nSwitch(config)# ip dhcp snooping vlan 10,20\nSwitch(config)# ip dhcp snooping information option\n\n! Definir puertos trusted\nSwitch(config)# interface gigabitethernet 0/1\nSwitch(config-if)# ip dhcp snooping trust\nSwitch(config-if)# description TO_DHCP_SERVER\n\n! 2. CONFIGURAR PORT SECURITY\nSwitch(config)# interface range fastethernet 0/1-24\nSwitch(config-if-range)# switchport mode access\nSwitch(config-if-range)# switchport port-security\nSwitch(config-if-range)# switchport port-security maximum 2\nSwitch(config-if-range)# switchport port-security violation restrict\nSwitch(config-if-range)# switchport port-security mac-address sticky\n\n! 3. CONFIGURAR IP SOURCE GUARD\nSwitch(config)# interface range fastethernet 0/1-24\nSwitch(config-if-range)# ip verify source port-security\n! Verifica tanto IP como direcci√≥n MAC\n! Solo permite tr√°fico de dispositivos con binding v√°lido\n\n! 4. CONFIGURACI√ìN ALTERNATIVA PARA DISPOSITIVOS EST√ÅTICOS\nSwitch(config)# interface fastethernet 0/25\nSwitch(config-if)# description SERVIDOR_ESTATICO\nSwitch(config-if)# switchport mode access\nSwitch(config-if)# switchport port-security\nSwitch(config-if)# switchport port-security mac-address 0050.5687.1234\nSwitch(config-if)# ip verify source\n! Para servidores con IP est√°tica, solo verificaci√≥n de IP\n\n! VERIFICACI√ìN COMPLETA\nSwitch# show ip verify source\n! Muestra tabla de bindings activos y estado de verificaci√≥n\n\nSwitch# show ip source binding\n! Muestra toda la tabla de bindings IP-MAC-VLAN\n\nSwitch# show ip dhcp snooping binding\n! Muestra bindings aprendidos via DHCP\n\nSwitch# show port-security address\n! Muestra direcciones MAC seguras\n\n! MONITOREO EN TIEMPO REAL\nSwitch# debug ip dhcp snooping events\n! Para troubleshooting detallado (usar con cuidado en producci√≥n)\n</code></pre>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#configuracion-integrada-completa","level":2,"title":"üèóÔ∏è CONFIGURACI√ìN INTEGRADA COMPLETA","text":"","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#switch-de-acceso-corporativo-seguro","level":3,"title":"Switch de Acceso Corporativo Seguro","text":"<pre><code>! INICIALIZACI√ìN B√ÅSICA\nSwitch&gt; enable\nSwitch# configure terminal\nSwitch(config)# hostname SW-ACCESO-01\n\n! CONFIGURACI√ìN DE VLANs\nSW-ACCESO-01(config)# vlan 10\nSW-ACCESO-01(config-vlan)# name USUARIOS\nSW-ACCESO-01(config-vlan)# vlan 20\nSW-ACCESO-01(config-vlan)# name SERVIDORES\nSW-ACCESO-01(config-vlan)# vlan 99\nSW-ACCESO-01(config-vlan)# name ADMIN\nSW-ACCESO-01(config-vlan)# vlan 999\nSW-ACCESO-01(config-vlan)# name NATIVA\nSW-ACCESO-01(config-vlan)# exit\n\n! CONFIGURACI√ìN DE ADMINISTRACI√ìN\nSW-ACCESO-01(config)# interface vlan 99\nSW-ACCESO-01(config-if)# ip address 192.168.99.10 255.255.255.0\nSW-ACCESO-01(config-if)# no shutdown\nSW-ACCESO-01(config-if)# exit\n\n! CONFIGURACI√ìN DE PUERTOS UPLINK (TRUSTED)\nSW-ACCESO-01(config)# interface gigabitethernet 0/1\nSW-ACCESO-01(config-if)# description UPLINK_TO_CORE_SWITCH\nSW-ACCESO-01(config-if)# switchport mode trunk\nSW-ACCESO-01(config-if)# switchport trunk native vlan 999\nSW-ACCESO-01(config-if)# switchport trunk allowed vlan 10,20,99\nSW-ACCESO-01(config-if)# ip dhcp snooping trust\nSW-ACCESO-01(config-if)# ip arp inspection trust\nSW-ACCESO-01(config-if)# spanning-tree guard root\nSW-ACCESO-01(config-if)# no shutdown\n\n! CONFIGURACI√ìN DE PUERTOS DE USUARIO (UNTRUSTED)\nSW-ACCESO-01(config)# interface range fastethernet 0/1-24\nSW-ACCESO-01(config-if-range)# description PUERTOS_USUARIOS\nSW-ACCESO-01(config-if-range)# switchport mode access\nSW-ACCESO-01(config-if-range)# switchport access vlan 10\nSW-ACCESO-01(config-if-range)# switchport port-security\nSW-ACCESO-01(config-if-range)# switchport port-security maximum 3\nSW-ACCESO-01(config-if-range)# switchport port-security violation shutdown\nSW-ACCESO-01(config-if-range)# switchport port-security mac-address sticky\nSW-ACCESO-01(config-if-range)# switchport port-security aging time 120\nSW-ACCESO-01(config-if-range)# spanning-tree portfast\nSW-ACCESO-01(config-if-range)# spanning-tree bpduguard enable\nSW-ACCESO-01(config-if-range)# ip verify source port-security\nSW-ACCESO-01(config-if-range)# ip arp inspection limit rate 15\nSW-ACCESO-01(config-if-range)# no ip dhcp snooping trust\nSW-ACCESO-01(config-if-range)# no shutdown\n\n! CONFIGURACI√ìN DE PUERTOS DE SERVIDORES\nSW-ACCESO-01(config)# interface range gigabitethernet 0/2-4\nSW-ACCESO-01(config-if-range)# description SERVIDORES\nSW-ACCESO-01(config-if-range)# switchport mode access\nSW-ACCESO-01(config-if-range)# switchport access vlan 20\nSW-ACCESO-01(config-if-range)# switchport port-security\nSW-ACCESO-01(config-if-range)# switchport port-security maximum 1\nSW-ACCESO-01(config-if-range)# switchport port-security violation shutdown\nSW-ACCESO-01(config-if-range)# spanning-tree portfast\nSW-ACCESO-01(config-if-range)# spanning-tree bpduguard enable\nSW-ACCESO-01(config-if-range)# ip verify source\nSW-ACCESO-01(config-if-range)# no shutdown\n\n! CONFIGURACIONES GLOBALES DE SEGURIDAD\nSW-ACCESO-01(config)# ip dhcp snooping\nSW-ACCESO-01(config)# ip dhcp snooping vlan 10,20\nSW-ACCESO-01(config)# ip dhcp snooping information option\n\nSW-ACCESO-01(config)# ip arp inspection vlan 10,20\nSW-ACCESO-01(config)# ip arp inspection validate src-mac dst-mac ip\nSW-ACCESO-01(config)# ip arp inspection log-buffer entries 1024\n\nSW-ACCESO-01(config)# spanning-tree portfast bpduguard default\nSW-ACCESO-01(config)# spanning-tree portfast bpdufilter default\n\n! RECUPERACI√ìN AUTOM√ÅTICA\nSW-ACCESO-01(config)# errdisable recovery cause all\nSW-ACCESO-01(config)# errdisable recovery interval 600\n\n! GUARDAR CONFIGURACI√ìN\nSW-ACCESO-01(config)# end\nSW-ACCESO-01# copy running-config startup-config\n</code></pre>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#comandos-de-verificacion-y-monitoreo_1","level":3,"title":"Comandos de Verificaci√≥n y Monitoreo","text":"<pre><code>! VERIFICACI√ìN COMPLETA DEL ESTADO\nSW-ACCESO-01# show running-config\nSW-ACCESO-01# show vlan brief\nSW-ACCESO-01# show interfaces status\n\n! VERIFICACI√ìN DE SEGURIDAD\nSW-ACCESO-01# show port-security\nSW-ACCESO-01# show port-security address\nSW-ACCESO-01# show ip dhcp snooping\nSW-ACCESO-01# show ip arp inspection\nSW-ACCESO-01# show ip verify source\n\n! ESTAD√çSTICAS Y MONITOREO\nSW-ACCESO-01# show interface counters errors\nSW-ACCESO-01# show errdisable recovery\nSW-ACCESO-01# show logging\n\n! TROUBLESHOOTING ESPEC√çFICO\nSW-ACCESO-01# show mac address-table interface fastethernet 0/1\nSW-ACCESO-01# show ip dhcp snooping binding\nSW-ACCESO-01# show spanning-tree interface fastethernet 0/1 detail\n</code></pre>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#resumen-final-de-mejores-practicas","level":2,"title":"üéØ RESUMEN FINAL DE MEJORES PR√ÅCTICAS","text":"","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#recomendaciones-por-tecnologia","level":3,"title":"Recomendaciones por Tecnolog√≠a:","text":"<ol> <li> <p>VLANs:</p> <ul> <li>Nunca usar VLAN 1 para tr√°fico de usuario</li> <li>VLAN nativa diferente para cada trunk</li> <li>Segmentar por funci√≥n, no solo por ubicaci√≥n</li> </ul> </li> <li> <p>Port Security:</p> <ul> <li>Usar \"violation shutdown\" en entornos seguros</li> <li>\"sticky\" para despliegues iniciales</li> <li>Rate limiting en puertos de alta densidad</li> </ul> </li> <li> <p>DAI:</p> <ul> <li>Siempre con DHCP Snooping primero</li> <li>Rate limiting esencial para prevenir DoS</li> <li>Validaci√≥n completa (src-mac + dst-mac + ip)</li> </ul> </li> <li> <p>BPDU Guard:</p> <ul> <li>Global + PortFast para consistencia</li> <li>Recuperaci√≥n autom√°tica configurada</li> <li>Nunca en puertos trunk</li> </ul> </li> <li> <p>IP Source Guard:</p> <ul> <li>Requiere DHCP Snooping funcionando</li> <li>\"port-security\" para m√°xima seguridad</li> <li>Monitorizar bindings regularmente</li> </ul> </li> </ol>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#flujo-de-implementacion-recomendado","level":3,"title":"Flujo de Implementaci√≥n Recomendado:","text":"<ol> <li>VLANs y segmentaci√≥n</li> <li>Port Security b√°sica</li> <li>DHCP Snooping</li> <li>DAI con validaciones</li> <li>BPDU Guard</li> <li>IP Source Guard</li> <li>Verificaci√≥n y ajuste</li> </ol>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#portfast","level":2,"title":"Portfast","text":"<p>PortFast es una funcionalidad de los switches Cisco que se configura en puertos de acceso que conectan estaciones de trabajo finales (como PCs, impresoras, servidores) y nunca otros switches o dispositivos de red. ¬øQu√© hace PortFast?</p> <pre><code>Objetivo principal: Acelerar el inicio de un puerto cuando se enciende un dispositivo conectado a √©l.\n\nFuncionamiento normal (sin PortFast): Cuando un puerto de switch se activa, el protocolo Spanning Tree (STP) pasa por una serie de estados antes de permitir el tr√°fico de datos:\nBloqueando ‚Üí Escuchando ‚Üí Aprendiendo ‚Üí Reenv√≠o\nEste proceso puede tomar unos 30 segundos.\n\nFuncionamiento con PortFast: El puerto se salta los estados de \"Escuchando\" y \"Aprendiendo\" y pasa inmediatamente al estado de \"Reenv√≠o\", permitiendo el tr√°fico casi al instante.\n</code></pre> <p>Analog√≠a R√°pida</p> <pre><code>Sin PortFast: Es como arrancar un coche en un d√≠a fr√≠o: dejar que el motor se caliente antes de poder circular.\n\nCon PortFast: Es como tener el coche ya caliente y listo para circular en cuanto giras la llave.\n</code></pre> <p>Puntos Clave y Advertencias</p> <pre><code>¬øD√≥nde se usa? Solo en puertos de acceso que conectan dispositivos finales.\n\n¬øQu√© evita? La espera de 30 segundos para que un usuario obtenga una direcci√≥n IP (DHCP) o pueda empezar a navegar.\n\n¬°ADVERTENCIA CRUCIAL! NUNCA actives PortFast en un puerto que conecte a otro switch, hub o router. Esto podr√≠a crear bucles de capa 2 en la red, ya que STP no tendr√≠a tiempo de detectarlos y bloquearlos.\n</code></pre> <p>Relaci√≥n con BPDU Guard</p> <p>PortFast suele ir de la mano con BPDU Guard. Si un usuario conecta por error un switch a un puerto con PortFast, BPDU Guard detectar√° el paquete BPDU (propio de STP) y desactivar√° el puerto inmediatamente, evitando as√≠ un posible bucle. Es el \"seguro de seguridad\" de PortFast.</p> <p>En resumen: PortFast es una optimizaci√≥n para puertos de usuarios finales que acelera el acceso a la red, salt√°ndose los lentos estados de STP.</p>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#configuracion-de-portfast","level":3,"title":"Configuraci√≥n de PortFast","text":"","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#1-por-interfaz-recomendado","level":4,"title":"1. Por interfaz (recomendado)","text":"<pre><code>Switch# configure terminal\nSwitch(config)# interface [tipo-n√∫mero]  # Ej: gigabitethernet 0/1\nSwitch(config-if)# spanning-tree portfast\n</code></pre> <p>Para habilitar BPDU Guard en la misma interfaz: <pre><code>Switch(config-if)# spanning-tree bpduguard enable\n</code></pre></p>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#2-de-forma-global-mas-rapido","level":4,"title":"2. De forma global (m√°s r√°pido)","text":"<p>Habilita PortFast en todas las interfaces que no son trunk y est√°n en estado connected: <pre><code>Switch# configure terminal\nSwitch(config)# spanning-tree portfast default\n</code></pre></p> <p>Para habilitar BPDU Guard de forma global: <pre><code>Switch(config)# spanning-tree portfast bpduguard default\n</code></pre></p>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#verificacion","level":3,"title":"Verificaci√≥n","text":"<p><pre><code>Switch# show spanning-tree interface [tipo-n√∫mero] detail\n</code></pre> Busca en la salida: - <code>Portfast enabled</code> - <code>Bpdu guard enabled</code></p>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#comandos-importantes-para-aclarar-dudas","level":3,"title":"Comandos importantes para aclarar dudas","text":"<p>¬øLa interfaz es de acceso o trunk? <pre><code>Switch# show interfaces [tipo-n√∫mero] switchport\n</code></pre></p> <p>¬øSe han recibido BPDUs en el puerto? <pre><code>Switch# show spanning-tree interface [tipo-n√∫mero] detail\n</code></pre></p> <p>Si BPDU Guard desactiva un puerto: <pre><code>Switch# show interfaces status err-disabled\nSwitch# enable\nSwitch# configure terminal\nSwitch(config)# interface [tipo-n√∫mero]\nSwitch(config-if)# shutdown\nSwitch(config-if)# no shutdown\n</code></pre></p>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"SecSwitches/#recordatorio-importante","level":3,"title":"‚ö†Ô∏è Recordatorio importante","text":"<p>SOLO uses PortFast en puertos que conecten dispositivos finales (PCs, impresoras, servidores). NUNCA en puertos que conecten a otros switches, routers o puntos de acceso inal√°mbricos, ya que podr√≠as causar bucles en la red.</p> <p>La combinaci√≥n PortFast + BPDU Guard es la pr√°ctica m√°s segura y com√∫n.</p>","path":["Switch","Gu√≠a Completa de Seguridad en Switches Cisco"],"tags":[]},{"location":"cheatsheet_routers/","level":1,"title":"Cheatsheet routers","text":"","path":["Switch","Cheatsheet routers"],"tags":[]},{"location":"cheatsheet_routers/#cheatsheet-configuracion-basica-router-cisco","level":2,"title":"üöÄ Cheatsheet: Configuraci√≥n B√°sica Router Cisco","text":"","path":["Switch","Cheatsheet routers"],"tags":[]},{"location":"cheatsheet_routers/#1-modos-de-operacion","level":3,"title":"1. Modos de Operaci√≥n","text":"<pre><code>User EXEC Mode        &gt; \nPrivileged EXEC Mode  # enable\nGlobal Config Mode    # configure terminal\nInterface Config Mode (config-if)# interface &lt;tipo&gt; &lt;n√∫m&gt;\nLine Config Mode      (config-line)# line &lt;tipo&gt; &lt;n√∫m&gt;\n</code></pre>","path":["Switch","Cheatsheet routers"],"tags":[]},{"location":"cheatsheet_routers/#2-comandos-basicos-de-navegacion","level":3,"title":"2. Comandos B√°sicos de Navegaci√≥n","text":"<pre><code># Entrar a modo privilegiado\n&gt; enable\n\n# Entrar a configuraci√≥n global\n# configure terminal\n\n# Salir de un modo o guardar config\n(config)# exit\n(config)# end\n# write memory       # Guardar configuraci√≥n\n# copy running-config startup-config\n</code></pre>","path":["Switch","Cheatsheet routers"],"tags":[]},{"location":"cheatsheet_routers/#3-configuracion-de-passwords","level":3,"title":"3. Configuraci√≥n de Passwords","text":"","path":["Switch","Cheatsheet routers"],"tags":[]},{"location":"cheatsheet_routers/#password-para-modo-privilegiado-enable","level":4,"title":"Password para Modo Privilegiado (Enable)","text":"<pre><code>(config)# enable secret miPasswordSeguro\n</code></pre>","path":["Switch","Cheatsheet routers"],"tags":[]},{"location":"cheatsheet_routers/#password-para-consola","level":4,"title":"Password para Consola","text":"<pre><code>(config)# line console 0\n(config-line)# password consolePass\n(config-line)# login\n(config-line)# exit\n</code></pre>","path":["Switch","Cheatsheet routers"],"tags":[]},{"location":"cheatsheet_routers/#password-para-lineas-vty-telnetssh","level":4,"title":"Password para L√≠neas VTY (Telnet/SSH)","text":"<pre><code>(config)# line vty 0 4\n(config-line)# password vtyPass\n(config-line)# login\n(config-line)# exit\n</code></pre>","path":["Switch","Cheatsheet routers"],"tags":[]},{"location":"cheatsheet_routers/#4-cifrado-de-passwords","level":3,"title":"4. Cifrado de Passwords","text":"<pre><code># Cifrar todas las passwords en texto claro\n(config)# service password-encryption\n\n# Ver passwords cifradas\n# show running-config\n</code></pre>","path":["Switch","Cheatsheet routers"],"tags":[]},{"location":"cheatsheet_routers/#5-configuracion-de-banners","level":3,"title":"5. Configuraci√≥n de Banners","text":"<pre><code># Banner de aviso (MOTD)\n(config)# banner motd #\n ¬°Acceso Autorizado Solo a Personal Autorizado! \n#\n\n# Banner de login\n(config)# banner login #\n Bienvenido. Introduzca sus credenciales.\n#\n</code></pre>","path":["Switch","Cheatsheet routers"],"tags":[]},{"location":"cheatsheet_routers/#6-configuracion-de-interfaces","level":3,"title":"6. Configuraci√≥n de Interfaces","text":"","path":["Switch","Cheatsheet routers"],"tags":[]},{"location":"cheatsheet_routers/#interfaz-fastethernet","level":4,"title":"Interfaz FastEthernet","text":"<pre><code>(config)# interface fastethernet 0/0\n(config-if)# ip address 192.168.1.1 255.255.255.0\n(config-if)# no shutdown\n(config-if)# description LAN-Office\n(config-if)# exit\n</code></pre>","path":["Switch","Cheatsheet routers"],"tags":[]},{"location":"cheatsheet_routers/#interfaz-serial-wan","level":4,"title":"Interfaz Serial (WAN)","text":"<pre><code>(config)# interface serial 0/0/0\n(config-if)# ip address 10.0.0.1 255.255.255.252\n(config-if)# clock rate 64000    # Solo en lado DCE\n(config-if)# no shutdown\n(config-if)# exit\n</code></pre>","path":["Switch","Cheatsheet routers"],"tags":[]},{"location":"cheatsheet_routers/#7-configuracion-basica-de-seguridad","level":3,"title":"7. Configuraci√≥n B√°sica de Seguridad","text":"","path":["Switch","Cheatsheet routers"],"tags":[]},{"location":"cheatsheet_routers/#deshabilitar-dns-lookup","level":4,"title":"Deshabilitar DNS Lookup","text":"<pre><code>(config)# no ip domain-lookup\n</code></pre>","path":["Switch","Cheatsheet routers"],"tags":[]},{"location":"cheatsheet_routers/#configurar-nombre-de-host","level":4,"title":"Configurar Nombre de Host","text":"<pre><code>(config)# hostname R1-Madrid\n</code></pre>","path":["Switch","Cheatsheet routers"],"tags":[]},{"location":"cheatsheet_routers/#configurar-domain-name","level":4,"title":"Configurar Domain Name","text":"<pre><code>(config)# ip domain-name empresa.com\n</code></pre>","path":["Switch","Cheatsheet routers"],"tags":[]},{"location":"cheatsheet_routers/#8-configuracion-ssh-recomendado-sobre-telnet","level":3,"title":"8. Configuraci√≥n SSH (Recomendado sobre Telnet)","text":"<pre><code># Generar claves RSA\n(config)# crypto key generate rsa modulus 2048\n\n# Configurar SSH\n(config)# ip ssh version 2\n(config)# username admin secret admin123\n\n# Configurar l√≠neas VTY para SSH\n(config)# line vty 0 4\n(config-line)# transport input ssh\n(config-line)# login local\n(config-line)# exit\n</code></pre>","path":["Switch","Cheatsheet routers"],"tags":[]},{"location":"cheatsheet_routers/#9-comandos-de-verificacion-utiles","level":3,"title":"9. Comandos de Verificaci√≥n √ötiles","text":"<pre><code># Ver configuraci√≥n actual\n# show running-config\n\n# Ver interfaces y estado\n# show ip interface brief\n\n# Ver tabla de routing\n# show ip route\n\n# Ver resumen de interfaces\n# show interfaces description\n\n# Ver conexiones SSH\n# show ssh\n</code></pre>","path":["Switch","Cheatsheet routers"],"tags":[]},{"location":"cheatsheet_routers/#10-configuracion-basica-de-routing-estatico","level":3,"title":"10. Configuraci√≥n B√°sica de Routing Est√°tico","text":"<pre><code># Ruta est√°tica hacia red remota\n(config)# ip route 192.168.2.0 255.255.255.0 10.0.0.2\n\n# Ruta por defecto\n(config)# ip route 0.0.0.0 0.0.0.0 10.0.0.2\n</code></pre>","path":["Switch","Cheatsheet routers"],"tags":[]},{"location":"cheatsheet_routers/#11-comandos-de-administracion","level":3,"title":"11. Comandos de Administraci√≥n","text":"<pre><code># Guardar configuraci√≥n\n# copy running-config startup-config\n\n# Recargar router\n# reload\n\n# Ver versi√≥n del IOS\n# show version\n\n# Ver tiempo de actividad\n# show uptime\n</code></pre>","path":["Switch","Cheatsheet routers"],"tags":[]},{"location":"cheatsheet_routers/#ejemplo-de-configuracion-completa-basica","level":3,"title":"üåê Ejemplo de Configuraci√≥n Completa B√°sica","text":"<pre><code>enable\nconfigure terminal\n\n! Configuraci√≥n b√°sica\nhostname R1-Oficina\nno ip domain-lookup\nservice password-encryption\n\n! Passwords\nenable secret MiSecurePass123\nline console 0\n password console123\n login\n exit\n\nline vty 0 4\n password vty123\n login\n transport input ssh\n exit\n\n! Interfaces\ninterface fastethernet 0\n</code></pre>","path":["Switch","Cheatsheet routers"],"tags":[]},{"location":"dtp/","level":1,"title":"DTP (Dynamic Trunking Protocol)","text":"","path":["Switch","DTP (Dynamic Trunking Protocol)"],"tags":[]},{"location":"dtp/#que-es-dtp","level":2,"title":"¬øQu√© es DTP?","text":"<p>DTP (Dynamic Trunking Protocol) es un protocolo propietario de Cisco que negocia autom√°ticamente la formaci√≥n de enlaces trunk entre switches Cisco. Opera en la capa 2 del modelo OSI.</p>","path":["Switch","DTP (Dynamic Trunking Protocol)"],"tags":[]},{"location":"dtp/#proposito-principal","level":2,"title":"Prop√≥sito Principal","text":"<p>DTP elimina la necesidad de configurar manualmente los enlaces trunk, permitiendo que los switches negocien autom√°ticamente si un puerto debe operar como: - Access (puerto de acceso) - Trunk (puerto troncal)</p>","path":["Switch","DTP (Dynamic Trunking Protocol)"],"tags":[]},{"location":"dtp/#modos-de-operacion-dtp","level":2,"title":"Modos de Operaci√≥n DTP","text":"","path":["Switch","DTP (Dynamic Trunking Protocol)"],"tags":[]},{"location":"dtp/#1-dynamic-auto","level":3,"title":"1. Dynamic Auto","text":"<pre><code>Switch(config-if)# switchport mode dynamic auto\n</code></pre> <ul> <li> <p>Espera a que el otro dispositivo solicite formar trunk</p> </li> <li> <p>No env√≠a frames DTP, pero responde a ellos</p> </li> <li> <p>Resultado: Forma trunk solo si el otro lado es \"desirable\"</p> </li> </ul> <p>Escenarios t√≠picos:</p> <ul> <li> <p>Enlaces entre switches donde NO quieres ser el iniciador</p> </li> <li> <p>Entornos con pol√≠tica \"esperar a ser invitado\"</p> </li> <li> <p>Conexiones a dispositivos que pueden cambiar configuraci√≥n</p> </li> <li> <p>Cuando el otro lado debe decidir si forma trunk</p> </li> </ul> <p>Por qu√© usarlo:</p> <pre><code>‚úÖ Menos agresivo - No inicia trunks no deseados\n\n‚úÖ Seguridad moderada - Solo forma trunk si el otro lado lo pide\n\n‚úÖ Flexibilidad - Se adapta a la configuraci√≥n del peer\n\n‚úÖ Bajo overhead - No env√≠a DTP activamente\n</code></pre>","path":["Switch","DTP (Dynamic Trunking Protocol)"],"tags":[]},{"location":"dtp/#2-dynamic-desirable","level":3,"title":"2. Dynamic Desirable","text":"<p><pre><code>Switch(config-if)# switchport mode dynamic desirable\n</code></pre> - Env√≠a activamente frames DTP para negociar trunk - Forma trunk si el otro lado es \"auto\", \"desirable\" o \"trunk\" - Modo m√°s agresivo</p> <p>Escenarios t√≠picos:</p> <ul> <li> <p>Enlaces troncales entre switches en mismo dominio administrativo</p> </li> <li> <p>Entornos din√°micos donde se a√±aden/eliminan VLANs frecuentemente</p> </li> <li> <p>Conexiones entre switches de mismo nivel</p> </li> <li> <p>Cuando quieres auto-configuraci√≥n pero con iniciativa</p> </li> </ul> <p>Por qu√© usarlo:</p> <pre><code>‚úÖ Auto-configuraci√≥n - Forma trunks autom√°ticamente\n\n‚úÖ Flexibilidad - Se adapta a cambios de configuraci√≥n\n\n‚úÖ Conveniencia - Reduce configuraci√≥n manual\n\n‚úÖ Compatibilidad - Funciona con \"auto\" y \"trunk\"\n</code></pre>","path":["Switch","DTP (Dynamic Trunking Protocol)"],"tags":[]},{"location":"dtp/#3-trunk","level":3,"title":"3. Trunk","text":"<p><pre><code>Switch(config-if)# switchport mode trunk\n</code></pre> - Fuerza el puerto como trunk permanentemente - Env√≠a frames DTP - Espera que el otro lado sea \"auto\", \"desirable\" o \"trunk\"</p> <p>Escenarios t√≠picos:</p> <ul> <li> <p>Enlaces a routers o firewalls</p> </li> <li> <p>Conexiones a servidores con m√∫ltiples VLANs</p> </li> <li> <p>Enlaces troncales cr√≠ticos que NO deben cambiar</p> </li> <li> <p>Entornos de alta seguridad</p> </li> </ul> <p>Por qu√© usarlo:</p> <pre><code>‚úÖ M√°xima estabilidad - No cambia de estado\n\n‚úÖ Seguridad - No negocia con dispositivos no autorizados\n\n‚úÖ Control total - Configuraci√≥n expl√≠cita\n\n‚úÖ Rendimiento - Sin overhead de negociaci√≥n constante\n</code></pre>","path":["Switch","DTP (Dynamic Trunking Protocol)"],"tags":[]},{"location":"dtp/#4-access","level":3,"title":"4. Access","text":"<p><pre><code>Switch(config-if)# switchport mode access\n</code></pre> - Fuerza el puerto como acceso - No env√≠a frames DTP - Rechaza negociaci√≥n de trunk</p> <p>Escenarios t√≠picos:</p> <ul> <li> <p>Puertos para usuarios finales (PCs, tel√©fonos, impresoras)</p> </li> <li> <p>Puertos de guest/wifi</p> </li> <li> <p>Conexiones a dispositivos que no soportan trunking</p> </li> <li> <p>Entornos de m√°xima seguridad</p> </li> </ul> <p>Por qu√© usarlo:</p> <pre><code>‚úÖ M√°xima seguridad - Sin negociaci√≥n de trunk\n\n‚úÖ Estabilidad - Comportamiento predecible\n\n‚úÖ Prevenci√≥n de VLAN hopping - Elimina riesgo de ataques\n\n‚úÖ Simplicidad - F√°cil troubleshooting\n</code></pre>","path":["Switch","DTP (Dynamic Trunking Protocol)"],"tags":[]},{"location":"dtp/#5-nonegotiate","level":3,"title":"5. Nonegotiate","text":"<p><pre><code>Switch(config-if)# switchport nonegotiate\n</code></pre> - Configura trunk pero deshabilita DTP - No env√≠a frames de negociaci√≥n</p> <p>Escenarios t√≠picos:</p> <ul> <li> <p>Enlaces a equipos no-Cisco (que no entienden DTP)</p> </li> <li> <p>Conexiones a firewalls, load balancers</p> </li> <li> <p>Enlaces donde DTP causa problemas</p> </li> <li> <p>Entornos multi-vendor</p> </li> </ul> <p>Por qu√© usarlo:</p> <pre><code>‚úÖ Compatibilidad multi-vendor - Sin protocolos propietarios\n\n‚úÖ Seguridad - Sin anuncios DTP\n\n‚úÖ Estabilidad - Trunk est√°tico sin negociaci√≥n\n\n‚úÖ Control - Configuraci√≥n manual expl√≠cita\n</code></pre>","path":["Switch","DTP (Dynamic Trunking Protocol)"],"tags":[]},{"location":"dtp/#tabla-de-compatibilidad-de-modos","level":2,"title":"Tabla de Compatibilidad de Modos","text":"Lado A Lado B Resultado Dynamic Auto Dynamic Auto Access Dynamic Auto Dynamic Desirable Trunk Dynamic Desirable Dynamic Desirable Trunk Trunk Dynamic Auto Trunk Trunk Dynamic Desirable Trunk Access Cualquier modo Access","path":["Switch","DTP (Dynamic Trunking Protocol)"],"tags":[]},{"location":"dtp/#comandos-de-configuracion","level":2,"title":"Comandos de Configuraci√≥n","text":"","path":["Switch","DTP (Dynamic Trunking Protocol)"],"tags":[]},{"location":"dtp/#configuracion-basica","level":3,"title":"Configuraci√≥n B√°sica:","text":"<pre><code># Ver estado DTP\nSwitch# show dtp interface [interface]\n\n# Configurar modo DTP\nSwitch(config)# interface gigabitethernet 0/1\nSwitch(config-if)# switchport mode dynamic auto\nSwitch(config-if)# switchport mode dynamic desirable\nSwitch(config-if)# switchport mode trunk\nSwitch(config-if)# switchport mode access\n\n# Deshabilitar DTP\nSwitch(config-if)# switchport nonegotiate\n</code></pre>","path":["Switch","DTP (Dynamic Trunking Protocol)"],"tags":[]},{"location":"dtp/#configuracion-de-vlan-nativa","level":3,"title":"Configuraci√≥n de VLAN Nativa:","text":"<pre><code>Switch(config-if)# switchport trunk native vlan [vlan-id]\n</code></pre>","path":["Switch","DTP (Dynamic Trunking Protocol)"],"tags":[]},{"location":"dtp/#ventajas-de-dtp","level":2,"title":"Ventajas de DTP","text":"<p>‚úÖ Configuraci√≥n autom√°tica ‚úÖ Reduce errores manuales ‚úÖ Facilita la administraci√≥n ‚úÖ Compatibilidad entre dispositivos Cisco </p>","path":["Switch","DTP (Dynamic Trunking Protocol)"],"tags":[]},{"location":"dtp/#desventajas-y-consideraciones","level":2,"title":"Desventajas y Consideraciones","text":"<p>‚ùå Solo funciona entre equipos Cisco ‚ùå Puede crear problemas de seguridad ‚ùå Overhead en la red ‚ùå En entornos seguros, se recomienda deshabilitar</p>","path":["Switch","DTP (Dynamic Trunking Protocol)"],"tags":[]},{"location":"dtp/#mejores-practicas","level":2,"title":"Mejores Pr√°cticas","text":"","path":["Switch","DTP (Dynamic Trunking Protocol)"],"tags":[]},{"location":"dtp/#para-seguridad","level":3,"title":"Para Seguridad:","text":"<pre><code># En puertos de acceso\nSwitch(config-if)# switchport mode access\nSwitch(config-if)# switchport nonegotiate\n\n# En puertos trunk (configuraci√≥n manual)\nSwitch(config-if)# switchport mode trunk\nSwitch(config-if)# switchport nonegotiate\nSwitch(config-if)# switchport trunk allowed vlan [vlan-list]\n</code></pre>","path":["Switch","DTP (Dynamic Trunking Protocol)"],"tags":[]},{"location":"dtp/#verificacion","level":3,"title":"Verificaci√≥n:","text":"<pre><code># Ver estado DTP\nSwitch# show dtp interface gigabitethernet 0/1\n\n# Ver resumen de interfaces\nSwitch# show interfaces trunk\n\n# Ver configuraci√≥n de puerto\nSwitch# show interfaces [interface] switchport\n</code></pre>","path":["Switch","DTP (Dynamic Trunking Protocol)"],"tags":[]},{"location":"dtp/#ejemplo-practico","level":2,"title":"Ejemplo Pr√°ctico","text":"","path":["Switch","DTP (Dynamic Trunking Protocol)"],"tags":[]},{"location":"dtp/#escenario-dos-switches-interconectados","level":3,"title":"Escenario: Dos switches interconectados","text":"<p><pre><code># Switch 1\nSwitch1(config)# interface gigabitethernet 0/1\nSwitch1(config-if)# switchport mode dynamic desirable\n\n# Switch 2  \nSwitch2(config)# interface gigabitethernet 0/1\nSwitch2(config-if)# switchport mode dynamic auto\n</code></pre> Resultado: Se formar√° un enlace trunk autom√°ticamente.</p>","path":["Switch","DTP (Dynamic Trunking Protocol)"],"tags":[]},{"location":"dtp/#seguridad-con-dtp","level":2,"title":"Seguridad con DTP","text":"<p>En entornos de producci√≥n, se recomienda: - Deshabilitar DTP en puertos de acceso - Configurar trunks manualmente - Usar <code>switchport nonegotiate</code> en trunks configurados manualmente</p>","path":["Switch","DTP (Dynamic Trunking Protocol)"],"tags":[]},{"location":"ospf/","level":1,"title":"OSPF (Open Shortest Path First)","text":"<p>En esta unidad vamos a tratar los siguientes puntos:</p> <ul> <li>Anuncios y bases de datos de estados de enlaces de Open Shortest Path First</li> <li>C√≥mo calculan las rutas los routers OSPF</li> <li>Configuraci√≥n de OSPF en routers Cisco</li> <li>C√≥mo los routers OSPF se convierten en vecinos y forman adyacencias</li> </ul> <p>OSPF (Open Shortest Path First) es un protocolo de puerta de enlace interior (IGP) fundamental para las redes empresariales modernas. Ya hemos abordado los protocolos de enrutamiento din√°mico en general. En esta unidad, profundizaremos en el tema de OSPF y veremos c√≥mo funciona realmente, incluyendo c√≥mo los routers con OSPF se convierten en vecinos, comparten informaci√≥n de enrutamiento, calculan rutas y muchos otros detalles.</p> <p>Actualmente, se utilizan dos versiones de OSPF: OSPFv2, que se usa principalmente para redes IPv4, y OSPFv3, que se usa principalmente para redes IPv6 (aunque tambi√©n puede usarse para IPv4). Para el examen CCNA, la versi√≥n que nos interesa es OSPFv2; todas las menciones de OSPF en este libro se refieren espec√≠ficamente a OSPFv2, como se indica en el tema 3.4 del examen: Configurar y verificar OSPFv2 de √°rea √∫nica.</p> <p>El nombre \"Open Shortest Path First\" tiene dos aspectos: abierto significa que es un protocolo est√°ndar abierto; OSPF no es propiedad de Cisco. Todos los proveedores pueden implementar OSPF en sus dispositivos de red. Shortest Path First (SPF) es el nombre del algoritmo utilizado para calcular rutas; tambi√©n se le conoce como algoritmo de Dijkstra, en honor a su creador, Edsger Dijkstra.</p>","path":["Enrutamiento","OSPF (Open Shortest Path First)"],"tags":[]},{"location":"ospf/#fundamentos-de-ospf","level":2,"title":"Fundamentos de OSPF","text":"<p>Hay tres pasos principales que siguen los routers OSPF para compartir informaci√≥n de enrutamiento y crear sus tablas de enrutamiento:</p> <ul> <li>Establecer relaciones de vecindad con otros routers habilitados para OSPF.</li> <li>Intercambiar informaci√≥n de enrutamiento para construir un mapa de conectividad de la red.</li> <li>Calcula las mejores rutas a cada destino.</li> </ul> <p>Comencemos examinando el segundo y tercer paso de ese proceso, y luego examinaremos los detalles de c√≥mo los routers OSPF se convierten en vecinos en la secci√≥n 18.3.</p>","path":["Enrutamiento","OSPF (Open Shortest Path First)"],"tags":[]},{"location":"ospf/#la-base-de-datos-de-estado-del-enlace","level":3,"title":"La base de datos de estado del enlace","text":"<p>Al usar un protocolo de enrutamiento din√°mico, los routers intercambian informaci√≥n de enrutamiento y la utilizan para calcular rutas autom√°ticamente. En OSPF, los routers intercambian informaci√≥n de enrutamiento mediante estructuras de datos llamadas anuncios de estado de enlace (LSA). Cada router organiza los LSA que recibe en una base de datos llamada base de datos de estado de enlace (LSDB). La LSDB funciona como el mapa de la topolog√≠a de red del router, que se utiliza para calcular la ruta m√°s corta a cada red de destino; este es el conocido como mapa de conectividad de la red.</p> <p>La siguiente imagen muestra c√≥mo los routers con OSPF habilitado comparten LSA para construir la LSDB. Cada router crea una LSA que incluye informaci√≥n sobre sus redes conectadas y la env√≠a a sus routers vecinos, quienes la reenv√≠an a otros routers en el √°rea OSPF. Las √°reas OSPF son divisiones l√≥gicas de la red que abordaremos m√°s adelante. El proceso de enviar LSA a todos los dem√°s routers en el √°rea OSPF se denomina inundaci√≥n de LSA.</p> <p></p> <p>Figura 1.  Los routers inundan el √°rea OSPF con LSAs para garantizar que todos tengan una LSDB id√©ntica. Las LSAs que componen la LSDB contienen informaci√≥n sobre las redes conectadas de cada router, como su costo. La LSA del R1 indica que est√° conectado a 10.0.0.0/30, 10.0.0.4/30 y 10.1.1.0/24, cada una con un costo de 1.</p> <p>Es fundamental que todos los routers del √°rea tengan la misma LSDB, de modo que cada router pueda usar el algoritmo SPF para calcular rutas a todas las redes de destino. Por ejemplo, los routers de la figura anterior usar√°n la LSDB para calcular una ruta a la red 10.1.1.0/24. Al usar la LSDB, es como si los routers vieran el mismo diagrama que nosotros, pero con informaci√≥n m√°s detallada sobre cada enlace. Esto contrasta con los protocolos de enrutamiento por vector de distancia como RIP y EIGRP, donde cada router no tiene un mapa completo de la red.</p>","path":["Enrutamiento","OSPF (Open Shortest Path First)"],"tags":[]},{"location":"ospf/#areas-ospf","level":3,"title":"√Åreas OSPF","text":"<p>La red que vimos en la figura de arriba era un ejemplo de OSPF de √°rea √∫nica; la red es una unidad l√≥gica √∫nica y todos los routers comparten la misma LSDB. En redes peque√±as, un enfoque de √°rea √∫nica es pr√°ctico y sencillo, y no presenta grandes inconvenientes. Sin embargo, en una red grande con docenas o cientos de routers (en lugar de los seis de la imagen de arriba), un dise√±o de √°rea √∫nica tiene m√∫ltiples efectos negativos:</p> <ul> <li>El LSDB m√°s grande ocupa m√°s recursos de memoria en los routers.</li> <li>El algoritmo SPF requiere m√°s tiempo y recursos de CPU para calcular rutas.</li> <li>Un solo cambio en la red (es decir, una interfaz que se activa o desactiva) hace que las LSA inunden la red y haga que cada router ejecute nuevamente el algoritmo SPF.</li> </ul> <p>Al dividir una red OSPF grande en varias √°reas m√°s peque√±as, minimizamos estos efectos negativos. LSDB m√°s peque√±as implican que OSPF utiliza menos recursos en los routers y que el algoritmo SPF no tarda tanto en calcular las rutas. Los cambios de red solo se anuncian dentro del √°rea local, y si hay inestabilidad en la red (interfaces que se activan y desactivan), sus efectos se limitan a una sola √°rea.</p> <p>Un √°rea OSPF se puede definir como un conjunto de routers que comparten la misma LSDB.</p> <p>En la siguiente imagen se muestra una red OSPF multi√°rea compuesta por cuatro √°reas. OSPF emplea una estructura jer√°rquica de dos niveles que consta de un √°rea troncal (√°rea 0) y otras √°reas no troncales. Todas las √°reas no troncales deben estar conectadas al √°rea 0, y el tr√°fico entre √°reas debe pasar por ella.</p> <p>Nota</p> <p>En OSPF de √°rea √∫nica, se recomienda encarecidamente usar el √°rea 0, aunque t√©cnicamente es posible usar otro n√∫mero de √°rea. Usar el √°rea 0 simplifica el proceso de expansi√≥n a OSPF multi√°rea en el futuro, si es necesario.</p> <p></p> <p>Figura 2.  Una red OSPF multi√°rea compuesta por cuatro √°reas. El √°rea 0 es el √°rea principal a la que deben conectarse las dem√°s √°reas. Las √°reas 1, 2 y 3 no son √°reas principales, y el tr√°fico entre ellas debe pasar por el √°rea 0.</p> <p>OSPF distingue cuatro tipos de routers. La tabla a continuaci√≥n resume estos cuatro tipos de routers y enumera los routers de la imagen anterior que pertenecen a cada tipo. Ten en cuenta que algunos routers se clasifican en varias categor√≠as.</p> Tipo de router En la imagen Descripci√≥n Router interno R1, R2, R6, R7, R8, R9, R10, R11, R12, R13 Todas las interfaces habilitadas para OSPF est√°n en la misma √°rea. Router de backbone R1, R2, R3, R4, R5 Al menos una interfaz est√° en el √°rea 0. Router fronterizo de √°rea (ABR) R3, R4, R5 Routers que conectan una o m√°s √°reas al √°rea 0. Router fronterizo del sistema aut√≥nomo (ASBR) R1 Routers que conectan el sistema aut√≥nomo OSPF a redes externas (por ejemplo, Internet). <p>Nota</p> <p>Aunque R1 tiene una interfaz conectada a Internet, esa interfaz no utiliza OSPF y, por lo tanto, no afecta su clasificaci√≥n como router OSPF interno.</p> <p>Un router interno tiene todas sus interfaces habilitadas para OSPF en la misma √°rea, ya sea el √°rea 0 o un √°rea no troncal. Un router troncal tiene al menos una interfaz en el √°rea troncal. Un router de borde de √°rea (ABR) conecta una (o m√°s) √°reas al √°rea 0; dado que las √°reas no troncales no pueden conectarse directamente entre s√≠, todos los ABR tambi√©n son routers troncales (aunque los routers troncales no son necesariamente ABR).</p> <p>Nota</p> <p>Los ABR mantienen un LSDB separado para cada √°rea a la que est√°n conectados.</p> <p>El √∫ltimo tipo de router es un router de l√≠mite de sistema aut√≥nomo (ASBR), un router que conecta el sistema aut√≥nomo (AS) OSPF a redes externas, como Internet o la red de otra empresa. Ten en cuenta que este tipo es independiente de los dem√°s; un ASBR puede ser un router troncal o no, y puede ser un router interno o un ABR. Como hemos mostrado en la tabla, el R1 de la imagen es un router interno, un router troncal y un ASBR, todo a la vez. M√°s adelante, veremos c√≥mo configurar una ruta predeterminada en un ASBR y anunciarla a otros routers del AS OSPF.</p> <p>Las rutas OSPF se pueden clasificar como intra√°rea, inter√°rea o externas. Las rutas intra√°rea son rutas a destinos en la misma √°rea OSPF que el router; por ejemplo, si el router es interno en el √°rea 1, todas las rutas a destinos dentro del √°rea 1 son rutas intra√°rea. Las rutas inter√°rea son rutas a destinos en un √°rea a la que el router no se conecta; por ejemplo, si un ABR conectado a las √°reas 0 y 1 aprende una ruta al √°rea 2. Finalmente, las rutas a destinos externos (publicadas por un ASBR) se denominan rutas externas.</p>","path":["Enrutamiento","OSPF (Open Shortest Path First)"],"tags":[]},{"location":"ospf/#costo-de-ospf","level":3,"title":"Costo de OSPF","text":"<p>La m√©trica de OSPF se denomina costo y es el valor que utiliza para determinar la mejor ruta a cada destino (la m√°s corta en OSPF). Cada interfaz habilitada para OSPF tiene un valor de costo asociado, y el costo de una ruta es el costo acumulado de cada interfaz desde la que se debe enviar un paquete para llegar a su destino. La siguiente imagen muestra este concepto: el costo de R1 para llegar a 192.168.3.0/24 es el costo acumulado de R1 G0/0, R2 G0/1 y R3 G0/1 (pero no de R2 G0/0 ni de R3 G0/0).</p> <p></p> <p>Figura 3.  El costo de una ruta es el costo acumulado de cada interfaz desde la cual se debe enviar un paquete para llegar a su destino. El costo de R1 para llegar a 192.168.3.0/24 es 3: 1 para R1 G0/0, m√°s 1 para R2 G0/1, m√°s 1 para R3 G0/1.</p> <p>Aunque la representaci√≥n del costo de OSPF en la figura de arriba es precisa, es m√°s com√∫n referirse al costo de un enlace que al costo de cada interfaz que lo compone. Dado que ambos lados del enlace deben tener el mismo costo (se considera una configuraci√≥n incorrecta si no lo tienen) y que un router solo considera un lado del enlace al calcular el costo de la ruta, es m√°s sencillo considerar el enlace como una sola entidad.</p> <p>Usando nuevamente el ejemplo de la imagen anterior, no importa si R1 calcula una ruta a 192.168.3.0/24 o R3 a 192.168.1.0/24; el costo es el mismo en ambas direcciones. Salvo cuando me refiero espec√≠ficamente al costo de una interfaz, me referir√© al costo de un enlace en lugar del costo de cada interfaz individual.</p>","path":["Enrutamiento","OSPF (Open Shortest Path First)"],"tags":[]},{"location":"ospf/#ancho-de-banda-de-referencia","level":4,"title":"Ancho de banda de referencia","text":"<p>El costo de un enlace se calcula dividiendo un valor de ancho de banda de referencia entre el ancho de banda del enlace; el ancho de banda de referencia predeterminado es de 100 Mbps. Si este c√°lculo resulta en un valor menor que 1, el costo OSPF se asigna como 1, ya que OSPF no acepta valores fraccionarios ni decimales. Esto da como resultado los siguientes valores de costo OSPF predeterminados:</p> <ul> <li>Enlace de 10 Mbps = 10 (100/10)</li> <li>Enlace de 100 Mbps = 1 (100/100)</li> <li>Enlace de 1000 Mbps (1 Gbps) = 1 (100/1000 = 0,1)</li> <li>Enlace de 10 000 Mbps (10 Gbps) = 1 (100/10 000 = 0,01)</li> </ul> <p>Quiz√°s hay√°is notado un problema: con el ancho de banda de referencia predeterminado de 100 Mbps, todos los enlaces con un ancho de banda de 100 Mbps o superior tienen el mismo costo. Si OSPF considera que un enlace de 100 Mbps es tan preferible como uno de 1 Gbps o 10 Gbps, es probable que calcule rutas sub√≥ptimas. M√°s abajo se muestra un ejemplo: aunque la ruta de R1 a 10.1.3.0/24 a trav√©s de R4 utiliza enlaces FastEthernet, se considera igual a la ruta de R1 a trav R2, que utiliza enlaces GigabitEthernet.</p> <p></p> <p>Figura 4.  Aunque la ruta a 10.1.3.0/24 v√≠a R2 es superior a la ruta v√≠a R4, el costo OSPF de ambas rutas es el mismo. R1 agrega ambas rutas a la tabla de enrutamiento y las distribuye mediante ECMP.</p> <p>R1 agrega ambas rutas a la tabla de enrutamiento y usar√° ECMP para equilibrar la carga del tr√°fico. Si bien ECMP en s√≠ no es perjudicial, intentar reenviar la misma cantidad de tr√°fico a trav√©s de enlaces con anchos de banda muy diferentes podr√≠a generar congesti√≥n en los enlaces m√°s lentos, mientras que los enlaces m√°s r√°pidos se subutilizan.</p> <p>OSPF se desarroll√≥ hace d√©cadas, cuando FastEthernet se consideraba un enlace de muy alta velocidad; por eso, el ancho de banda de referencia predeterminado es de 100 Mbps. Sin embargo, en las redes modernas es mejor ajustar el valor del ancho de banda de referencia para que OSPF pueda diferenciar entre enlaces con mayor ancho de banda. Para ajustar el valor del ancho de banda de referencia, utilice el comando auto-cost reference-bandwidth mbps en el modo de configuraci√≥n del router OSPF.</p> <p>En el siguiente ejemplo, se confirma el costo de las interfaces de R1 con el comando <code>show ip ospf interface brief</code>. Luego, se ajusta el ancho de banda de referencia a 1000 Mbps, de modo que los enlaces GigabitEthernet tengan un costo de 1 y los enlaces FastEthernet, de 10. Aunque no existe un valor recomendado espec√≠fico para el ancho de banda de referencia, es com√∫n configurarlo para que coincida con el ancho de banda del enlace m√°s r√°pido de la red. Otra opci√≥n es establecer el ancho de banda de referencia en un valor mayor que el ancho de banda del enlace m√°s r√°pido actual para permitir que se agreguen enlaces a√∫n m√°s r√°pidos a la red sin tener que volver a ajustar el ancho de banda de referencia.</p> <pre><code>R1# show ip ospf interface brief\nInterface    PID   Area   IP Address/Mask    Cost  State Nbrs F/C\nGi0/0        1     0      10.0.0.1/30        1     DR    1/1\nFa1/0        1     0      10.0.0.5/30        1     DR    1/1\nR1# configure terminal\nR1(config)# router ospf 1\nR1(config-router)# auto-cost reference-bandwidth 1000\n% OSPF: Reference bandwidth is changed.\n        Please ensure reference bandwidth is consistent\n across all routers.\nR1(config-router)# do show ip ospf interface brief\nInterface    PID   Area   IP Address/Mask    Cost  State Nbrs F/C\nGi0/0        1     0      10.0.0.1/30        1     DR    1/1\nFa1/0        1     0      10.0.0.5/30        10    DR    1/1\n</code></pre> <p>Como indica el mensaje de advertencia del ejemplo anterior, es importante configurar el mismo ancho de banda de referencia en todos los routers para garantizar una selecci√≥n de ruta consistente. En el peor de los casos, tener diferentes anchos de banda de referencia podr√≠a generar bucles de enrutamiento: si el router A cree que la mejor ruta a un destino es a trav√©s del router B, pero el router B cree que la mejor ruta es a trav√©s del router A, los paquetes para ese destino se repetir√°n entre los dos routers hasta que expire su TTL, sin llegar nunca a su destino previsto.</p>","path":["Enrutamiento","OSPF (Open Shortest Path First)"],"tags":[]},{"location":"ospf/#modificar-el-coste-de-un-enlace","level":4,"title":"Modificar el coste de un enlace","text":"<p>Aunque modificar el ancho de banda de referencia suele ser suficiente para que OSPF seleccione la ruta m√°s eficiente a un destino, en algunos casos, puede ser necesario modificar el coste de un enlace espec√≠fico para que sea m√°s o menos preferible. Existen dos m√©todos para hacerlo:</p> <ul> <li>Configurar el costo con el comando <code>ip ospf cost cost</code> en el modo de configuraci√≥n de interfaz.</li> <li>Modificar el valor del ancho de banda de la interfaz con el comando <code>bandwidth kbps</code> en el modo de configuraci√≥n de interfaz.</li> </ul> <p>Nota</p> <p>Aunque el ancho de banda de referencia est√° configurado en megabits por segundo, el valor del ancho de banda de la interfaz est√° configurado en kilobits por segundo.</p> <p>De los dos, el primer m√©todo es el preferido si se desea modificar el costo OSPF de un enlace espec√≠fico: permite configurar directamente el costo OSPF de la interfaz. El segundo m√©todo, en cambio, se utiliza para influir en el c√°lculo autom√°tico de costos que vimos anteriormente: ancho de banda de referencia/ancho de banda de la interfaz. Sin embargo, el valor del ancho de banda de una interfaz afecta m√°s all√° de los valores de costo OSPF, como los mecanismos de QoS (calidad de servicio), por lo que generalmente es mejor no modificarlo.</p> <p>Nota</p> <p>Modificar el valor del ancho de banda de una interfaz en realidad no afecta el funcionamiento de la interfaz; es solo un valor utilizado para c√°lculos como el costo de OSPF, la m√©trica de EIGRP, etc. Para cambiar la velocidad a la que funciona una interfaz, se ha de utilizar el comando <code>speed</code>.</p>","path":["Enrutamiento","OSPF (Open Shortest Path First)"],"tags":[]},{"location":"ospf/#configuracion-de-ospf","level":2,"title":"Configuraci√≥n de OSPF","text":"<p>En la secci√≥n correspondiente, vimos c√≥mo activar OSPF en las interfaces del router con el comando <code>network</code>. Este comando por s√≠ solo es suficiente para que OSPF funcione en su nivel m√°s b√°sico; tras activar OSPF en las interfaces de un router, este intentar√° establecer relaciones de vecindad y compartir LSA con otros routers conectados a dichas interfaces. En esta secci√≥n, veremos c√≥mo configurar otros aspectos de OSPF, incluyendo una forma m√°s sencilla de activar OSPF en las interfaces de un router.</p> <p>El primer paso para configurar OSPF es crear un proceso OSPF con el comando <code>router ospf process-id</code>. Este comando permite acceder al modo de configuraci√≥n del router, desde donde se puede usar el comando network y muchos otros comandos relacionados con OSPF. Se pueden crear m√∫ltiples procesos OSPF. Cada uno de estos procesos calcula de forma independiente sus propias rutas a las redes de destino. Sin embargo, ejecutar m√∫ltiples procesos OSPF en un router es extremadamente raro, y los casos de uso espec√≠ficos quedan fuera del objetivo de este curso. Para esta unidad, solo usaremos el ID de proceso 1 (aunque se puede elegir cualquier otro n√∫mero).</p> <p>Nota</p> <p>El ID de proceso OSPF es localmente significativo; no importa si coincide con los routers vecinos. Por ejemplo, un router con el ID de proceso OSPF 1 puede convertirse en vecino de un router con el ID de proceso OSPF 65535 (el valor m√°s alto posible).</p> <p>Aqu√≠ se muestra la topolog√≠a que configuraremos en esta secci√≥n: una red OSPF de √°rea √∫nica con cuatro routers. La subred 10.1.3.0/24 est√° conectada a R3 G0/1, que configuraremos como interfaz pasiva (m√°s informaci√≥n m√°s adelante). R1 se conecta a internet y lo configuraremos para que anuncie una ruta predeterminada a los dem√°s routers.</p> <p></p> <p>Figura 5.  Red OSPF de √°rea √∫nica con cuatro routers. El R3 se conecta a la subred 10.1.3.0/24 en su interfaz G0/1, una interfaz pasiva. El R1 se conecta a internet y anuncia una ruta predeterminada a los dem√°s routers.</p>","path":["Enrutamiento","OSPF (Open Shortest Path First)"],"tags":[]},{"location":"ospf/#el-id-del-router","level":3,"title":"El ID del router","text":"<p>Al usar por primera vez el comando <code>router ospf</code> para crear el proceso OSPF, el router se asignar√° un ID de router (RID), un valor √∫nico de 32 bits que lo identifica en el AS OSPF. A diferencia del ID de proceso, el RID debe ser √∫nico; no puede haber dos routers con el mismo RID en el AS. Para ver el RID de un router, se puede usar el comando <code>show ip protocols</code>; este comando muestra informaci√≥n sobre los protocolos de enrutamiento activos en el router. En el siguiente ejemplo, se crea el proceso OSPF 1 en R1 y verifico su RID:</p> <pre><code>R1(config)# router ospf 1\nR1(config-router)# do show ip protocols\n. . .\nRouting Protocol is \"ospf 1\"\n  Outgoing update filter list for all interfaces is not set\n  Incoming update filter list for all interfaces is not set\n  Router ID 203.0.113.1\n  Number of areas in this router is 1. 1 normal 0 stub 0 nssa\n. . .\n</code></pre> <p>R1 ha seleccionado la direcci√≥n IP de su interfaz G0/2 (203.0.113.1) como su RID. El RID se asigna en el siguiente orden de prioridad:</p> <ol> <li>Configuraci√≥n manual con el comando router-id</li> <li>Direcci√≥n IP m√°s alta en una interfaz de loopback operativa (ascendente/ascendente) (cubriremos las interfaces de loopback en esta secci√≥n)</li> <li>Direcci√≥n IP m√°s alta en una interfaz f√≠sica operativa (arriba/arriba)</li> </ol> <p>Como se indic√≥ en el primer punto, se puede configurar manualmente el RID con el comando <code>router-id</code>. Sin embargo, este comando solo se puede configurar una vez que se haya ingresado al modo de configuraci√≥n del router. Para acceder a este modo, primero se debe crear el proceso OSPF con el comando <code>router ospf</code>.</p> <p>Por lo tanto, al crear el proceso OSPF por primera vez, el router no puede considerar ninguna configuraci√≥n manual de RID: a√∫n no se ha establecido ninguna. En su lugar, solo considera la segunda y la tercera opci√≥n para asignar el RID: la direcci√≥n IP m√°s alta en una interfaz de loopback operativa (si existe alguna) o, en su defecto, la direcci√≥n IP m√°s alta en una interfaz f√≠sica operativa. En este caso, R1 seleccion√≥ la direcci√≥n IP m√°s alta en una interfaz f√≠sica operativa: la de G0/2.</p> <p>Nota</p> <p>Si se crea un proceso OSPF y el router no tiene interfaces operativas con una direcci√≥n IP, el proceso no podr√° iniciarse hasta que se configure el RID o una interfaz con una direcci√≥n IP se vuelva operativa.</p>","path":["Enrutamiento","OSPF (Open Shortest Path First)"],"tags":[]},{"location":"ospf/#interfaces-de-loopback","level":4,"title":"Interfaces de loopback","text":"<p>Una interfaz de loopback es una interfaz de router virtual que siempre est√° activa y accesible mientras el dispositivo est√© operativo (aunque se puede desactivar mediante el apagado). </p> <p>A diferencia de las interfaces f√≠sicas (por ejemplo, GigabitEthernet0/1), que dependen de puertos y conexiones f√≠sicas, las interfaces de loopback se basan completamente en software. La ventaja de una interfaz de loopback es que proporciona una interfaz estable y fiable que permite identificar y conectarse al router sin depender de ning√∫n puerto f√≠sico en particular. Abajo se muestra c√≥mo la interfaz de loopback del R1 proporciona una interfaz estable para que un administrador se conecte mediante Secure Shell (SSH).</p> <p></p> <p>Figura 6.  Un administrador usa SSH para conectarse a la interfaz Loopback0 de R1. Loopback0 no depende del estado de una interfaz f√≠sica espec√≠fica, como G0/0, que est√° inactiva debido a un fallo de hardware.</p> <p>Nota</p> <p>SSH es un protocolo utilizado para acceder de forma remota a la CLI de un dispositivo de forma segura.</p> <p>Si el administrador, por ejemplo, hubiera intentado conectarse a la direcci√≥n IP de la interfaz G0/0 de R1, la conexi√≥n habr√≠a fallado; la interfaz G0/0 est√° inactiva debido a un fallo de hardware. Por otro lado, la interfaz Loopback0 proporciona una direcci√≥n IP estable a la que el administrador puede conectarse independientemente del estado de los puertos f√≠sicos de R1. Sin embargo, es importante tener en cuenta que el PC del administrador a√∫n necesita una ruta f√≠sica v√°lida para llegar a R1. Si tanto G0/0 como G0/1 estuvieran inactivos, el PC no podr√≠a conectarse a R1 a pesar de la interfaz Loopback.</p> <p>Aunque las interfaces de loopback no son obligatorias, se recomienda configurarlas en los routers y activar OSPF para que todos puedan acceder a las interfaces de loopback de los dem√°s. Para crear una interfaz de loopback, utilice el comando interface loopback number; normalmente se empieza con Loopback0. En el siguiente ejemplo, se configura una interfaz de loopback en R1, se le configura una direcci√≥n IP y se vuelve a comprobar el RID de OSPF:</p> <pre><code>R1(config)# interface loopback0\nR1(config-if)# ip address 172.16.1.1 255.255.255.255\nR1(config-if)# do show ip protocols\n. . .\n  Router ID 203.0.113.1\n. . .\n</code></pre> <p>Nota</p> <p>Es est√°ndar configurar las interfaces de loopback con una m√°scara de red /32 (255.255.255.255). Esto se debe a que, por naturaleza, una interfaz de loopback no necesita comunicarse con otros dispositivos en la misma subred (como lo har√≠a una interfaz f√≠sica). En cambio, representa un solo dispositivo y, por lo tanto, no necesita un rango de direcciones.</p> <p>A pesar de configurar una interfaz de loopback, el RID de R1 permanece invariable; para mantenerlo estable, IOS no lo vuelve a seleccionar al configurar una nueva interfaz. Es posible restablecer el proceso OSPF con el comando <code>clear ip ospf process</code> en modo EXEC privilegiado, pero ni siquiera esto har√° que R1 seleccione la direcci√≥n IP de la interfaz de loopback como RID, como se muestra en el siguiente ejemplo:</p> <pre><code>R1# clear ip ospf process\nReset ALL OSPF processes? [no]: yes\nR1# show ip protocols\n. . .\n  Router ID 203.0.113.1\n. . .\n</code></pre> <p>Nota</p> <p>Es importante recordar que, una vez que el router haya seleccionado su RID, lo mantendr√° incluso si se configura una interfaz de loopback y se restablece OSPF. La direcci√≥n IP de una interfaz de loopback solo se usar√° para la selecci√≥n inicial del RID al crear el proceso OSPF. Para que un router cambie su RID despu√©s de haberlo seleccionado, debe configurarlo manualmente; lo explicaremos a continuaci√≥n.</p>","path":["Enrutamiento","OSPF (Open Shortest Path First)"],"tags":[]},{"location":"ospf/#cambiar-el-rid","level":4,"title":"Cambiar el RID","text":"<p>Una vez que R1 ha seleccionado su RID, la mejor manera de cambiarlo es configurarlo manualmente y luego reiniciar el proceso OSPF (si es necesario). En cualquier caso, codificar el RID del router con configuraci√≥n manual se considera una buena pr√°ctica para garantizar RID predecibles en todos los routers. En el siguiente ejemplo, se configura el comando <code>router-id</code> en R1, lo que provoca que cambie su RID:</p> <pre><code>R1(config)# router ospf 1\nR1(config-router)# router-id 172.16.1.1\nR1(config-router)# do show ip protocols\n. . .\n  Router ID 172.16.1.1\n. . .\n</code></pre> <p>Nota</p> <p>Si el router ya ha establecido una relaci√≥n de vecindad con uno o m√°s vecinos OSPF, deber√° reiniciar el proceso OSPF con el proceso <code>clear ip ospf</code> para que el RID reci√©n configurado surta efecto. Sin embargo, en este punto del ejemplo, a√∫n no se hs activado OSPF en ninguna de las interfaces del R1, por lo que no tiene vecinos OSPF. Por eso, el nuevo RID se implement√≥ de inmediato.</p> <p>Aunque el RID OSPF suele derivarse de una de las direcciones IP del router, es importante tener en cuenta que no es una direcci√≥n IP; es simplemente un valor de 32 bits con un formato similar al de una direcci√≥n IP (notaci√≥n decimal con puntos). Siempre que el RID sea √∫nico en el AS OSPF, puede ser cualquier valor de 32 bits.</p> <p>En el siguiente ejemplo, se configura una interfaz de loopback en R2 y luego se crea el proceso OSPF. En este caso, R2 toma la direcci√≥n IP de Loopback0 como su RID, ya que se ha configurado la interfaz de loopback antes de crear el proceso OSPF:</p> <pre><code>R2(config)# interface l0\nR2(config-if)# ip address 172.16.1.2 255.255.255.255\nR2(config-if)# router ospf 1\nR2(config-router)# do show ip protocols\n. . .\n  Router ID 172.16.1.2\n. . .\n</code></pre> <p>Nota</p> <p>Por cuestiones de espacio, no se mostrar√°n las configuraciones, pero tambi√©n ha sido configurada Loopback0 en R3 (172.16.1.3/32) y R4 (172.16.1.4/32) y se ha creado el proceso OSPF.</p>","path":["Enrutamiento","OSPF (Open Shortest Path First)"],"tags":[]},{"location":"ospf/#direcciones-de-loopback-e-interfaces-de-loopback","level":4,"title":"Direcciones de loopback e interfaces de loopback","text":"<p>Los mensajes enviados a cualquier direcci√≥n en este rango se reenv√≠an al dispositivo local sin transmitirse por la red. Por ejemplo, si se ejecuta el comando ping 127.0.0.1 en una PC, se recibir√° una respuesta de la propia PC. Esto puede usarse para probar el software de red del dispositivo.</p> <p>Aunque comparten el t√©rmino \"loopback\", las interfaces de loopback son un concepto diferente de las direcciones de loopback. Las interfaces de loopback son interfaces virtuales en un router a las que se puede asignar cualquier direcci√≥n IP v√°lida (excepto el rango de direcciones de loopback reservado). Las interfaces de loopback proporcionan una direcci√≥n IP estable y confiable que permite acceder al router y que no depende del estado de una interfaz f√≠sica espec√≠fica.</p>","path":["Enrutamiento","OSPF (Open Shortest Path First)"],"tags":[]},{"location":"ospf/#activacion-ospf","level":3,"title":"Activaci√≥n de OSPF en interfaces","text":"<p>Activar OSPF en las interfaces es posiblemente la parte m√°s importante de la configuraci√≥n de OSPF; es lo que le indica al router que cree vecinos OSPF y comparta informaci√≥n de enrutamiento. En el siguiente ejemplo, se utiliza el comando <code>network</code> para activar OSPF en las interfaces G0/0, G0/1 y L0 del R1:</p> <pre><code>R1(config)# router ospf 1\nR1(config-router)# network 10.0.0.1 0.0.0.0 area 0\nR1(config-router)# network 10.0.0.5 0.0.0.0 area 0\nR1(config-router)# network 172.16.1.1 0.0.0.0 area 0\nR1(config-router)# do show ip protocols\n. . .\n  Router ID 172.16.1.1\n  Number of areas in this router is 1. 1 normal 0 stub 0 nssa\n  Maximum path: 4\n  Routing for Networks:\n    10.0.0.1 0.0.0.0 area 0\n    10.0.0.5 0.0.0.0 area 0\n    172.16.1.1 0.0.0.0 area 0\n. . .\n</code></pre> <p>Nota</p> <p>No se ha activado OSPF en R1 G0/2, que est√° conectado a internet. M√°s adelante, configuraremos una ruta predeterminada a trav√©s de G0/2 en R1 y la anunciaremos a los vecinos de R1, pero no es necesario activar OSPF en la interfaz.</p> <p>Sin embargo, existe un m√©todo m√°s sencillo para activar OSPF en las interfaces: el comando <code>ip ospf process-id area area</code> en el modo de configuraci√≥n de interfaz. Mientras que el comando <code>network</code> especifica un rango de direcciones IP y el router activa OSPF en todas las interfaces con una direcci√≥n IP dentro de ese rango, este comando permite especificar expl√≠citamente en qu√© interfaces se debe activar OSPF. En el siguiente ejemplo, se activa OSPF en las interfaces G0/0, G0/1 y L0 (Loopback0) del R2:</p> <pre><code>R2(config)# interface range g0/0-1,l0\nR2(config-if-range)# ip ospf 1 area 0\nR2(config-if-range)# do show ip protocols\n. . .\n  Router ID 172.16.1.2\n  Number of areas in this router is 1. 1 normal 0 stub 0 nssa\n  Maximum path: 4\n  Routing for Networks:\n  Routing on Interfaces Configured Explicitly (Area 0):\n    Loopback0    \n    GigabitEthernet0/0    \n    GigabitEthernet0/1\n</code></pre> <p>Creo que estaremos de acuerdo en que este m√©todo es mucho m√°s sencillo que usar el comando <code>network</code>. En el siguiente ejemplo, se utiliza este m√©todo para activar OSPF tambi√©n en las interfaces de R3 y R4:</p> <pre><code>R3(config)# interface range g0/0-2,l0\nR3(config-if-range)# ip ospf 1 area 0\n\nR4(config)# interface range g0/0-1,l0\nR4(config-if-range)# ip ospf 1 area 0\n</code></pre>","path":["Enrutamiento","OSPF (Open Shortest Path First)"],"tags":[]},{"location":"ospf/#interfaces-pasivas","level":3,"title":"Interfaces pasivas","text":"<p>La activaci√≥n de OSPF en una interfaz hace que el router realice dos acciones clave:</p> <ul> <li>Intenta formar relaciones de vecinos con los routers conectados a la interfaz.</li> <li>Anuncia el prefijo de red de la interfaz a los vecinos.</li> </ul> <p>Sin embargo, en algunos casos, podr√≠a ser conveniente que el router realice la segunda acci√≥n (anunciar el prefijo de red) sin intentar establecer relaciones de red en la interfaz. Para establecer relaciones de vecindad, los routers con OSPF habilitado env√≠an mensajes de saludo desde sus interfaces.</p> <p>Si una interfaz no est√° conectada a otro router, estos mensajes de saludo se desperdician, consumiendo recursos de CPU y memoria del router y ancho de banda de la red. Adem√°s, estos mensajes OSPF innecesarios pueden representar un riesgo de seguridad, ya que usuarios maliciosos podr√≠an recopilar informaci√≥n sobre la red al examinarlos.</p> <p>Nota</p> <p>Aqu√≠ es donde entran en juego las interfaces pasivas. Una interfaz pasiva en OSPF es aquella que no env√≠a mensajes OSPF para iniciar relaciones con vecinos, aunque est√© habilitada para OSPF. Sin embargo, el router anunciar√° el prefijo de red de la interfaz a sus vecinos OSPF, lo que les permite reenviar paquetes a destinos en la red.</p> <p>La figura de abajo muestra una situaci√≥n en la que se debe configurar una interfaz pasiva. R3 G0/1 se conecta a la red 10.1.3.0/24, pero no hay otros routers conectados a la interfaz. Para permitir que R1, R2 y R4 conozcan 10.1.3.0/24 y evitar que R3 env√≠e mensajes de saludo OSPF desde la interfaz, esta debe configurarse como una interfaz pasiva.</p> <p></p> <p>Figura 7.  R3 anuncia el prefijo de red de G0/1 (una interfaz pasiva), pero no env√≠a mensajes de saludo OSPF desde all√≠.</p> <p>Configurar interfaces de loopback como pasivas tambi√©n se considera una buena pr√°ctica en OSPF. Dado que una interfaz de loopback es una interfaz virtual que no est√° conectada f√≠sicamente a ninguna red, no es pr√°cticamente necesario que env√≠e mensajes de saludo OSPF para intentar establecer relaciones de vecindad. Para configurar una interfaz pasiva, se utiliza el comando `passive-interface interface-name en el modo de configuraci√≥n del router. En el siguiente ejemplo, se configuran R3 G0/1 y L0 como interfaces pasivas:</p> <pre><code>R3(config)# router ospf 1\nR3(config-router)# passive-interface g0/1\nR3(config-router)# passive-interface l0\nR3(config-router)# do show ip protocols\n. . .\n Routing on Interfaces Configured Explicitly (Area 0):\n    Loopback0\n    FastEthernet1/0\n    GigabitEthernet0/0\n    GigabitEthernet0/1\n  Passive Interface(s):\n    GigabitEthernet0/1\n    Loopback0\n</code></pre> <p>Otro m√©todo para configurar interfaces pasivas es usar el comando <code>passive-interface default</code>, que establece todas las interfaces como pasivas por defecto. Luego, puede usar el comando <code>no passive-interface interface-name</code> para especificar qu√© interfaces no deben ser pasivas. Este m√©todo de configuraci√≥n puede ser conveniente si un router tiene muchas interfaces habilitadas para OSPF, pero solo unas pocas interfaces en las que necesita establecer relaciones de vecindad OSPF. Aunque este no es el caso de R2, en el siguiente ejemplo, se utiliza este m√©todo para configurar L0 como interfaz pasiva y G0/0 y G0/1 como no pasivas:</p> <pre><code>R2(config)# router ospf 1\nR2(config-router)# passive-interface default\nR2(config-router)# no passive-interface g0/0\nR2(config-router)# no passive-interface g0/1\n</code></pre>","path":["Enrutamiento","OSPF (Open Shortest Path First)"],"tags":[]},{"location":"ospf/#anunciando-una-ruta-predeterminada","level":3,"title":"Anunciando una ruta predeterminada","text":"<p>En la mayor√≠a de los casos, los hosts conectados a routers en un sistema aut√≥nomo OSPF no solo necesitan comunicarse entre s√≠, sino tambi√©n con hosts en redes externas, como Internet. Para habilitar esta comunicaci√≥n, se puede configurar una ruta predeterminada en el router conectado a su ISP y luego configurarlo para que comparta dicha ruta predeterminada con los dem√°s routers del sistema aut√≥nomo OSPF. Aqu√≠ se muestra c√≥mo configurar esto.</p> <p></p> <p>Figura 8.  El R1 funciona como un ASBR, anunciando una ruta predeterminada en el AS OSPF. Despu√©s de configurar una ruta predeterminada, se utiliza la funci√≥n <code>default-information originate</code> para anunciar la ruta a otros routers en el AS OSPF.</p> <p>Para que R1 anuncie una ruta predeterminada a R2, R3 y R4, primero debe configurar una ruta predeterminada est√°tica en R1. Si configura <code>default-information origin</code> en R1 sin configurar una ruta predeterminada, R1 no anunciar√° una ruta predeterminada a otros routers; primero debe tener una ruta predeterminada en su propia tabla de enrutamiento.</p> <p>Despu√©s de configurar la ruta predeterminada, se ha de usar el comando <code>default-information originate</code> en el modo de configuraci√≥n del router para que R1 anuncie la ruta predeterminada a los dem√°s routers. Esto se muestra en el siguiente ejemplo.</p> <p>Observad la instrucci√≥n adicional agregada a la salida de <code>show ip protocols</code>, R1 es ahora un ASBR:</p> <pre><code>R1(config)# ip route 0.0.0.0 0.0.0.0 203.0.113.2\nR1(config)# router ospf 1\nR1(config-router)# default-information originate\nR1(config-router)# do show ip protocols\n. . .\nRouting Protocol is \"ospf 1\"\n  Outgoing update filter list for all interfaces is not set\n  Incoming update filter list for all interfaces is not set\n  Router ID 172.16.1.1\n  It is an autonomous system boundary router\n. . .\n</code></pre> <p>En el siguiente ejemplo, se utiliza <code>show ip route ospf on R2</code> para ver las rutas que R2 aprendi√≥ mediante OSPF. R2 aprendi√≥ una ruta predeterminada de R1, adem√°s de las dem√°s rutas aprendidas mediante OSPF:</p> <pre><code>R2# show ip route ospf\n. . .\nO*E2  0.0.0.0/0 [110/1] via 10.0.0.1, 00:37:34,\n      GigabitEthernet0/0\n      10.0.0.0/8 is variably subnetted, 7 subnets, 3 masks\nO        10.0.0.4/30 [110/2] via 10.0.0.1, 00:02:09,\n      GigabitEthernet0/0\nO        10.0.0.12/30 [110/2] via 10.0.0.10, 01:11:30,\n      GigabitEthernet0/1\nO        10.1.3.0/24 [110/2] via 10.0.0.10, 01:11:30,\n      GigabitEthernet0/1\n      172.16.0.0/32 is subnetted, 4 subnets\nO        172.16.1.1 [110/2] via 10.0.0.1, 01:11:30,\n      GigabitEthernet0/0\nO        172.16.1.3 [110/2] via 10.0.0.10, 01:11:30,\n      GigabitEthernet0/1\nO        172.16.1.4 [110/3] via 10.0.0.10, 00:13:54,\n      GigabitEthernet0/1\n                    [110/3] via 10.0.0.1, 00:02:09,\n      GigabitEthernet0/0\n</code></pre> <p>Nota</p> <p>Las interfaces de loopback a√±aden un coste de 1 a una ruta. Por ejemplo, el coste de R2 para llegar a la interfaz de loopback de R1 (172.16.1.1) es de 2: 1 para el enlace R2-R1, m√°s 1 para la L0 de R1 (Loopback0).</p> <p>Observad que R2 ha insertado dos rutas a 172.16.1.4 en su tabla de enrutamiento; este es un ejemplo de ECMP. De forma predeterminada, OSPF insertar√° hasta cuatro rutas de igual costo a un destino en la tabla de enrutamiento. Este valor se puede modificar con el comando <code>maximum-paths number</code> en el modo de configuraci√≥n del router, aunque el valor predeterminado de 4 suele ser suficiente para la mayor√≠a de los escenarios de red.</p>","path":["Enrutamiento","OSPF (Open Shortest Path First)"],"tags":[]},{"location":"ospf/#vecinos-y-adyacencias","level":2,"title":"Vecinos y adyacencias","text":"<p>Para que los routers OSPF intercambien informaci√≥n de enrutamiento, primero necesitan establecer relaciones de vecindad entre s√≠. En esta secci√≥n, examinaremos este primer paso crucial de OSPF. A modo de resumen, los tres pasos fundamentales del proceso OSPF son establecer relaciones de vecindad, intercambiar informaci√≥n de enrutamiento y calcular rutas. La siguiente tabla resume los cinco tipos de mensajes que OSPF utiliza en este proceso; examinaremos la funci√≥n de cada uno en esta secci√≥n a medida que explicamos c√≥mo los routers OSPF establecen relaciones de vecindad.</p> Tipo Nombre Objetivo 1 Hola (Hello) Descubrimiento y mantenimiento de vecinos. 2 Descripci√≥n de la base de datos (DBD) Resume el LSDB del router. Se utiliza para comprobar si el LSDB de cada router es el mismo. 3 Solicitud de estado de enlace (LSR) Solicita LSA espec√≠ficos de un vecino. 4 Actualizaci√≥n del estado del enlace (LSU) Env√≠a LSA espec√≠ficos a un vecino. 5 Reconocimiento del estado del enlace (LSAck) Se utiliza para confirmar la recepci√≥n de una LSU.","path":["Enrutamiento","OSPF (Open Shortest Path First)"],"tags":[]},{"location":"ospf/#estados-vecinos","level":3,"title":"Estados vecinos","text":"<p>Para que los routers OSPF intercambien informaci√≥n de enrutamiento, deben pasar por una serie de estados vecinos, en los cuales verifican la coincidencia de diversos par√°metros de configuraci√≥n. La imagne de bajo describe los estados vecinos OSPF, desde Inactivo hasta Completo.</p> <p>Podr√≠amos hablar largo y tendido sobre este proceso pero sobrepasa los objetivos del curso.</p> <p></p> <p>Figura 9.  Estados vecinos OSPF: Inactivo, Inicializaci√≥n, Bidireccional, ExStart, Intercambio, Cargando y Completo. Los routers que alcanzan el estado Bidireccional son vecinos OSPF. Algunos routers permanecen en este estado y otros establecen una adyacencia completa.</p> <p>Cuando OSPF se activa en una interfaz, el router env√≠a regularmente mensajes de saludo OSPF, que se utilizan para descubrir din√°micamente vecinos OSPF y mantener las relaciones entre ellos una vez establecidas. Estos mensajes de saludo incluyen informaci√≥n diversa, dos de los cuales son el RID del router local y los RID de cualquier router vecino que tenga en cuenta en la interfaz.</p> <p>Los mensajes de saludo OSPF se env√≠an a la direcci√≥n IP 224.0.0.5, que es una direcci√≥n IP de multidifusi√≥n. Mientras que los paquetes de unidifusi√≥n son uno a uno (de un host a otro) y los paquetes de difusi√≥n son uno a todos, los paquetes de multidifusi√≥n son uno a m√∫ltiples (pero no necesariamente todos). </p> <p>Un paquete enviado a la direcci√≥n IP de multidifusi√≥n 224.0.0.5 ser√° inundado por un switch y, por lo tanto, recibido por todos los hosts del segmento. Sin embargo, solo las interfaces del router con OSPF activado estar√°n interesadas en el contenido del paquete; los dem√°s hosts simplemente lo ignorar√°n, como se muestra en la imagen:</p> <p></p> <p>Figura 10.  Un mensaje <code>hello</code> OSPF del R1 se dirige a la direcci√≥n de multidifusi√≥n 224.0.0.5. El switch inunda la trama y los R2 G0/0 y R4 G0/0 con OSPF habilitado aceptan el mensaje de saludo. El R3 ignora el mensaje de saludo porque G0/0 no est√° habilitado para OSPF.</p> <p>El primer estado de vecino OSPF es Inactivo, aunque no es realmente un estado de vecino; significa que el router no ha recibido ning√∫n mensaje de saludo en la interfaz. Luego, usando un ejemplo de los estados de vecino que se mostraba en una imagen m√°s arriba, cuando R2 recibe por primera vez un mensaje <code>hello</code> de R1, R2 crear√° una entrada de vecino OSPF para R1 en el estado Init, como se muestra en el siguiente ejemplo:</p> <pre><code>R2# show ip ospf neighbor\nNeighbor ID     Pri   State           Dead Time   Address         Interface\n172.16.1.1        1   INIT/DROTHER    00:00:38    10.0.0.1        GigabitEthernet0/0\n</code></pre> <p><code>show ip ospf neighbor</code> es un comando muy √∫til para comprobar los vecinos OSPF del router y sus estados. El estado inicial significa que el router ha recibido un mensaje <code>hello</code> OSPF de un router vecino, pero que dicho mensaje no incluye el RID del router local. R2 enviar√° entonces su propio mensaje de saludo a R1, incluyendo el RID de R1, tras haberlo aprendido del saludo de R1. Cuando R1 recibe este saludo de R2, R1 crea una entrada de vecino OSPF para R2 en el estado bidireccional, omitiendo el estado inicial. El siguiente ejemplo muestra la entrada de la tabla de vecinos OSPF de R1 para R2:</p> <pre><code>R1# show ip ospf neighbor\nNeighbor ID     Pri   State           Dead Time   Address    Interface\n172.16.1.2        1   2WAY/DROTHER    00:00:39    10.0.0.2   GigabitEthernet0/0\n</code></pre> <p>Tras recibir un saludo de R2 (y, por lo tanto, conocer su RID), R1 env√≠a otro saludo a R2, incluyendo esta vez su RID en el mensaje. R2 entonces mueve su entrada de la tabla de vecinos para R1 al estado bidireccional. En este punto, R1 y R2 se consideran vecinos OSPF: se ven y se reconocen mutuamente, pero no han intercambiado informaci√≥n de enrutamiento.</p> <p>Nota</p> <p>En algunos casos, la elecci√≥n de un router designado (DR) y un router designado de respaldo (BDR) se lleva a cabo en el estado bidireccional.</p> <p>Para que los routers OSPF intercambien informaci√≥n de enrutamiento, deben establecer una adyacencia OSPF progresando hacia el estado completo. Para ello, pasan a los estados ExStart e Exchange, donde intercambian mensajes de descripci√≥n de base de datos (DBD), que son res√∫menes del contenido de la LSDB de cada router. En el estado ExStart, determinan qu√© router liderar√° el intercambio DBD: el router con el RID m√°s alto se convertir√° en el l√≠der y el router con el RID m√°s bajo, en el seguidor. A continuaci√≥n, el intercambio DBD se lleva a cabo en el estado Exchange.</p> <p>Nota</p> <p>L√≠der/Seguidor es una actualizaci√≥n reciente de la terminolog√≠a OSPF, que reemplaza al antiguo \"Maestro/Esclavo\". Al ser una actualizaci√≥n reciente, los t√©rminos antiguos siguen siendo m√°s comunes (y se utilizan en el software Cisco IOS), por lo que conviene conocerlos.</p> <p>Tras intercambiar las DBD, los routers conocen el contenido de sus respectivas LSDB. A continuaci√≥n, pasan al estado de carga, donde utilizan mensajes de solicitud de estado de enlace (LSR) para solicitar LSA espec√≠ficas, mensajes de actualizaci√≥n de estado de enlace (LSU) para enviar LSA y mensajes de acuse de recibo de estado de enlace (LSAck) para confirmar la recepci√≥n de LSU.</p> <p>Nota</p> <p>Las LSA son estructuras de datos que contienen informaci√≥n de enrutamiento OSPF y se env√≠an en mensajes LSU. Las LSU son como los sobres que contienen las LSA.</p> <p>Los routers entran entonces en estado completo, lo que significa que han sincronizado sus LSDB. En este punto, se denominan vecinos adyacentes o completamente adyacentes, y su relaci√≥n de vecindad se denomina ahora adyacencia o adyacencia completa. Mientras la conexi√≥n entre los routers se mantenga estable, deber√≠an permanecer en estado completo, compartiendo LSA a medida que la red cambia.</p> <p>Incluso despu√©s de establecer una relaci√≥n de vecinos o adyacencia, los routers seguir√°n enviando mensajes de saludo a intervalos regulares, seg√∫n lo determinado por el temporizador de saludo, que es de 10 segundos por defecto. El prop√≥sito de estos mensajes de saludo es mantener las relaciones con los vecinos. Si un router deja de recibir mensajes de saludo de un vecino, lo eliminar√° de la tabla de vecinos; esto se determina por el temporizador de inactividad, que es de 40 segundos por defecto. Esto significa que un router eliminar√° a un vecino si no ha recibido un mensaje <code>hello</code> de este durante los √∫ltimos 40 segundos.</p>","path":["Enrutamiento","OSPF (Open Shortest Path First)"],"tags":[]},{"location":"ospf/#tipos-de-red-ospf","level":3,"title":"Tipos de red OSPF","text":"<p>OSPF utiliza una configuraci√≥n de interfaz denominada network type para determinar su comportamiento en una red espec√≠fica. En este contexto, una red es una conexi√≥n entre dos o m√°s routers (un segmento). El tipo de red influye en aspectos como los temporizadores de mensajes OSPF, la elecci√≥n de un DR y un BDR, y si todas las relaciones de vecinos se convertir√°n en adyacencias completas.</p> <p>Existen varios tipos de redes OSPF: de difusi√≥n, multiacceso sin difusi√≥n (NBMA), punto a punto, punto a multipunto, punto a multipunto sin difusi√≥n y loopback. Esta tabla resume estos dos tipos de red.</p> Broadcast Point-to-point DR/BDR elegido Sin DR/BDR Establecer adyacencia completa solo con DR y BDR Establecer adyacencia completa Vecinos descubiertos din√°micamente Vecinos descubiertos din√°micamente Temporizadores predeterminados: hello = 10, dead = 40 Temporizadores predeterminados: hello = 10, dead = 40 <p>Las dos caracter√≠sticas comunes de estos tipos de red son la detecci√≥n din√°mica de vecinos y los temporizadores predeterminados. Al enviar mensajes de saludo desde interfaces compatibles con OSPF, los routers pueden detectar din√°micamente qu√© vecinos est√°n conectados a la interfaz, en lugar de requerir que un administrador configure manualmente las direcciones IP de los vecinos (como se requiere en algunos tipos de red OSPF).</p> <p>El temporizador de saludo predeterminado en ambos tipos de red es de 10 segundos, por lo que las interfaces env√≠an mensajes de saludo a intervalos de 10 segundos. El temporizador de inactividad predeterminado es de 40 segundos, por lo que un vecino se elimina de la tabla de vecinos si no se recibe ning√∫n mensaje de saludo durante 40 segundos. Otros tipos de red utilizan temporizadores predeterminados m√°s largos, de 30 y 120 segundos.</p> <p>Nota</p> <p>Si el router detecta una falla de enlace f√≠sico (lo que provoca que la interfaz pase a estado inactivo), OSPF eliminar√° inmediatamente al vecino, sin necesidad de esperar a que finalice la cuenta regresiva del temporizador de inactividad. Este temporizador solo es relevante si la interfaz permanece activa, pero el router deja de recibir mensajes de saludo del vecino (por cualquier motivo).</p>","path":["Enrutamiento","OSPF (Open Shortest Path First)"],"tags":[]},{"location":"ospf/#tipo-de-red-de-broadcast","level":4,"title":"Tipo de red de broadcast","text":"<p>Broadcast es el tipo de red OSPF predeterminado para las interfaces Ethernet (de todas las velocidades: FastEthernet, GigabitEthernet, etc.). Puede confirmarse con el comando <code>show ip ospf interface</code>, como en el siguiente ejemplo:</p> <pre><code>R1# show ip ospf interface g0/0\nGigabitEthernet0/0 is up, line protocol is up \n  Internet Address 10.0.0.1/30, Area 0, Attached via Network Statement\n  Process ID 1, Router ID 172.16.1.1, Network Type BROADCAST, Cost: 1\n. . .\n</code></pre> <p>La principal caracter√≠stica definitoria del tipo de red de difusi√≥n es que un router designado (DR) y un router designado de respaldo (BDR) se eligen en el estado de vecino bidireccional; los dem√°s routers conectados al segmento se convierten en DROthers (generalmente se pronuncia DR-other). Mientras que el DR y el BDR establecen adyacencias completas con todos los routers del segmento, los DROthers solo establecen adyacencia completa con el DR y el BDR del segmento y permanecen vecinos en el estado bidireccional con otros DROthers; no intercambian LSA entre s√≠.</p> <p>El prop√≥sito de elegir un DR y un BDR es reducir la cantidad de tr√°fico OSPF en el segmento, requiriendo √∫nicamente que los routers intercambien LSA (en mensajes LSU) con el DR y el BDR del segmento. Abajo se muestra c√≥mo se reduce el n√∫mero de adyacencias (y, por lo tanto, los intercambios de LSA), lo que limita la cantidad de tr√°fico OSPF en el segmento y la cantidad de recursos utilizados en los routers.</p> <p></p> <p>Figura 11.  Seis routers est√°n conectados al mismo segmento de red. Sin el DR/BDR, se requerir√≠an 15 adyacencias OSPF (y 15 intercambios LSA). Con el DR/BDR, solo se requieren 9, lo que reduce la cantidad de tr√°fico OSPF.</p> <p>Nota</p> <p>Para dirigir los mensajes √∫nicamente al DR y al BDR, los DRothers env√≠an los paquetes a la direcci√≥n IP de multidifusi√≥n 224.0.0.6. Recuerdad las dos direcciones IP de multidifusi√≥n OSPF: 224.0.0.5 (todos los routers OSPF) y 224.0.0.6 (solo DR y BDR).</p> <p>Dependiendo de la cantidad de routers conectados al segmento, la funci√≥n DR/BDR de la red de difusi√≥n puede reducir considerablemente los recursos utilizados por OSPF en el segmento. Esto podr√≠a reducirse a√∫n m√°s seleccionando solo un DR, pero el BDR es importante para proporcionar estabilidad y resiliencia; si el DR falla por alguna raz√≥n, el BDR asume autom√°ticamente el nuevo DR.</p> <p>Ahora se muestra un ejemplo de AS OSPF con DR, BDR y DROthers etiquetados. Se ha de tener en cuenta que el DR y el BDR se eligen por segmento, no por √°rea. Por ejemplo, R2 es el DR para el segmento R1-R2, pero un DROther para el segmento R2-R3-R4-R5.</p> <p></p> <p>Figura 12.  Un AS OSPF compuesto por seis segmentos. La elecci√≥n de DR/BDR se realiza por segmento, no por √°rea. Los RID est√°n entre par√©ntesis.</p> <p>Las interfaces G0/1 de R1, R3, R4 y R5 en la figura de arriba est√°n etiquetadas como DR. Dado que no hay otros routers conectados a esos segmentos, no se realiza ninguna elecci√≥n de DR/BDR; los routers simplemente se declaran como DR para esos segmentos. Sin embargo, no se establecer√°n adyacencias ni se intercambiar√°n LSAs desde esas interfaces; DR es solo un t√≠tulo en este caso. Adem√°s, estas interfaces deben configurarse en modo pasivo, por lo que no se enviar√°n mensajes de saludo OSPF.</p> <p>El siguiente ejemplo muestra la salida de <code>show ip ospf neighbor</code> en R5. Como DR del segmento R2-R3-R4-R5, R5 tiene adyacencia completa con todos los dem√°s routers:</p> <pre><code>R5# show ip ospf neighbor\nNeighbor ID  Pri  State         Dead Time  Address   Interface\n172.16.1.2   1    FULL/DROTHER  00:00:34   10.0.0.1  GigabitEthernet0/0\n172.16.1.3   1    FULL/DROTHER  00:00:34   10.0.0.2  GigabitEthernet0/0\n172.16.1.4   1    FULL/BDR      00:00:38   10.0.0.3  GigabitEthernet0/0\n</code></pre> <p>Aunque la salida no indica expl√≠citamente que R5 es el DR, dado que ninguno de los otros tres routers conectados al segmento lo es, se puede concluir que R5 debe ser el DR del segmento. Confirmemos esto usando el mismo comando en R2:</p> <pre><code>R2# show ip ospf neighbor\nNeighbor ID  Pri  State         Dead Time  Address   Interface\n172.16.1.1   1    FULL/BDR      00:00:30   10.0.0.9  GigabitEthernet0/0\n\n172.16.1.3   1    2WAY/DROTHER  00:00:34   10.0.0.2  GigabitEthernet0/1\n\n172.16.1.4   1    FULL/BDR      00:00:30   10.0.0.3  GigabitEthernet0/1\n172.16.1.5   1    FULL/DR       00:00:31   10.0.0.4  GigabitEthernet0/1\n</code></pre> <p>Como se muestra en la salida, R5 es efectivamente el DR del segmento. Otro punto importante es que R2 y R3 no forman una adyacencia completa; como DROthers, permanecen vecinos en el estado bidireccional. Esto significa que no intercambian LSA entre s√≠.</p> <p>Nota</p> <p>Aunque los DROthers no intercambian LSA directamente entre s√≠, conocer√°n las LSA de cada uno a trav√©s del DR/BDR. Recuerdad que todos los routers en el √°rea OSPF deben tener la misma LSDB.</p> <p>A estas alturas, probablemente uno se pregunte c√≥mo se eligen los DR y los BDR. Los DR y los BDR se eligen seg√∫n los dos criterios siguientes:</p> <ul> <li>La m√°xima prioridad de interfaz</li> <li>El RID m√°s alto</li> </ul> <p>El router con la prioridad de interfaz m√°s alta se convertir√° en el DR del segmento, y el router con la segunda prioridad m√°s alta se convertir√° en el BDR. La prioridad de interfaz OSPF es un valor configurable (predeterminado: 1) que se puede configurar con el comando <code>ip ospf priority priority</code> en el modo de configuraci√≥n de interfaz.</p> <p>Nota</p> <p>Si deseamos asegurarnos de que un router nunca se convierta en DR o BDR de un segmento, se puede configurar <code>ip ospf priority 0</code> en su interfaz.</p> <p>En el ejemplo de la √∫ltima imagen, todas las interfaces ten√≠an la prioridad predeterminada de 1, por lo que se utiliz√≥ el segundo par√°metro para determinar el DR de cada segmento: el RID OSPF. Si las prioridades de las interfaces est√°n empatadas, el router con el RID m√°s alto se convertir√° en el DR (R5, 172.16.1.5) y el router con el segundo RID m√°s alto, en el BDR (R4, 172.16.1.4).</p> <p>Modifiquemos la prioridad de la interfaz de R2 G0/1 para probar la elecci√≥n de DR/BDR. En el siguiente ejemplo, se establece la prioridad de la interfaz de R2 G0/1 en 100 y se confirman los resultados:</p> <pre><code>R2(config)# interface g0/1\nR2(config-if)# ip ospf priority 100\nR2(config-if)# do show ip ospf interface g0/1\nGigabitEthernet0/1 is up, line protocol is up \n  Internet Address 10.0.0.1/29, Area 0, \n  Attached via Interface Enable\n  Process ID 1, Router ID 172.16.1.2, Network Type BROADCAST, Cost: 1\n. . .\n  Transmit Delay is 1 sec, State DROTHER, Priority 100\n. . .\nR2(config-if)# do show ip ospf neighbor\nNeighbor ID  Pri  State         Dead Time  Address   Interface\n172.16.1.1   1    FULL/BDR      00:00:30   10.0.0.9  GigabitEthernet0/0\n172.16.1.3   1    2WAY/DROTHER  00:00:34   10.0.0.2  GigabitEthernet0/1\n172.16.1.4   1    FULL/BDR      00:00:30   10.0.0.3  GigabitEthernet0/1\n172.16.1.5   1    FULL/DR       00:00:31   10.0.0.4  GigabitEthernet0/1\n</code></pre> <p>Aunque R2 G0/1 ahora tiene la m√°xima prioridad del segmento, R5 y R4 siguen siendo el DR y el BDR. Esto se debe a que, una vez elegidos, no ser√°n preempted (sus roles no se asumir√°n), incluso si se aumenta la prioridad de un router existente o si un router con mayor prioridad se conecta al segmento. Para que un DR o un BDR ceda su rol, se puede usar el comando <code>clear ip ospf process</code> para restablecer el proceso OSPF del router, como se hace en R5 en el siguiente ejemplo:</p> <pre><code>R5# clear ip ospf process\nReset ALL OSPF processes? [no]: yes\nR5# show ip ospf neighbor\nNeighbor ID  Pri  State         Dead Time  Address   Interface\n172.16.1.2   100  FULL/BDR      00:00:35   10.0.0.1  GigabitEthernet0/0\n172.16.1.3   1    2WAY/DROTHER  00:00:31   10.0.0.2  GigabitEthernet0/0\n172.16.1.4   1    FULL/DR       00:00:31   10.0.0.3  GigabitEthernet0/0\n</code></pre> <p>Tras reiniciar el proceso OSPF de R5, R4 (anteriormente el BDR) se convierte en el nuevo DR, y R2 en el nuevo BDR, a pesar de tener la m√°xima prioridad. Estos resultados revelan un punto importante sobre el funcionamiento del DR y el BDR: si el DR falla, los routers conectados al segmento no realizan una elecci√≥n para el nuevo DR. En su lugar, el BDR asume inmediatamente el rol de nuevo DR; por eso, R4 se convierte en el nuevo DR. A continuaci√≥n, se realiza una elecci√≥n para determinar el nuevo BDR; R2 gana esta elecci√≥n y se convierte en el nuevo BDR. Para que R2 sea el DR, habr√≠a que reiniciar el proceso OSPF de R4, lo que har√≠a que R2 (el BDR) asumiera inmediatamente el rol de R4.</p>","path":["Enrutamiento","OSPF (Open Shortest Path First)"],"tags":[]},{"location":"ospf/#tipo-de-red-punto-a-punto","level":4,"title":"Tipo de red punto a punto","text":"<p>Si bien la caracter√≠stica DR/BDR del tipo de red de difusi√≥n puede reducir la cantidad de recursos utilizados por OSPF, la elecci√≥n de un DR y un BDR extiende el tiempo que tardan los routers en establecer una adyacencia completa; si solo hay dos routers conectados al segmento, esto es innecesario e ineficiente.</p> <p>Una conexi√≥n punto a punto es un enlace directo entre dos routers. Cuando OSPF est√° habilitado en este enlace con el tipo de red predeterminado de difusi√≥n, un router se convierte en el DR y el otro, en el BDR. Sin embargo, estas designaciones no ofrecen ninguna ventaja en este caso, ya que ambos routers establecen una adyacencia completa.</p> <p>Nota</p> <p>El tipo de red punto a punto es el predeterminado en las interfaces serial, que sol√≠an ser comunes en las conexiones WAN. Debido a la mayor velocidad y el menor costo de la fibra √≥ptica Ethernet, las conexiones serial ahora se consideran una tecnolog√≠a obsoleta. Para usar este tipo de red en enlaces Ethernet, debe configurarse manualmente.</p> <p>Al usar el tipo de red punto a punto OSPF, eliminamos el proceso de selecci√≥n de DR/BDR, lo que permite a los routers establecer una adyacencia completa en menos tiempo. Este tipo de red est√° dise√±ado para conexiones directas entre dos routers y es la opci√≥n m√°s eficiente en estas situaciones. La siguiente imagen muestra una situaci√≥n en la que se debe configurar el tipo de red punto a punto. R1 y R2 tienen una conexi√≥n punto a punto, por lo que no es necesario seleccionar un DR ni un BDR.</p> <p></p> <p>La elecci√≥n de un DR y BDR en una conexi√≥n entre dos routers no es necesaria, por lo que el enlace R1‚ÄìR2 debe utilizar el tipo de red punto a punto.</p> <p>Para configurar el tipo de red punto a punto, se ha de utilizar el comando <code>ip ospf network point-to-point</code> en el modo de configuraci√≥n de interfaz. ¬°Hay que asegurarse de hacerlo en ambos lados de la conexi√≥n! En el siguiente ejemplo, se configura el tipo de red punto a punto en R1 G0/0 y R2 G0/0 y luego se confirma. Observamos que R1 y R2 establecen una adyacencia completa, pero ninguno es un DR ni un BDR, como lo indica el estado FULL/-:</p> <pre><code>R1(config)# interface g0/0\nR1(config-if)# ip ospf network point-to-point\n\nR2(config)# interface g0/0\nR2(config-if)# ip ospf network point-to-point\nR2(config-if)# do show ip ospf neighbor\nNeighbor ID  Pri  State         Dead Time  Address   Interface\n172.16.1.3   1    2WAY/DROTHER  00:00:35   10.0.0.2  GigabitEthernet0/1\n172.16.1.4   1    FULL/BDR      00:00:38   10.0.0.3  GigabitEthernet0/1\n172.16.1.5   1    FULL/DR       00:00:36   10.0.0.4  GigabitEthernet0/1\n172.16.1.1   0    FULL/  -      00:00:38   10.0.0.9  GigabitEthernet0/0\n</code></pre>","path":["Enrutamiento","OSPF (Open Shortest Path First)"],"tags":[]},{"location":"ospf/#requisitos-de-los-vecinos","level":3,"title":"Requisitos de los vecinos","text":"<p>Aunque los tipos de red punto a punto y de difusi√≥n OSPF permiten que los routers descubran vecinos de forma din√°mica, eso no garantiza que realmente se convertir√°n en vecinos; hay un conjunto de requisitos que deben cumplirse, incluidos varios par√°metros que deben coincidir (y uno que no debe coincidir):</p> <ul> <li>El n√∫mero de √°rea debe coincidir.</li> <li>La subred (direcci√≥n de red, m√°scara de red) debe coincidir.</li> <li>El proceso OSPF no estar shutdown.</li> <li>Los RID deben ser √∫nicos.</li> <li>Los temporizadores de hello y dead deben coincidir.</li> <li>La configuraci√≥n de autenticaci√≥n debe coincidir.</li> <li>La configuraci√≥n de MTU de IP debe coincidir.*</li> <li>El tipo de red debe coincidir.*</li> </ul> <p>Una discrepancia entre los dos √∫ltimos, que se ha marcado con asteriscos (*), no impedir√° que los routers se conviertan en vecinos, pero s√≠ que OSPF funcione correctamente. Analicemos estos requisitos uno por uno y veamos c√≥mo afecta OSPF. Utilizaremos una conexi√≥n simple entre dos routers: R1 (192.168.1.1/30) y R2 (192.168.1.2/30). En el siguiente ejemplo, se configura una discrepancia de n√∫mero de √°rea en R1 y R2, y no se convierten en vecinos OSPF. Tras corregir la discrepancia, el problema se resuelve:</p> <pre><code>R1(config-if)# ip ospf 1 area 0\n\nR2(config-if)# ip ospf 1 area 1\n*Jun  9 03:40:12.255: %OSPF-4-ERRRCV: \nReceived invalid packet: mismatched area ID from \nbackbone area from 192.168.1.1, GigabitEthernet0/0\nR2(config-if)# do show ip ospf neighbor\nR2(config-if)# ip ospf 1 area 0\nR2(config-if)# do show ip ospf neighbor\nNeighbor ID  Pri  State     Dead Time  Address      Interface\n192.168.1.1  1    FULL/BDR  00:00:37   192.168.1.1  GigabitEthernet0/0\n</code></pre> <p>En el siguiente ejemplo, se cambia la m√°scara de red de la interfaz de R2. Aunque no cambi√© la direcci√≥n IP, la simple discrepancia de la m√°scara de red hace que la adyacencia cambie de \"Completa\" a \"Inactiva\".</p> <pre><code>R2(config-if)# ip address 192.168.1.2 255.255.255.0\n*Jun  9 04:36:32.664: %OSPF-5-ADJCHG: Process 1, \nNbr 192.168.1.1 on GigabitEthernet0/0 from FULL to \nDOWN, Neighbor Down: Interface down or detached\nR2(config-if)# ip address 192.168.1.2 255.255.255.252\n*Jun  9 04:37:36.071: %OSPF-5-ADJCHG: Process 1, \nNbr 192.168.1.1 on GigabitEthernet0/0 from LOADING to \nFULL, Loading Done\n</code></pre> <p>El tercer requisito es que el proceso OSPF no debe estar en <code>shutdown</code>, lo que se refiere al comando que se puede usar en el modo de configuraci√≥n del router para deshabilitar OSPF, de forma similar a c√≥mo se usa el comando <code>shutdown</code> para deshabilitar una interfaz. Queda demostrado en el siguiente ejemplo:</p> <pre><code>R2(config)# router ospf 1\nR2(config-router)# shutdown\n*Jun  9 05:02:01.379: %OSPF-5-ADJCHG: Process 1, \nNbr 192.168.1.1 on GigabitEthernet0/0 from FULL to \nDOWN, Neighbor Down: Interface down or detached\nR2(config-router)# no shutdown\n*Jun  9 05:02:07.114: %OSPF-5-ADJCHG: Process 1, \nNbr 192.168.1.1 on GigabitEthernet0/0 from LOADING to \nFULL, Loading Done\n</code></pre> <p>El cuarto requisito es que los RID de los routers sean √∫nicos, es decir, el √∫nico par√°metro que no debe coincidir. En el siguiente ejemplo, modificamos el RID de R2 para que coincida con el de R1, restablecemos el proceso OSPF y no logran convertirse en vecinos. Eliminar la configuraci√≥n del RID de R2 soluciona el problema:</p> <pre><code>R2(config-router)# router-id 192.168.1.1\nR2(config-router)# do clear ip ospf process\nReset ALL OSPF processes? [no]: yes\n*Jun  9 05:06:09.209: %OSPF-5-ADJCHG: Process 1, \nNbr 192.168.1.1 on GigabitEthernet0/0 from FULL to \nDOWN, Neighbor Down: Interface down or detached    \n*Jun  9 05:06:11.679: %OSPF-4-DUP_RTRID_NBR: OSPF \ndetected duplicate router-id 192.168.1.1 from \n192.168.1.1 on interface GigabitEthernet0/0\nR2(config-router)# no router-id 192.168.1.1\n*Jun  9 05:06:29.284: %OSPF-5-ADJCHG: Process 1, \nNbr 192.168.1.1 on GigabitEthernet0/0 from LOADING to \nFULL, Loading Done\n</code></pre> <p>El quinto requisito es que los temporizadores de saludo y de inactividad coincidan. El temporizador de saludo predeterminado es de 10 segundos y el de inactividad, de 40 segundos, pero se pueden configurar con los comandos <code>ip ospf hello-interval seconds</code> e <code>ip ospf dead-interval seconds</code> en el modo de configuraci√≥n de interfaz. En el siguiente ejemplo, modifico el temporizador de saludo de R2, lo que provoca la inactividad de la adyacencia con R1:</p> <pre><code>R2(config)# interface g0/0\nR2(config-if)# ip ospf hello-interval 5\n*Jun  9 05:14:34.525: %OSPF-5-ADJCHG: Process 1, \nNbr 192.168.1.1 on GigabitEthernet0/0 from FULL to \nDOWN, Neighbor Down: Dead timer expired\nR2(config-if)# ip ospf hello-interval 10\n*Jun  9 05:17:25.749: %OSPF-5-ADJCHG: Process 1, \nNbr 192.168.1.1 on GigabitEthernet0/0 from LOADING to \nFULL, Loading Done\n</code></pre> <p>El sexto requisito es que la configuraci√≥n de autenticaci√≥n coincida. Puede configurar una contrase√±a para autenticar vecinos OSPF y garantizar que solo los routers previstos establezcan relaciones de vecindad. Se puede usar el comando <code>ip ospf authentication</code> en el modo de configuraci√≥n de interfaz para habilitar la autenticaci√≥n y el comando <code>ip ospf authentication-key password</code> para configurar la contrase√±a.</p> <p>El s√©ptimo requisito es que la configuraci√≥n de la unidad m√°xima de transmisi√≥n (MTU) IP de los routers coincida. Con anterioridad hemos mencionodo alguna vez de forma breve la MTU IP; √©sta determina el tama√±o m√°ximo de un paquete IPv4. Si bien una discrepancia en la MTU IP no impide que dos routers OSPF se conviertan en vecinos, no podr√°n establecer una adyacencia completa ni avanzar m√°s all√° de los estados ExStart/Exchange. Se puede modificar la MTU IP de una interfaz con el comando <code>ip mtu bytes</code> en el modo de configuraci√≥n de interfaz; la configuraci√≥n predeterminada en las interfaces Ethernet es de 1500 bytes.</p> <p>El requisito final es que los tipos de red OSPF coincidan. Este requisito es diferente a los dem√°s que hemos tratado hasta ahora: un router con el tipo de red de difusi√≥n y un router con el tipo de red punto a punto podr√°n establecer una adyacencia completa. Sin embargo, el problema radica en que los routers no podr√°n sincronizar sus LSDB; no aprender√°n las rutas del otro.</p> <p>En el siguiente ejemplo, configuramos una interfaz de loopback en R2 y habilito OSPF. Luego, configuramos el tipo de red punto a punto G0/0 en R2, lo que resulta en una discrepancia en el tipo de red: la interfaz de R1 sigue usando el tipo de red de difusi√≥n. A pesar de la discrepancia en el tipo de red, la tabla de vecinos OSPF de R2 muestra una adyacencia completa con R1. A continuaci√≥n, revisamos las tablas de vecinos y de enrutamiento de R1:</p> <pre><code>R2(config)# interface l0\nR2(config-if)# ip address 10.10.10.2 255.255.255.255\nR2(config-if)# ip ospf 1 area 0    \nR2(config-if)# interface g0/0\nR2(config-if)# ip ospf network point-to-point\nR2(config-if)# do show ip ospf neighbor\nNeighbor ID  Pri  State     Dead Time  Address      Interface\n192.168.1.2  1    FULL/  -  00:00:34   192.168.1.2  GigabitEthernet0/0\n\nR1# show ip ospf neighbor\nNeighbor ID  Pri  State    Dead Time   Address      Interface\n192.168.1.2  1    FULL/DR  00:00:34    192.168.1.2  GigabitEthernet0/0\nR1# show ip route ospf\n. . .\n</code></pre> <p>Las tablas de vecinos OSPF de R1 y R2 indican adyacencia completa, pero hay algo extra√±o: la salida de R2 muestra un estado FULL/ - (como se espera al usar el tipo de red punto a punto), pero la salida de R1 muestra FULL/DR; R1 cree que R2 es el DR. Adem√°s, aunque OSPF est√° activado en la interfaz de loopback de R2, la tabla de enrutamiento de R1 no muestra ninguna ruta a la direcci√≥n de la interfaz (10.10.10.2/32). A pesar de lograr la adyacencia completa, R1 y R2 no pudieron sincronizar sus LSDB. La soluci√≥n es asegurar que ambos lados de la conexi√≥n usen el mismo tipo de red, ya sea de difusi√≥n o punto a punto.</p>","path":["Enrutamiento","OSPF (Open Shortest Path First)"],"tags":[]},{"location":"ospf/#tipos-de-lsa","level":2,"title":"Tipos de LSA","text":"<p>Los routers OSPF comparten informaci√≥n de enrutamiento mediante el env√≠o de mensajes LSU, que contienen LSA. Existen varios tipos de LSA, cada uno con su propia finalidad, pero para el examen CCNA, debe conocer tres:</p> <ul> <li>Tipo 1 (LSA de router): generado por todos los routers, este LSA describe los enlaces del router.</li> <li>Tipo 2 (LSA de red): generada por el DR de una red de difusi√≥n, esta LSA enumera todos los routers en el segmento.</li> <li>Tipo 5 (LSA externa AS): generada por ASBR, esta LSA anuncia rutas a redes externas (es decir, una ruta predeterminada a Internet).</li> </ul> <p>Se muestra el AS OSPF que analizamos con anterioridad modificado con una conexi√≥n a Internet, la cual R1 anuncia con <code>default-information originate</code>. Se observa el contenido de la LSDB, compartida por los cinco routers.</p> <p></p> <p>Figura 13.  Un AS OSPF y el contenido de su LSDB. Cada router anuncia una LSA de tipo 1 (router). R5, como DR del segmento R2-R3-R4-R5, anuncia una LSA de tipo 2 (red). R1, como ASBR, anuncia una LSA de tipo 5.</p> <p>Nota</p> <p>R3, R4 y R5 no anuncian una LSA de tipo 2 para sus interfaces G0/1. Como se mencion√≥ anteriormente, al no tener vecinos en esas interfaces, son DR solo de nombre.</p> <p>Para ver la LSDB de OSPF, utilizaremos el comando <code>show ip ospf database</code>. El resultado de este comando debe ser el mismo en todos los routers; todos deben tener las mismas LSA en su LSDB. En el siguiente ejemplo, se utilizs el comando en el R1. √önicamente tened en cuenta que cada router anuncia una LSA de tipo 1, el R5 anuncia una √∫nica LSA de tipo 2 y el R1 anuncia una √∫nica LSA de tipo 5.</p> <pre><code>R1# show ip ospf database\n           OSPF Router with ID (172.16.1.1) (Process ID 1)\n             Router Link States (Area 0)\nLink ID      ADV Router   Age    Seq#         Checksum   Link count\n172.16.1.1   172.16.1.1   1851   0x80000008   0x0015D5   3\n172.16.1.2   172.16.1.2   1852   0x8000000A   0x003688   4\n172.16.1.3   172.16.1.3   1825   0x80000014   0x002510   3\n172.16.1.4   172.16.1.4   1824   0x80000018   0x0052D9   3\n172.16.1.5   172.16.1.5   1824   0x80000015   0x008D9C   3\n\n             Net Link States (Area 0)\nLink ID      ADV Router   Age    Seq#         Checksum\n10.0.0.4     172.16.1.5   1824   0x8000000E   0x00B89D\n\n             Type-5 AS External Link States\nLink ID      ADV Router   Age    Seq#         Checksum   Tag\n0.0.0.0      172.16.1.1   1850   0x80000001   0x009B58   1\n</code></pre>","path":["Enrutamiento","OSPF (Open Shortest Path First)"],"tags":[]},{"location":"ospf/#resumen","level":2,"title":"Resumen","text":"<ul> <li>Se utilizan dos versiones de OSPF: OSPFv2 (para IPv4) y OSPFv3 (principalmente para IPv6).</li> <li>OSPF utiliza el algoritmo Shortest Path First (SPF), tambi√©n llamado algoritmo de Dijkstra.</li> <li>Los routers OSPF pasan por tres pasos principales: formar relaciones de vecinos, intercambiar informaci√≥n de enrutamiento y calcular rutas.</li> <li>Los routers OSPF intercambian informaci√≥n de enrutamiento mediante anuncios de estado de enlace (LSA), organizados en la base de datos de estado de enlace (LSDB). El proceso de enviar LSA a todos los dem√°s routers en la misma √°rea OSPF se denomina inundaci√≥n de LSA.</li> <li>Una red OSPF se puede dividir l√≥gicamente en √°reas. Todos los routers en un √°rea OSPF comparten la misma LSDB. El √°rea 0 es la red troncal a la que deben conectarse todas las dem√°s √°reas.</li> <li>En redes grandes, OSPF multi√°rea ofrece ventajas: los LSDB m√°s peque√±os ocupan menos recursos de memoria, el algoritmo SPF requiere menos tiempo y recursos de CPU para calcular rutas, y los cambios y la inestabilidad de la red quedan aislados en una sola √°rea.</li> <li>Un router interno tiene todas las interfaces habilitadas para OSPF en la misma √°rea. Un router troncal tiene al menos una interfaz en el √°rea 0. Un router de borde de √°rea (ABR) conecta una (o m√°s) √°reas al √°rea 0. Un router de borde de sistema aut√≥nomo (ASBR) conecta el AS OSPF a redes externas.</li> <li>Las rutas intra√°rea son rutas a destinos en un √°rea a la que el router est√° conectado. Las rutas inter√°rea son rutas a destinos en un √°rea a la que el router no est√° conectado. Las rutas externas son rutas a destinos fuera del sistema aut√≥nomo OSPF.</li> <li>La m√©trica de OSPF se llama costo, y el costo de una ruta es el costo acumulativo de cada interfaz desde la que se debe enviar un paquete para llegar al destino.</li> <li>El costo de un enlace se calcula dividiendo el ancho de banda de referencia (predeterminado: 100 Mbps) entre el ancho de banda del enlace. Los valores menores a 1 se asignan como 1, lo que significa que los enlaces con un ancho de banda de 100 Mbps o superior tienen un costo de 1 por defecto.</li> <li>Se puede cambiar el ancho de banda de referencia con el comando auto-cost reference-bandwidth mbps en el modo de configuraci√≥n del router.</li> <li>Se puede modificar el costo de un enlace con ip ospf cost cost en cada interfaz o modificando el ancho de banda de las interfaces con bandwidth kbps.</li> <li>Utilizremos <code>show ip ospf interface brief</code> para ver las interfaces habilitadas para OSPF.</li> <li>El ID del proceso OSPF se especifica con el comando <code>router ospf process-id</code> y es significativo a nivel local; no tiene que coincidir entre routers.</li> <li>Utilizamos <code>show ip protocols</code> para ver informaci√≥n sobre los protocolos de enrutamiento en el router, como el RID OSPF, las interfaces habilitadas para OSPF, etc.</li> <li>El ID de router OSPF (RID) de cada router debe ser √∫nico. Se determina en el siguiente orden: (1) configuraci√≥n manual con el comando router-id, (2) direcci√≥n IP m√°s alta en una interfaz de loopback y (3) direcci√≥n IP m√°s alta en una interfaz f√≠sica.</li> <li>Una interfaz de loopback es una interfaz virtual que no depende del estado de una interfaz f√≠sica espec√≠fica. Podemos crear una interfaz de loopback con el comando <code>interface loopback numbe</code>r y configurar una direcci√≥n IP como si fuera una interfaz f√≠sica.</li> <li>Adem√°s del comando de red, puede activar OSPF en las interfaces con el comando ip ospf process-id area area en el modo de configuraci√≥n de interfaz.</li> <li>Una interfaz pasiva est√° habilitada para OSPF pero no env√≠a mensajes de saludo OSPF.</li> <li>Para configurar una interfaz pasiva, utilizamos <code>passive-interface interface-name</code> en el modo de configuraci√≥n del router o <code>passive-interface predeterminado</code> y luego <code>no passive-interface interface-name</code> para hacer que interfaces espec√≠ficas sean no pasivas.</li> <li>Utilice la informaci√≥n predeterminada que se origina en el modo de configuraci√≥n del router para hacer que un router anuncie su ruta predeterminada a sus vecinos OSPF (convirti√©ndolo en un ASBR).</li> <li>OSPF utiliza cinco tipos de mensajes: hello, descripci√≥n de base de datos (DBD), solicitud de estado de enlace (LSR), actualizaci√≥n de estado de enlace (LSU) y reconocimiento de estado de enlace (LSAck).</li> <li>Los mensajes de saludo se utilizan para el descubrimiento y mantenimiento de vecinos. Los DBD proporcionan un resumen de la LSDB del router. Los LSR solicitan LSA espec√≠ficos a un vecino. Las LSU env√≠an LSA espec√≠ficos a un vecino. Los LSAcks confirman la recepci√≥n de una LSU.</li> <li>Los mensajes de saludo OSPF se env√≠an a la direcci√≥n IPv4 de multidifusi√≥n 224.0.0.5. Esta direcci√≥n se utiliza para enviar mensajes a todos los routers OSPF del segmento.</li> <li>Hay siete estados vecinos OSPF: Inactivo, Inicial, Bidireccional, ExStart, Intercambio, Cargando y Completo.</li> <li>Los routers OSPF en el estado bidireccional son vecinos pero a√∫n no han intercambiado LSA.</li> <li>Los routers en estado completo son adyacentes o completamente adyacentes; tienen una adyacencia o adyacencia total. Han intercambiado LSA y sincronizado sus LSDB.</li> <li>Utilizamos <code>show ip ospf neighbor</code> para ver informaci√≥n sobre los vecinos OSPF.</li> <li>OSPF utiliza una configuraci√≥n de interfaz denominada tipo de red para determinar c√≥mo se comporta OSPF en una red particular (un segmento, un enlace entre uno o m√°s routers).</li> <li>Utilice <code>show ip ospf interface interface</code> para ver detalles sobre una interfaz en particular.</li> <li>Las interfaces Ethernet utilizan el tipo de red de difusi√≥n por defecto. Este tipo de red permite que los vecinos se descubran din√°micamente y utiliza estos temporizadores predeterminados: hello = 10, dead = 40.</li> <li>Los routers OSPF eligen un router designado (DR) y un router designado de respaldo (BDR) en cada segmento de red de difusi√≥n. Los routers restantes son DROthers. La elecci√≥n de DR/BDR se realiza en el estado bidireccional.</li> <li>Todos los routers del segmento establecen una adyacencia completa con el DR/BDR, pero los DROthers siguen siendo vecinos en el estado bidireccional entre s√≠.</li> <li>El DR y el BDR se determinan utilizando (1) la prioridad de interfaz m√°s alta o (2) el RID m√°s alto. La prioridad de interfaz predeterminada es 1. Se puede configurar con la prioridad IP OSPF.</li> <li>Aumentar la prioridad de interfaz/RID de un router o conectar un nuevo router con una prioridad de interfaz/RID m√°s alta no har√° que el router preempte el DR/BDR. Para que el DR o el BDR abandonen su funci√≥n, utilice el proceso <code>clear ip ospf</code>.</li> <li>Si se pierde el DR, el BDR asume inmediatamente su papel y se celebran elecciones para el nuevo BDR.</li> <li>El tipo de red punto a punto es ideal para conexiones entre dos routers. Los routers establecen una adyacencia completa sin una elecci√≥n de DR/BDR. Utilizamos <code>ip ospf network point-to-point</code> en el modo de configuraci√≥n de interfaz para configurar este tipo de red.</li> <li>Para que los routers se conviertan en vecinos OSPF, el proceso OSPF no debe estar apagado, los RID deben ser √∫nicos y los siguientes par√°metros deben coincidir: n√∫mero de √°rea, subred, temporizadores de saludo/muerte, configuraci√≥n de autenticaci√≥n, configuraci√≥n de MTU de IP y tipo de red.</li> <li>Si la configuraci√≥n de la MTU de IP no coincide, los routers se quedar√°n bloqueados en los estados ExStart/Exchange. Si el tipo de red no coincide, los routers establecer√°n una adyacencia completa, pero no sincronizar√°n sus LSDB.</li> <li>Hay varios tipos de LSA, incluido el tipo 1 (LSA de router), el tipo 2 (LSA de red) y el tipo 5 (LSA externa AS).<ul> <li>Tipo 1 (LSA de router): generado por todos los routers, este LSA describe los enlaces del router.</li> <li>Tipo 2 (LSA de red): generada por el DR de una red de difusi√≥n, esta LSA enumera todos los routers en el segmento.</li> <li>Tipo 5 (LSA externa AS): generada por ASBR, esta LSA anuncia rutas a redes externas (es decir, una ruta predeterminada a Internet).</li> </ul> </li> </ul>","path":["Enrutamiento","OSPF (Open Shortest Path First)"],"tags":[]},{"location":"routers_y_rutas_estaticas/","level":1,"title":"Enrutamiento est√°tico","text":"<p>En esta unidad vamos a tratar los siguientes puntos:</p> <ul> <li>C√≥mo los hosts finales env√≠an paquetes IP a destinos locales y remotos</li> <li>El proceso de enrutamiento</li> <li>Lectura e interpretaci√≥n de la tabla de enrutamiento de un router</li> <li>Configuraci√≥n de rutas est√°ticas en un router</li> <li>Uso de rutas predeterminadas para proporcionar conectividad a Internet</li> </ul> <p>Estos aspectos aspectos tienen cierta correspondencia con los siguientes puntos del CCNA:</p> <ol> <li>Interpretar los componentes de una tabla de enrutamiento</li> <li>Determinar c√≥mo un router toma una decisi√≥n de reenv√≠o (forwarding) por defecto</li> <li>Configurar y verificar el enrutamiento est√°tico IPv4 e IPv6</li> </ol> <p>El t√©rmino enrutamiento puede referirse a dos procesos diferentes: el proceso mediante el cual los routers crean su tabla de enrutamiento (una base de datos de destinos conocidos y c√≥mo reenviar paquetes hacia ellos) y el proceso de reenv√≠o de paquetes.</p> <p>Abordaremos pues ambos aspectos del enrutamiento.</p>","path":["Enrutamiento","Enrutamiento est√°tico"],"tags":[]},{"location":"routers_y_rutas_estaticas/#como-envian-paquetes-los-hosts-finales","level":2,"title":"C√≥mo env√≠an paquetes los hosts finales","text":"<p>Antes de examinar los detalles de c√≥mo los routers reenv√≠an paquetes IP, echemos un ojo a los hosts finales que se env√≠an dichos paquetes entre s√≠. Despu√©s de que un host prepare un paquete para enviarlo a otro, debe encapsularlo en una trama. Si bien nos centramos en el enrutamiento, es decir un proceso de Capa 3, ¬°no nos olvidemos de la Capa 2! Los paquetes nunca se env√≠an por cable (u ondas de radio) sin estar encapsulados en una trama.</p> <p>La direcci√≥n MAC de destino de la trama depende de la direcci√≥n IP de destino del paquete. Si el paquete est√° destinado a un host en la misma red que el emisor, la direcci√≥n MAC de destino ser√° la del host de destino; en este caso, no se necesita un router porque ya sabemos que el router sirve para conectar redes diferentes.</p> <p>La imagen de abajo muestra este proceso cuando el PC1 env√≠a un paquete a el PC2. Las direcciones IP y MAC de destino son ambas de el PC2; No es necesario que R1 enrute el paquete porque el origen y el destino est√°n en la misma red (la red 192.168.1.0/24).</p> <p></p> <p>El PC1 (192.168.1.11) env√≠a un paquete al PC2 (192.168.1.12). Dado que ambos se encuentran en la misma red (192.168.1.0/24), el PC1 encapsula el paquete en una trama dirigida a la direcci√≥n MAC de el PC2. El PC1 no necesita enviar el paquete a R1 para su enrutamiento.</p> <p>Este diagrama presupone que el PC1 ya conoce la direcci√≥n MAC de el PC2; de lo contrario, primero enviar√° una solicitud ARP para obtenerla, tal y como ya hemos visto anteriormente en el curso.</p> <p>Nota</p> <p>Un icono de nube, como el que se muestra en la figura anterior, se utiliza a menudo para representar Internet, aunque no siempre. Un icono de nube puede utilizarse para obviar elementos que no son relevantes para el diagrama. La nube en la figura indica que R1 se conecta a otra red, cuyos detalles no son relevantes para el diagrama. Esa otra red podr√≠a ser internet o otra parte de la red de la misma empresa.</p> <p>Por otro lado, si un host final, como un PC, desea enviar un paquete a un destino fuera de su red local, debe enviarlo a su puerta de enlace predeterminada (el router que proporciona conectividad a otras redes,  tambi√©n conocido como gateway). En la imagen de abajo, R1 es la puerta de enlace predeterminada de la red 192.168.1.0/24.</p> <p>Para que PC1 y PC2 env√≠en paquetes a destinos fuera de 192.168.1.0/24, deben encapsular el paquete en una trama dirigida a la direcci√≥n MAC de la interfaz G0/0 de R1.</p> <p>En la imagen se muestra c√≥mo PC1 env√≠a un paquete a PC3: encapsula el paquete en una trama dirigida a la direcci√≥n MAC de la interfaz G0/0 de R1. A continuaci√≥n, R1 reenv√≠a el paquete fuera de su interfaz G0/1, encapsulado en una nueva trama dirigida a la direcci√≥n MAC de PC3.</p> <p></p> <p>PC1 (192.168.1.11) env√≠a un paquete a PC3 (192.168.2.11). Dado que PC1 y PC3 se encuentran en redes separadas, PC1 env√≠a el paquete en una trama dirigida a la direcci√≥n MAC de su puerta de enlace predeterminada: la de la interfaz G0/0 de R1. R1 reenv√≠a el paquete desde su interfaz G0/1, encapsulado en una nueva trama dirigida a la direcci√≥n MAC de PC3.</p> <p>Este diagrama supone que PC1 ya conoce la direcci√≥n MAC G0/0 de R1; de lo contrario, PC1 enviar√° una solicitud ARP para obtenerla. Asimismo, R1 tambi√©n debe obtener la direcci√≥n MAC de PC3.</p> <p>Nota</p> <p>La direcci√≥n IP de la puerta de enlace predeterminada suele ser la primera direcci√≥n utilizable de la red. Por ejemplo, en la red 192.168.1.0/24, es 192.168.1.1, y en la red 192.168.2.0/24, es 192.168.2.1. Esto no tiene por qu√© ser as√≠, pero es una pr√°ctica muy com√∫n. Las direcciones IP de los ordenadores, por otro lado, son arbitrarias. En los ejemplos las direcciones IP de los ordenadores terminan en .11 y .12, pero por ning√∫n motivo concreto.</p> <p>¬øC√≥mo sabe el PC1 cu√°l es su puerta de enlace predeterminada?</p> <p>Un host final puede conocer la direcci√≥n IP de su puerta de enlace predeterminada de dos maneras. La primera es mediante la configuraci√≥n manual, en la que un administrador especifica manualmente la puerta de enlace predeterminada en cada dispositivo. Sin embargo, esto es muy poco com√∫n en dispositivos de usuario como los PC; suelen utilizar el segundo m√©todo (el Protocolo de Configuraci√≥n Din√°mica de Host o DHCP) para conocer autom√°ticamente informaci√≥n como la direcci√≥n IP de su puerta de enlace predeterminada, as√≠ como su propia direcci√≥n IP.</p> <p>En un dispositivo Windows, podemos usar el comando <code>ipconfig</code> en la aplicaci√≥n S√≠mbolo del sistema para ver informaci√≥n como la direcci√≥n IP del dispositivo, la m√°scara de red (Subnet Mask en la salida del comando) y la puerta de enlace predeterminada. El siguiente ejemplo muestra la salida de este comando en el PC1:</p> <pre><code>C:\\Users\\alumno&gt; ipconfig\n. . .\nEthernet adapter Local Area Connection:\n   Connection-specific DNS Suffix  . : \n   IPv4 Address. . . . . . . . . . . : 192.168.1.11\n   Subnet Mask . . . . . . . . . . . : 255.255.255.0\n   Default Gateway . . . . . . . . . : 192.168.1.1\n. . .\n</code></pre> <p>Nota</p> <p>La puerta de enlace predeterminada de un host se configura como una direcci√≥n IP, no como una direcci√≥n MAC. Para conocer la direcci√≥n MAC de la puerta de enlace predeterminada, el host debe enviar una solicitud ARP a su direcci√≥n IP.</p> <p>Hay un par de puntos principales que se deben tener en cuenta en esta secci√≥n: primero, para enviar un paquete a un destino en la misma red, un host encapsular√° el paquete (dirigido a la direcci√≥n IP del host de destino) en una trama dirigida a la direcci√≥n MAC del host de destino. El segundo punto es que, para enviar un paquete a un destino en una red diferente, el host emisor encapsular√° el paquete (dirigido a la direcci√≥n IP del host de destino) en una trama dirigida a la direcci√≥n MAC de la puerta de enlace predeterminada. En cualquier caso, se debe usar ARP para obtener la direcci√≥n MAC adecuada (la del host de destino o la de la puerta de enlace predeterminada).</p>","path":["Enrutamiento","Enrutamiento est√°tico"],"tags":[]},{"location":"routers_y_rutas_estaticas/#fundamentos-de-routing","level":2,"title":"Fundamentos de routing","text":"<p>En el apartado anterior hemos visto c√≥mo un host env√≠a paquetes a destinos fuera de su red local; env√≠a cada paquete en una trama dirigida a la direcci√≥n MAC de la puerta de enlace predeterminada.</p> <p>Ahora examinaremos c√≥mo la puerta de enlace predeterminada (un router) realiza su funci√≥n de reenv√≠o de paquetes entre redes, lo que se denomina enrutamiento. La imagen de m√°s abajo ofrece una descripci√≥n general de c√≥mo R1 reenv√≠a un paquete de PC1 a PC3.</p> <p>Nota</p> <p>La tabla de enrutamiento de R1 en la imagen est√° simplificada; examinaremos la tabla de enrutamiento completa de R1 m√°s adelante.</p> <p>Cuando un router recibe una trama destinada a su propia direcci√≥n MAC, la desencapsula para examinar el paquete que contiene (si el destino no es su propia direcci√≥n MAC, la descarta). Si la direcci√≥n IP de destino del paquete es su propia direcci√≥n IP, contin√∫a desencapsulando el mensaje; es un mensaje para el router.</p> <p>Sin embargo, si la direcci√≥n IP de destino del paquete no es su propia direcci√≥n IP, el router intentar√° enrutarlo hacia su destino. Para ello, busca la direcci√≥n IP de destino del paquete en su tabla de enrutamiento para encontrar una ruta adecuada. Si encuentra una ruta adecuada, reenv√≠a el paquete seg√∫n esa ruta. De lo contrario, lo descarta.</p> <p></p> <p>En la figura de arriba, R1 recibe un paquete de PC1 y lo reenv√≠a a PC3:</p> <ol> <li>R1 recibe una trama en su interfaz G0/0. La trama est√° dirigida a la direcci√≥n MAC de R1, por lo que examina el paquete que contiene.</li> <li>R1 busca la direcci√≥n IP de destino del paquete en su tabla de enrutamiento. 192.168.2.11 pertenece a la red 192.168.2.0/24, por lo que selecciona esa ruta para reenviarlo. </li> <li>R1 encapsula el paquete en una nueva trama destinada a la direcci√≥n MAC de PC3 y lo reenv√≠a fuera de la interfaz especificada por la ruta (G0/1).</li> </ol>","path":["Enrutamiento","Enrutamiento est√°tico"],"tags":[]},{"location":"routers_y_rutas_estaticas/#la-tabla-de-enrutamiento","level":2,"title":"La tabla de enrutamiento","text":"<p>La tabla de enrutamiento de un router es una base de datos de destinos conocidos por el router. Puede considerarse como un conjunto de instrucciones:</p> <ul> <li>Para enviar un paquete al destino X, reenv√≠alo al siguiente salto Y.</li> <li>O bien, si el destino est√° en una red conectada directamente, reenv√≠alo directamente al destino.</li> <li>O bien, si el destino es la direcci√≥n IP del router, contin√∫a desencapsulando el mensaje (no reenv√≠es el paquete).</li> </ul> <p>El ejemplo que ve√≠amos en la figura anterior es un ejemplo del segundo tipo de instrucci√≥n: el destino del paquete (PC3, 192.168.2.11) se encuentra en una red conectada directamente a R1 (192.168.2.0/24), por lo que R1 reenv√≠a el paquete directamente al destino (encapsul√°ndolo en una trama dirigida a PC3).</p> <p>A diferencia de los switches, que pueden generar su tabla de direcciones MAC autom√°ticamente sin necesidad de configuraci√≥n, la tabla de enrutamiento de un router estar√° vac√≠a por defecto; no podr√° reenviar paquetes.</p> <p>El siguiente ejemplo muestra la tabla de enrutamiento de R1 antes de cualquier configuraci√≥n. El comando para ver la tabla de enrutamiento es <code>show ip route</code>:</p> <pre><code>R1# show ip route\nCodes: L - local, C - connected, S - static, R - RIP, M - mobile, B - BGP\n       D - EIGRP, EX - EIGRP external, O - OSPF, IA - OSPF inter area\n       N1 - OSPF NSSA external type 1, N2 - OSPF NSSA external type 2\n       E1 - OSPF external type 1, E2 - OSPF external type 2\n       i - IS-IS, su - IS-IS summary, L1 - IS-IS level-1, L2 - IS-IS level-2\n       ia - IS-IS inter area, * - candidate default, U - per-user static route\n       o - ODR, P - periodic downloaded static route, H - NHRP, l - LISP\n       a - application route\n       + - replicated route, % - next hop override, p - overrides from PfR\n\nGateway of last resort is not set\n</code></pre> <p>Sin ninguna configuraci√≥n, la salida muestra algunos c√≥digos que representan los diferentes tipos de ruta que podr√≠an aparecer en la tabla de enrutamiento. Finalmente, Gateway of last resort is not set indica que R1 no tiene una ruta predeterminada, algo que abordaremos m√°s adelante.</p> <p>Configuremos R1 y veamos c√≥mo cambia la salida de <code>show ip route</code>. Primero, no configuraremos ninguna ruta; en lugar de eso, configuremos las direcciones IP de R1 y habiliaremos sus interfaces, como en el siguiente ejemplo:</p> <pre><code>R1# configure terminal\nR1(config)# interface g0/0\nR1(config-if)# ip address 192.168.1.1 255.255.255.0\nR1(config-if)# no shutdown\nR1(config-if)# interface g0/1\nR1(config-if)# ip address 192.168.2.1 255.255.255.0\nR1(config-if)# no shutdown\n</code></pre> <p>Las interfaces de R1 ahora est√°n configuradas seg√∫n los diagramas anteriores: 192.168.1.1/24 en G0/0 y 192.168.2.1/24 en G0/1. Ahora, examinemos de nuevo la tabla de enrutamiento de R1 y veamos qu√© ha cambiado (omitiendo algunos c√≥digos para ahorrar espacio):</p> <pre><code>R1# show ip route\nCodes: L - local, C - connected, S - static, R - RIP, M - mobile, B - BGP\n. . .\nGateway of last resort is not set\n      192.168.1.0/24 is variably subnetted, 2 subnets, 2 masks\nC        192.168.1.0/24 is directly connected, GigabitEthernet0/0\nL        192.168.1.1/32 is directly connected, GigabitEthernet0/0\n      192.168.2.0/24 is variably subnetted, 2 subnets, 2 masks\nC        192.168.2.0/24 is directly connected, GigabitEthernet0/1\nL        192.168.2.1/32 is directly connected, GigabitEthernet0/1\n</code></pre> <p>Con solo configurar las direcciones IP y habilitar las dos interfaces de R1, R1 ha inseratdo cuatro rutas en su tabla de enrutamiento: dos rutas conectadas (indicadas por el c√≥digo <code>C</code>) y dos rutas locales (indicadas por el c√≥digo <code>L</code>).</p> <p>Nota</p> <p>La l√≠nea <code>192.168.1.0/24 is variably subnetted, 2 subnets, 2 masks</code> no es una ruta. Esta afirmaci√≥n significa que en la tabla de enrutamiento hay dos rutas a subredes que encajan en la red de clase C 192.168.1.0/24, con dos m√°scaras de red diferentes (/24 y /32). Lo mismo aplica a la l√≠nea similar sobre 192.168.2.0/24. </p>","path":["Enrutamiento","Enrutamiento est√°tico"],"tags":[]},{"location":"routers_y_rutas_estaticas/#rutas-conectadas","level":3,"title":"Rutas conectadas","text":"<p>Una ruta conectada es una ruta a la red a la que est√° conectada una interfaz. Se a√±ade autom√°ticamente una ruta conectada a la tabla de enrutamiento por cada interfaz que tenga una direcci√≥n IP y est√© activa (se puede comprobar el estado de la interfaz con <code>show ip interface brief</code>). Por ejemplo, la interfaz G0/0 de R1 tiene la direcci√≥n IP 192.168.1.1/24, por lo que agrega autom√°ticamente una ruta a la red 192.168.1.0/24 a su tabla de enrutamiento.</p> <p>Una ruta conectada indicar√° que la red est√° conectada directamente y tambi√©n indicar√° a qu√© interfaz est√° conectada. Para ver solo las rutas conectadas en la tabla de enrutamiento de R1, en el siguiente ejemplo, filtro la salida usando la barra vertical <code>|</code> seguida de <code>include C</code> para mostrar solo las l√≠neas que incluyen <code>C</code>:</p> <pre><code>R1# show ip route | include C\nCodes: L - local, C - connected, S - static, R - RIP, M - mobile, B - BGP\nC        192.168.1.0/24 is directly connected, GigabitEthernet0/0\nC        192.168.2.0/24 is directly connected, GigabitEthernet0/1\n</code></pre> <p>Con estas rutas en su tabla de enrutamiento, R1 sabe que para reenviar un paquete a un host con una direcci√≥n IP en las redes 192.168.1.0/24 o 192.168.2.0/24, debe enviar el paquete desde la interfaz especificada en la ruta en una trama dirigida directamente al host de destino. Esto se vio en la imagen de m√°s arriba donde la direcci√≥n IP de destino del paquete era 192.168.2.11 (PC3), por lo que R1 reenvi√≥ el paquete desde la interfaz G0/1 en una trama dirigida a la direcci√≥n MAC de PC3.</p> <p>A modo de recordatorio r√°pido, la siguiente imagen muestra c√≥mo la ruta a 192.168.1.0/24 incluye todas las direcciones IP desde 192.168.1.0 hasta 192.168.1.255. La parte de red de la direcci√≥n de la ruta es fija, pero la parte del host puede ser cualquier n√∫mero de 8 bits.</p> <p></p> <p>Direcci√≥n IP y longitud del prefijo (expresada como m√°scara de red) de la ruta a 192.168.1.0/24. Debido a la longitud del prefijo /24, los primeros tres octetos son fijos (los bits no pueden cambiar). Sin embargo, el √∫ltimo octeto puede ser cualquier n√∫mero de 8 bits: .1, .11, .100, .179, etc. Esto significa que cualquier paquete con una direcci√≥n IP de destino que comience por 192.168.1 puede reenviarse mediante esta ruta.</p>","path":["Enrutamiento","Enrutamiento est√°tico"],"tags":[]},{"location":"routers_y_rutas_estaticas/#rutas-locales","level":3,"title":"Rutas locales","text":"<p>Una ruta local es una ruta a la direcci√≥n IP exacta configurada en la interfaz del router.</p> <p>Al igual que las rutas conectadas, se agrega autom√°ticamente una ruta local a la tabla de enrutamiento por cada interfaz que tenga una direcci√≥n IP y est√© activa. En el siguiente ejemplo, se utiliza <code>show ip route | include L</code> para ver solo las rutas locales de R1. Tened en cuenta que, al igual que las rutas conectadas, las rutas locales tambi√©n indican que X est√° conectado directamente, seguido de la interfaz:</p> <pre><code>R1# show ip route | include L\nCodes: L - local, C - connected, S - static, R - RIP, M - mobile, B - BGP\n. . .\nL        192.168.1.1/32 is directly connected, GigabitEthernet0/0\nL        192.168.2.1/32 is directly connected, GigabitEthernet0/1\n</code></pre> <p>Para especificar la direcci√≥n IP exacta de la interfaz, una ruta local utiliza una longitud de prefijo /32; todos los bits de la m√°scara de red se establecen en 1. Esto se aplica independientemente de la m√°scara de red configurada en la interfaz.</p> <p>Por ejemplo, aunque ambas interfaces de R1 tienen una longitud de prefijo /24, sus rutas locales son /32. Esto se debe a que una ruta local solo especifica una direcci√≥n IP. Como se mencion√≥ anteriormente, una ruta a 192.168.1.0/24 incluye todas las direcciones IP desde 192.168.1.0 hasta 192.168.1.255; dado que la longitud del prefijo es /24, el octeto final puede ser cualquier n√∫mero entre 0 y 255. Por otro lado, una ruta a 192.168.1.1/32 incluye solo 192.168.1.1, debido a su longitud de prefijo /32; todos los bits se consideran parte de la porci√≥n de red y no se pueden modificar. La figura de arriba muestra la direcci√≥n IP de R1 G0/0 con una longitud de prefijo /32 (escrita como una m√°scara de red).</p> <p>Una ruta local indica al router que los paquetes destinados a la direcci√≥n IP especificada en la ruta son para √©l mismo; debe continuar desencapsulando el mensaje y examinando su contenido. En este caso, el router no reenv√≠a el paquete, sino que lo recibe. La ruta local es necesaria para distinguir la direcci√≥n IP del router de otras direcciones IP en la red conectada. Si R1 solo tuviera una ruta conectada a 192.168.1.0/24, pero ninguna ruta local, reenviar√≠a los paquetes destinados a 192.168.1.1 desde su interfaz G0/0, en lugar de recibirlos.</p>","path":["Enrutamiento","Enrutamiento est√°tico"],"tags":[]},{"location":"routers_y_rutas_estaticas/#eleccion-de-rutas","level":2,"title":"Elecci√≥n de rutas","text":"<p>Cuando un router reenv√≠a un paquete, debe decidir qu√© ruta de su tabla de enrutamiento utilizar√° para reenviarlo, lo que se denomina selecci√≥n de ruta. Para determinar c√≥mo reenviar un paquete en particular, el router seleccionar√° la ruta coincidente m√°s espec√≠fica. Definamos este t√©rmino:</p> <ul> <li>Ruta coincidente: La direcci√≥n IP de destino del paquete forma parte de la red especificada en la ruta. De lo contrario, el paquete no se puede reenviar utilizando esta ruta.</li> <li>M√°s espec√≠fica: La ruta con la longitud de prefijo m√°s larga.</li> </ul> <p>Usemos un ejemplo para aclarar este concepto. La siguiente figura muestra el proceso de selecci√≥n de ruta cuando R1 recibe un paquete dirigido a 192.168.1.1. La direcci√≥n IP de destino del paquete coincide con dos rutas en la tabla de enrutamiento de R1, por lo que selecciona la m√°s espec√≠fica.</p> <p></p> <p>R1 recibe un paquete y seleccionar√° la mejor ruta para √©l:</p> <ol> <li>R1 recibe una trama en su interfaz G0/0. La MAC de destino es la suya, por lo que la desencapsula y examina el paquete que contiene.</li> <li>La direcci√≥n IP de destino del paquete es 192.168.1.1. R1 realiza una b√∫squeda en la tabla de enrutamiento y descubre que dos rutas coinciden con la direcci√≥n IP de destino del paquete: la ruta conectada a 192.168.1.0/24 y la ruta local a 192.168.1.1/32. R1 selecciona la ruta m√°s espec√≠fica: 192.168.1.1/32.</li> <li>Dado que R1 selecciona una ruta local, recibe el paquete por s√≠ mismo; no lo reenv√≠a.</li> </ol> <p>Una ruta con un prefijo /24 incluye 256 direcciones IP diferentes. Por ejemplo, 192.168.1.0/24 incluye las rutas de 192.168.1.0 a 192.168.1.255. Por otro lado, una ruta con un prefijo /32 solo incluye una direcci√≥n IP, por lo que una ruta /32 es m√°s espec√≠fica que una ruta /24. De hecho, una ruta /32 es la m√°s espec√≠fica posible; si la direcci√≥n IP de destino de un paquete coincide con una ruta /32, esa ruta siempre se seleccionar√° para ese paquete, independientemente de cu√°ntas otras rutas coincidentes haya. </p> <p>¬øQu√© sucede si no hay ninguna ruta en la tabla de enrutamiento que coincida con la direcci√≥n IP de destino de un paquete? En ese caso, el router descartar√° el paquete; no inundar√° todos los puertos como lo hacen los switches con tramas unicast desconocidas.</p> <p>Un switch a veces inunda de tramas, pero un router nunca inunda de paquetes; reenv√≠a el paquete, lo recibe para s√≠ mismo o lo descarta. Esta tabla resume las acciones que un router puede realizar en un paquete:</p> Condiciones de coincidencia Acci√≥n del router La direcci√≥n IP de destino del paquete coincide con una o m√°s rutas no locales. Reenviar el paquete seg√∫n la ruta coincidente m√°s espec√≠fica La direcci√≥n IP de destino del paquete coincide con una ruta local. Recibir el paquete La direcci√≥n IP de destino del paquete no coincide con ninguna ruta. Descartar el paquete","path":["Enrutamiento","Enrutamiento est√°tico"],"tags":[]},{"location":"routers_y_rutas_estaticas/#rutas-estaticas","level":2,"title":"Rutas est√°ticas","text":"<p>El proceso de reenv√≠o de paquetes descrito en la secci√≥n anterior se denomina enrutamiento, pero el t√©rmino enrutamiento tambi√©n se utiliza para referirse a los procesos que utilizan los routers para aprender rutas. Adem√°s de las rutas conectadas y locales que un router inserta autom√°ticamente en su tabla de enrutamiento, existen dos m√©todos principales mediante los cuales los routers pueden aprender rutas:</p> <p>Enrutamiento din√°mico: Los routers utilizan protocolos de enrutamiento din√°mico para compartir informaci√≥n entre s√≠ y crear sus tablas de enrutamiento.</p> <p>Enrutamiento est√°tico: Un ingeniero/administrador configura manualmente las rutas en el router.</p> <p>Las rutas conectadas permiten al router reenviar paquetes a destinos en redes conectadas directamente a √©l, y las rutas locales permiten al router recibir paquetes destinados a sus propias direcciones IP. Sin embargo, para reenviar paquetes a destinos que no est√°n en redes conectadas directamente, el router debe aprender de esos destinos mediante uno de los m√©todos mencionados anteriormente (abordaremos el enrutamiento din√°mico en los cap√≠tulos 17 y 18).</p> <p>Al reenviar un paquete a un destino que no est√° conectado directamente al router, este debe encapsularlo en una trama dirigida a la direcci√≥n MAC del siguiente salto, que corresponde al siguiente router en la ruta hacia el destino. Aqu√≠ se puede ver este proceso:</p> <p></p> <p>PC1 env√≠a un paquete a PC3 a trav√©s de R1, R2 y R3:</p> <ol> <li>PC1 env√≠a el paquete en una trama a R1 G0/1. R1 lo recibe y realiza una b√∫squeda en la tabla de enrutamiento.</li> <li>R1 reenv√≠a el paquete en una trama a R2 G0/0. R2 lo recibe y realiza una b√∫squeda en la tabla de enrutamiento.</li> <li>R2 reenv√≠a el paquete en una trama a la MAC de R3 G0/0. R3 recibe el paquete y realiza una b√∫squeda en la tabla de enrutamiento. (4) R3 reenv√≠a el paquete en una trama a PC3, que lo recibe y lo procesa.</li> </ol> <p>La imagen anterior muestra c√≥mo los routers reenv√≠an paquetes hacia destinos remotos (no conectados directamente). </p> <p>Sin embargo, los routers no tienen estas rutas en sus tablas de enrutamiento por defecto; estas rutas deben configurarse manualmente. Sin configurar ninguna ruta est√°tica, si R1 recibe un paquete de PC1 con destino a 192.168.3.11, no encontrar√° ninguna ruta coincidente al realizar la b√∫squeda en la tabla de enrutamiento. No tendr√° m√°s remedio que descartar el paquete. La siguiente tabla enumera las redes que cada router del ejemplo anterior reconoce sin configurar rutas est√°ticas.</p> Router Redes conocidas Redes desconocidas R1 192.168.1.0/24192.168.12.0/24 192.168.3.0/24192.168.23.0/24 R2 192.168.12.0/24192.168.23.0/24 192.168.1.0/24192.168.3.0/24 R3 192.168.3.0/24192.168.23.0/24 192.168.1.0/24192.168.12.0/24 <p>Dado el objetivo de habilitar la comunicaci√≥n bidireccional entre PC1 y PC3, ¬øqu√© rutas debemos configurar? Al observar la tabla, se podr√≠a suponer que debemos configurar seis rutas para que cada router conozca todas las redes dentro de la red principal.</p> <p>Sin embargo, para reenviar paquetes entre dos hosts, cada router solo necesita rutas a las redes de los hosts que se comunican (PC1 y PC3). R1, por ejemplo, no necesita conocer la red entre R2 y R3 (192.168.23.0/24); R1 solo necesita saber que para reenviar un paquete a un destino en 192.168.3.0/24, debe reenviarlo a R2. La Figura de m√°s abajo demuestra este concepto: si configuramos una ruta a 192.168.3.0/24 en R1, con la direcci√≥n IP de R2 especificada como el siguiente salto, R1 podr√° reenviar el paquete a R2. No necesita saber los detalles de la ruta que tomar√° el paquete despu√©s de R2; solo necesita saber que R2 es el siguiente salto.</p> <p>R1 reenv√≠a un paquete destinado a 192.168.3.11 (PC3). R1 ‚Äã‚Äãtiene una ruta est√°tica a 192.168.3.0/24 a trav√©s de 192.168.12.2 (R2). R1 ‚Äã‚Äãsabe que para reenviar un paquete hacia la red 192.168.3.0/24, debe reenviarlo a R2. R1 desconoce los detalles de la ruta que tomar√° el paquete despu√©s de R2, y no est√° obligado a conocerlos.</p> <p>En resumen, cada router necesita una ruta a 192.168.3.0/24 para poder reenviar paquetes de PC1 a PC3 y una ruta a 192.168.1.0/24 para poder reenviar paquetes de PC3 a PC1. El R1 ya tiene una ruta conectada a 192.168.1.0/24, y el R3 ya tiene una ruta conectada a 192.168.3.0/24. La Tabla 9.3 enumera las rutas est√°ticas que debemos configurar para habilitar la comunicaci√≥n bidireccional entre el PC1 y el PC3.</p> Router Rutas necesarias Pr√≥ximo salto R1 192.168.3.0/24 192.168.12.2 (R2 G0/0) R2 192.168.1.0/24 192.168.12.1 (R1 G0/0) R2 192.168.3.0/24 192.168.23.2 (R3 G0/0) R3 192.168.1.0/24 192.168.23.1 (R2 G0/1) <p>Nota</p> <p>En este ejemplo, nos referimos a las rutas necesarias para habilitar la comunicaci√≥n bidireccional entre el PC1 y el PC3. Si bien no es necesario para tal fin, no hay problema en configurar una ruta a 192.168.23.0/24 en el R1 y una ruta a 192.168.12.0/24 en el R3.</p>","path":["Enrutamiento","Enrutamiento est√°tico"],"tags":[]},{"location":"routers_y_rutas_estaticas/#configurando-rutas-estaticas","level":3,"title":"Configurando rutas est√°ticas","text":"<p>El comando para configurar una ruta est√°tica es, desde el modo de configuraci√≥n global, <code>ip route</code>. Sin embargo, existen diferentes opciones en cuanto a los argumentos que se proporcionan con el comando:</p> <ul> <li><code>ip route red-destino m√°scara pr√≥ximo-salto</code></li> <li><code>ip route red-destino m√°scara interfaz-salida</code></li> <li><code>ip route red-destino m√°scara interfaz-salida pr√≥ximo-salto</code></li> </ul>","path":["Enrutamiento","Enrutamiento est√°tico"],"tags":[]},{"location":"routers_y_rutas_estaticas/#rutas-estaticas-especificando-el-proximo-salto","level":3,"title":"Rutas est√°ticas especificando el pr√≥ximo salto","text":"<p>Se puede configurar una ruta est√°tica especificando la direcci√≥n de red de destino, la m√°scara de red y la direcci√≥n IP del siguiente salto.</p> <p>Aqu√≠ se muestran los comandos para configurar cada una de las rutas necesarias en R1, R2 y R3.</p> <p></p> <p>Las rutas especifican la direcci√≥n IP del siguiente salto. R1 requiere una ruta a 192.168.3.0/24, R2 requiere rutas a 192.168.1.0/24 y 192.168.3.0/24, y R3 requiere una ruta a 192.168.1.0/24.</p> <p>Una ruta est√°tica que especifica √∫nicamente la direcci√≥n IP del siguiente salto se denomina ruta est√°tica recursiva. El nombre recursivo se debe a que requiere m√∫ltiples b√∫squedas en la tabla de enrutamiento para reenviar un paquete:</p> <ul> <li>Una b√∫squeda para encontrar la direcci√≥n IP del siguiente salto</li> <li>Una b√∫squeda para encontrar la interfaz a la que est√° conectado el siguiente salto</li> </ul> <p>Para demostrarlo, observemos la tabla de enrutamiento de R1 en el siguiente ejemplo. Cuando R1 recibe un paquete destinado a 192.168.3.11, descubre que la ruta coincidente m√°s espec√≠fica (de hecho, la √∫nica ruta coincidente) es la est√°tica:</p> <pre><code>R1# show ip route\nCodes: L - local, C - connected, S - static, R - RIP, M - mobile, B - BGP\n. . .\n      192.168.1.0/24 is variably subnetted, 2 subnets, 2 masks\nC        192.168.1.0/24 is directly connected, GigabitEthernet0/1\nL        192.168.1.1/32 is directly connected, GigabitEthernet0/1\nS     192.168.3.0/24 [1/0] via 192.168.12.2\n      192.168.12.0/24 is variably subnetted, 2 subnets, 2 masks\nC        192.168.12.0/24 is directly connected, GigabitEthernet0/0\nL        192.168.12.1/32 is directly connected, GigabitEthernet0/0\n</code></pre> <p>Nota</p> <p>El [1/0] en la ruta est√°tica indica la distancia administrativa (AD) y la m√©trica de la ruta, respectivamente. La AD y la m√©trica se abordar√°n en temas posteriores; no son relevantes para este.</p> <p>La ruta est√°tica indica <code>S 192.168.3.0/24 [1/0] v√≠a 192.168.12.2</code> (n√≥tese el c√≥digo <code>S</code> para est√°tica), pero esta informaci√≥n por s√≠ sola no le indica a R1 por qu√© interfaz reenviar el paquete. Para obtenerla, realiza una segunda b√∫squeda de la direcci√≥n IP del siguiente salto: 192.168.12.2. La ruta m√°s espec√≠fica (y la √∫nica) que coincide con 192.168.12.2 es la ruta conectada a 192.168.12.0/24, que especifica la interfaz G0/0. Ahora, despu√©s de dos b√∫squedas, R1 conoce la direcci√≥n IP del siguiente salto y la interfaz por la que reenviar el paquete.</p> <p>Nota</p> <p>R1 conoce la direcci√≥n IP del siguiente salto, pero la informaci√≥n que realmente necesita es la direcci√≥n MAC del siguiente salto. Para obtenerla, debe enviar una solicitud ARP a la direcci√≥n IP del siguiente salto.</p>","path":["Enrutamiento","Enrutamiento est√°tico"],"tags":[]},{"location":"routers_y_rutas_estaticas/#rutas-estaticas-especificando-la-interfaz-de-salida","level":3,"title":"Rutas est√°ticas especificando la interfaz de salida","text":"<p>En lugar de especificar la direcci√≥n IP del siguiente salto de la ruta, puede especificar la interfaz de salida, es decir, la interfaz desde la que el router debe reenviar los paquetes. El siguiente ejemplo muestra las mismas rutas est√°ticas que hemos visto en la figura anterior, pero configuradas con la interfaz de salida:</p> <ul> <li><code>R1(config)# ip route 192.168.3.0 255.255.255.0 g0/0</code></li> <li><code>R2(config)# ip route 192.168.1.0 255.255.255.0 g0/0</code></li> <li><code>R2(config)# ip route 192.168.3.0 255.255.255.0 g0/1</code></li> <li><code>R3(config)# ip route 192.168.1.0 255.255.255.0 g0/0</code></li> </ul> <p>Una ruta est√°tica que especifica solo la interfaz de salida se denomina ruta est√°tica conectada directamente. Esto se debe a que la ruta aparecer√° como una red conectada directamente en la tabla de enrutamiento. El siguiente ejemplo muestra la ruta a 192.168.3.0/24 en la tabla de enrutamiento de R1:</p> <pre><code>R1# show ip route\nCodes: L - local, C - connected, S - static, R - RIP, M - mobile, B - BGP\n. . .\nS     192.168.3.0/24 is directly connected, GigabitEthernet0/0\n. . .\n</code></pre> <p>Este tipo de ruta est√°tica tiene una desventaja: dado que R1 considera que la red 192.168.3.0/24 est√° conectada directamente a su interfaz G0/0, intentar√° enviar paquetes en tramas dirigidas directamente a PC3, en lugar de al siguiente salto.</p> <p>Esto significa que R1 no enviar√° una solicitud ARP para conocer la direcci√≥n MAC del siguiente salto; en su lugar, enviar√° una solicitud ARP para conocer la direcci√≥n MAC de PC3. El problema es que esta solicitud ARP no llegar√° a PC3, sino a R2 (los mensajes de difusi√≥n no van m√°s all√° de su red local). Sin embargo, R2 puede usar una funci√≥n llamada proxy ARP para responder en nombre de PC3, indic√°ndole a R1 que env√≠e el paquete a la direcci√≥n MAC G0/0 de R2. Esto se muestra en la figura 9.10.</p> <p></p> <p>Un intercambio ARP proxy entre R1 y R2:</p> <ol> <li>R1 env√≠a una solicitud ARP para conocer la direcci√≥n MAC de PC3.</li> <li>192.168.3.11 no es la direcci√≥n IP de R2, pero R2 tiene una ruta a 192.168.3.0/24 en su tabla de enrutamiento, por lo que R2 usa ARP proxy para responder en nombre de PC3.</li> </ol> <p>Nota</p> <p>Un router solo usar√° proxy ARP para responder a una solicitud ARP si tiene una ruta al destino en su tabla de enrutamiento. De lo contrario, ignorar√° la solicitud.</p> <p>El siguiente ejemplo muestra la tabla ARP de R1 (puede visualizarla con el comando <code>show arp</code>). Observe que se muestra la misma direcci√≥n MAC (<code>Hardware Addr</code>) para 192.168.12.2 y 192.168.3.11: la direcci√≥n MAC de la interfaz G0/0 de R2.</p> <pre><code>R1# show arp\nProtocol  Address          Age (min)  Hardware Addr   Type   Interface\n. . .\nInternet  192.168.3.11            0   5254.0003.e684  ARPA   GigabitEthernet0/0\n. . .\nInternet  192.168.12.2            0   5254.0003.e684  ARPA   GigabitEthernet0/0\n</code></pre> <p>La dependencia del proxy ARP es una desventaja de las rutas est√°ticas conectadas directamente por dos razones.</p> <ul> <li> <p>En primer lugar, aunque el proxy ARP est√° habilitado en los routers Cisco por defecto, en algunos casos puede estar deshabilitado (por ejemplo, si R2 no es un router Cisco). Si el proxy ARP est√° deshabilitado en R2, no responder√° a la solicitud ARP de R1 y R1 no podr√° reenviar el paquete a PC3.</p> </li> <li> <p>La segunda desventaja es que R1 necesitar√° crear una entrada ARP independiente para cada host en 192.168.3.0/24. Considera que cada host en 192.168.3.0/24 est√° conectado directamente, por lo que intentar√° obtener la direcci√≥n MAC de cada host; esto podr√≠a desperdiciar memoria en R1 si hay muchos hosts en la red. Por otro lado, si se especifica la direcci√≥n IP del siguiente salto en lugar de la interfaz de salida, R1 solo necesitar√° una entrada ARP para reenviar paquetes a 192.168.3.0/24: una entrada ARP para el siguiente salto.</p> </li> </ul> <p>Nota</p> <p>Aunque nos centramos en el R1 como ejemplo, lo mismo aplica para el R2, que considerar√° que las redes 192.168.1.0/24 y 192.168.3.0/24 est√°n conectadas directamente, as√≠ como para el R3, que considerar√° que la red 192.168.1.0/24 est√° conectada directamente.</p> <p>Deber√≠amos conocer la definici√≥n de rutas est√°ticas conectadas directamente y poder configurarlas, pero debido a las desventajas de depender de ARP proxy, es muy recomendable no usarlas en una red real. En su lugar, debemos utilizar rutas est√°ticas recursivas o la siguiente opci√≥n: rutas est√°ticas completamente especificadas.</p>","path":["Enrutamiento","Enrutamiento est√°tico"],"tags":[]},{"location":"routers_y_rutas_estaticas/#rutas-estaticas-especificando-tanto-el-interfaz-de-salida-como-el-proximo-salto","level":3,"title":"Rutas est√°ticas especificando tanto el interfaz de salida como el pr√≥ximo salto","text":"<p>La tercera opci√≥n al configurar una ruta est√°tica es especificar tanto la interfaz de salida como el siguiente salto, lo que se denomina ruta est√°tica completamente especificada. Las siguientes son las mismas cuatro rutas est√°ticas, esta vez configuradas como rutas est√°ticas completamente especificadas:</p> <ul> <li><code>R1(config)# ip route 192.168.3.0 255.255.255.0 g0/0 192.168.12.2</code></li> <li><code>R2(config)# ip route 192.168.1.0 255.255.255.0 g0/0 192.168.12.1</code></li> <li><code>R2(config)# ip route 192.168.3.0 255.255.255.0 g0/1 192.168.23.2</code></li> <li><code>R3(config)# ip route 192.168.1.0 255.255.255.0 g0/0 192.168.23.1</code></li> </ul> <p>La ventaja de este tipo de ruta est√°tica es que el router sabe Tanto la direcci√≥n IP del siguiente salto como la interfaz desde la que se reenv√≠a el paquete; no es necesario realizar una b√∫squeda recursiva ni depender de ARP proxy. El siguiente ejemplo muestra c√≥mo aparece una ruta completamente especificada en la tabla de enrutamiento:</p> <pre><code>R1# show ip route\nCodes: L - local, C - connected, S - static, R - RIP, M - mobile, B - BGP\n. . .\nS     192.168.3.0/24 [1/0] via 192.168.12.2, GigabitEthernet0/0\n. . .\n</code></pre> <p>Este tipo de ruta est√°tica puede parecer la mejor de las tres, pero en realidad, se pueden usar rutas recursivas o est√°ticas completamente especificadas sin una diferencia notable en el rendimiento. Sin embargo, generalmente se deben evitar las rutas est√°ticas conectadas directamente.</p>","path":["Enrutamiento","Enrutamiento est√°tico"],"tags":[]},{"location":"routers_y_rutas_estaticas/#configurando-una-ruta-por-defecto","level":3,"title":"Configurando una ruta por defecto","text":"<p>La ruta predeterminada es una ruta al destino menos espec√≠fico posible: 0.0.0.0/0. Esta ruta coincide con todas las direcciones IP posibles, desde 0.0.0.0 hasta 255.255.255.255. Al ser la ruta menos espec√≠fica posible, la ruta predeterminada solo se seleccionar√° si no hay rutas m√°s espec√≠ficas en la tabla de enrutamiento del router.</p> <p>Una ruta predeterminada se utiliza a menudo para proporcionar una ruta a internet. Hay m√°s de un mill√≥n de rutas en la tabla de enrutamiento global de internet, una cantidad muy superior a la que la mayor√≠a de los routers pueden gestionar. Afortunadamente, un router no necesita conocer ninguna red de destino espec√≠fica en internet; si tiene una ruta predeterminada a internet, puede usarla para reenviar paquetes hacia internet, y la infraestructura del proveedor de servicios de internet (ISP) se encargar√° de reenviarlos al destino correcto.</p> <p>Se pueden usar rutas m√°s espec√≠ficas para destinos en la red corporativa interna, y el resto del tr√°fico (que no coincida con ninguna otra ruta) se enrutar√° utilizando la ruta predeterminada.</p> <p>La imagen de abajo muestra un ejemplo: R1 tiene rutas espec√≠ficas a 192.168.2.0/24 y 192.168.3.0/24, y luego una ruta predeterminada a internet; los paquetes con destinos que no coincidan con 192.168.2.0/24 o 192.168.3.0/24 (o las rutas conectadas y locales de R1) se reenviar√°n utilizando la ruta predeterminada.</p> <p></p> <p>El R1 tiene dos rutas a redes de destino espec√≠ficas y una ruta predeterminada a Internet. (1) Una ruta a 192.168.2.0/24, con R2 G0/0 como siguiente salto. (2) Una ruta a 192.168.3.0/24, con R3 G0/0 como siguiente salto. (3) Una ruta predeterminada, con la direcci√≥n IP del ISP (203.0.113.2) como siguiente salto.</p> <p>Para configurar una ruta predeterminada, especificamos la red de destino 0.0.0.0 y la m√°scara de red 0.0.0.0 en el comando ip route; esto da como resultado 0.0.0.0/0, que incluye todas las direcciones IP posibles. Si un router no tiene una ruta predeterminada configurada, ver√° la instrucci√≥n ¬´Gateway of last resort is not set¬ª encima de las rutas en la tabla de enrutamiento, como se muestra en el siguiente ejemplo. Esto significa que el router no tiene una ruta predeterminada:</p> <pre><code>R1# show ip route\nCodes: L - local, C - connected, S - static, R - RIP, M - mobile, B - BGP\n. . .\nGateway of last resort is not set\n. . .\n</code></pre> <p>Nota</p> <p>Puerta de enlace de √∫ltimo recurso (gateway of last resort) es otro t√©rmino para la puerta de enlace predeterminada (default gateway). La ruta predeterminada en un router es como la puerta de enlace predeterminada de un PC; se utiliza para reenviar tr√°fico a destinos fuera de las redes conocidas del router.</p> <p>Tras configurar las rutas est√°ticas que se mostraban en la figura anterior, el resultado cambia.</p> <p>En el siguiente ejemplo, se utiliza el comando <code>show ip route static</code> para ver solo las rutas est√°ticas de R1. Observe que la direcci√≥n IP del ISP (203.0.113.2) ahora aparece como la puerta de enlace de √∫ltimo recurso:</p> <pre><code>R1# show ip route static\nCodes: L - local, C - connected, S - static, R - RIP, M - mobile, B - BGP\n. . .\n       ia - IS-IS inter area, * - candidate default, U - per-user static route\n. . .\nGateway of last resort is 203.0.113.2 to network 0.0.0.0\nS*    0.0.0.0/0 [1/0] via 203.0.113.2\nS     192.168.2.0/24 [1/0] via 192.168.12.2\nS     192.168.3.0/24 [1/0] via 192.168.13.2\n</code></pre> <p>Nota</p> <p>En este mismo tema se ha indicado que un router descartar√° los paquetes que no coincidan con ninguna ruta en su tabla de enrutamiento. Sin embargo, si el router tiene una ruta predeterminada, esta situaci√≥n no ocurrir√°; la ruta predeterminada coincide con todas las direcciones IP. Si un paquete no coincide con una ruta m√°s espec√≠fica, el router lo reenviar√° por la ruta predeterminada en lugar de descartarlo.</p>","path":["Enrutamiento","Enrutamiento est√°tico"],"tags":[]},{"location":"routers_y_rutas_estaticas/#resumen","level":2,"title":"Resumen","text":"<ul> <li>El t√©rmino enrutamiento puede referirse al proceso de reenv√≠o de paquetes entre redes y a la creaci√≥n de una tabla de enrutamiento.</li> <li>Los hosts de una misma red pueden enviarse paquetes entre s√≠ sin necesidad de un router. Sin embargo, para enviar paquetes a destinos fuera de la red local, se requiere un router.</li> <li>El router al que un host env√≠a paquetes destinados a redes externas se denomina puerta de enlace predeterminada. El host env√≠a los paquetes en tramas dirigidas a la direcci√≥n MAC de la puerta de enlace predeterminada.</li> <li>La puerta de enlace predeterminada de un host puede configurarse manualmente o aprenderse autom√°ticamente mediante DHCP.</li> <li>Puede usar el comando ipconfig en el S√≠mbolo del sistema de Windows para ver informaci√≥n como la direcci√≥n IP, la m√°scara de red y la puerta de enlace predeterminada del PC.</li> <li>La tabla de enrutamiento es la base de datos de destinos conocidos del router. Es un conjunto de instrucciones sobre qu√© hacer con los paquetes. La tabla de enrutamiento se puede ver con show ip route.</li> <li>Para cada interfaz que tenga una direcci√≥n IP y est√© activa/activa, el router agregar√° autom√°ticamente dos rutas a su tabla de enrutamiento: una ruta conectada y una ruta local. Una ruta conectada es una ruta a la red a la que est√° conectada una interfaz. Las rutas conectadas se indican mediante el c√≥digo C en la tabla de enrutamiento. Si un router recibe un paquete destinado a un host en una red conectada directamente, lo reenviar√° directamente al host de destino (en una trama dirigida a la direcci√≥n MAC del host).</li> <li>Una ruta local es una ruta a la misma direcci√≥n IP configurada en la interfaz. Las rutas locales utilizan un prefijo /32 para especificar una √∫nica direcci√≥n IP. Si un router recibe un paquete destinado a la direcci√≥n IP de una ruta local, significa que el paquete est√° destinado al propio router; este lo recibir√° para s√≠ mismo, no lo reenviar√°.</li> <li>Una ruta a m√°s de una direcci√≥n IP de destino (cualquier ruta con un prefijo menor que /32) se denomina ruta de red. Una ruta conectada es un ejemplo de ruta de red.</li> <li>Una ruta a una √∫nica direcci√≥n IP de destino (una ruta con un prefijo /32) se denomina ruta de host. Una ruta local es un ejemplo de ruta de host. El proceso de decidir qu√© ruta es la adecuada para reenviar un paquete se denomina selecci√≥n de ruta. Para determinar c√≥mo reenviar un paquete en particular, el router seleccionar√° la ruta m√°s espec√≠fica (la que tenga el prefijo m√°s largo).</li> <li>Una ruta /32 es la m√°s espec√≠fica posible; especifica solo una direcci√≥n IP. Una ruta /0 (ruta predeterminada) es la menos espec√≠fica posible; especifica todas las direcciones IP posibles.</li> <li>Mientras que el reenv√≠o de capa 3 implica buscar en la tabla de enrutamiento la ruta m√°s espec√≠fica, el reenv√≠o de capa 2 implica buscar una coincidencia exacta en la tabla de direcciones MAC; las coincidencias parciales no cuentan.</li> <li>Si no hay rutas que coincidan con la direcci√≥n IP de destino de un paquete, el router lo descartar√°.</li> <li>Para enrutar paquetes a destinos que no est√°n conectados directamente al router, este necesita aprender las rutas a esos destinos mediante enrutamiento din√°mico (mediante un protocolo como OSPF) o enrutamiento est√°tico (en el que las rutas se configuran manualmente en el router). Para reenviar un paquete a un destino remoto, el router lo encapsula en una trama destinada a la direcci√≥n MAC del siguiente salto (el siguiente router en la ruta hacia el destino).</li> <li>Para que un router reenv√≠e paquetes entre dos hosts, necesita rutas a la red de cada host; no necesita rutas a todas las redes en la ruta entre cada destino.</li> <li>El comando para configurar una ruta est√°tica es ip route destination-network netmask {next-hop | exit-interface | exit-interface next-hop}.</li> <li>Una ruta est√°tica que especifica solo el siguiente salto se denomina ruta est√°tica recursiva; requiere m√∫ltiples b√∫squedas en la tabla de enrutamiento para reenviar un paquete: una para encontrar la direcci√≥n IP del siguiente salto y otra para encontrar la interfaz a la que est√° conectado el siguiente salto.</li> <li>Una ruta est√°tica que especifica solo la interfaz de salida se denomina ruta est√°tica conectada directamente porque hace que el router trate la red como una red conectada directamente.</li> <li>Las rutas est√°ticas conectadas directamente requieren ARP proxy para funcionar. ARP proxy permite que un router responda a las solicitudes ARP en nombre de otros hosts. El proxy ARP est√° habilitado en los routers Cisco de forma predeterminada, pero podr√≠a no estarlo en los routers de otros proveedores.</li> <li>Una ruta est√°tica que especifica tanto la interfaz de salida como el siguiente salto se denomina ruta est√°tica completamente especificada.</li> <li>Una ruta predeterminada es una ruta a 0.0.0.0/0. Al ser la ruta menos espec√≠fica posible, solo se utilizar√° para reenviar paquetes que no coincidan con ninguna otra ruta en la tabla de enrutamiento.</li> <li>Si un router tiene una ruta predeterminada, no descartar√° los paquetes que no coincidan con otras rutas; en su lugar, los reenviar√° utilizando la ruta predeterminada.</li> <li>La ruta predeterminada se utiliza a menudo para proporcionar una ruta a internet; no es posible que un router aprenda rutas espec√≠ficas para cada posible...</li> </ul>","path":["Enrutamiento","Enrutamiento est√°tico"],"tags":[]},{"location":"rutas_dinamicas/","level":1,"title":"Enrutamiento din√°mico","text":"<p>En esta unidad veremos los siguientes puntos:</p> <ul> <li>Las ventajas del enrutamiento din√°mico sobre el enrutamiento est√°tico</li> <li>Los tipos de protocolos de enrutamiento din√°mico</li> <li>C√≥mo decide un router qu√© rutas ingresar en su tabla de enrutamiento</li> <li>Activaci√≥n de protocolos de enrutamiento din√°mico con el comando de red</li> </ul> <p>En la unidad anterior aprendimos sobre el enrutamiento est√°tico, en el que un administrador configura manualmente las rutas para crear la tabla de enrutamiento de un router. Al usar el enrutamiento din√°mico, los routers se comunican entre s√≠ y crean sus tablas de enrutamiento autom√°ticamente. Si bien el enrutamiento est√°tico tiene sus usos, el enrutamiento din√°mico ofrece varias ventajas que examinaremos en este cap√≠tulo.</p> <p>Lo que aqu√≠ trataremos tiene, de alguna forma, una correspondencia con algunos de los elementos de los siguientes temas de examen del CCNA:</p> <ul> <li>3.1 Interpretar los componentes de la tabla de enrutamiento</li> <li>3.2 Determinar c√≥mo un router toma una decisi√≥n de reenv√≠o de forma predeterminada</li> <li>3.3 Configurar y verificar el enrutamiento est√°tico IPv4 e IPv6</li> <li>3.4 Configurar y verificar OSPFv2</li> </ul>","path":["Enrutamiento","Enrutamiento din√°mico"],"tags":[]},{"location":"rutas_dinamicas/#enrutamiento-dinamico-vs-enrutamiento-estatico","level":2,"title":"Enrutamiento din√°mico vs. enrutamiento est√°tico","text":"<p>El enrutamiento din√°mico es un proceso mediante el cual los routers comparten informaci√≥n sobre la red, lo que les permite crear sus tablas de enrutamiento sin necesidad de que un administrador configure manualmente cada ruta. Esto se logra mediante un protocolo de enrutamiento, que define c√≥mo se comunican los routers para compartir informaci√≥n de enrutamiento y c√≥mo la utilizan para crear sus tablas de enrutamiento. </p> <p>La imagen siguiente muestra un ejemplo del funcionamiento de los protocolos de enrutamiento. R1, R2 y R3 utilizan un protocolo de enrutamiento para intercambiar mensajes, inform√°ndose mutuamente de sus redes conocidas. Cada router utilizar√° esta informaci√≥n para crear su tabla de enrutamiento, sin necesidad de que un administrador configure manualmente las rutas. Figura 17.1 R1, R2 y R3 utilizan un protocolo de enrutamiento para compartir informaci√≥n de enrutamiento. </p> <p>Cada router utilizar√° esta informaci√≥n para crear su tabla de enrutamiento.</p> <p></p> <p>Nota</p> <p>El intercambio de informaci√≥n de enrutamiento tambi√©n se denomina advertisement (anuncio) . R1, R2 y R3 anuncian sus redes conocidas entre s√≠.</p> <p>El enrutamiento din√°mico ofrece varias ventajas sobre el enrutamiento est√°tico, como la adaptabilidad y la escalabilidad. Analicemos estas dos ventajas con m√°s detalle.</p>","path":["Enrutamiento","Enrutamiento din√°mico"],"tags":[]},{"location":"rutas_dinamicas/#adaptabilidad","level":3,"title":"Adaptabilidad","text":"<p>Las rutas est√°ticas, como su nombre indica, son est√°ticas e inmutables; no pueden reaccionar a los cambios en la red. Si una ruta deja de ser v√°lida debido a un fallo de hardware en uno de los routers de la ruta, la ruta est√°tica no se ajustar√° autom√°ticamente para encontrar una ruta alternativa. La imagen de m√°s abajo muestra un ejemplo: el enlace R2-R3 se cae debido a un fallo de hardware. Esto hace que R3 elimine su ruta a 192.168.30.0/24 de su tabla de enrutamiento; ya no puede acceder a la direcci√≥n IP del siguiente salto. Sin embargo, R1 desconoce el fallo del enlace. Como resultado, R1 mantiene su ruta a 192.168.30.0/24 a trav√©s de R2 en su tabla de enrutamiento, aunque ya no sea una ruta v√°lida para llegar al destino.</p> <p></p> <p>Figura 1.  La ruta est√°tica en R1 no puede adaptarse a un cambio en la red. (1) Una falla de hardware provoca la ca√≠da del enlace R2-R3. (2) R2 elimina su ruta a 192.168.30.0/24 porque ya no puede alcanzar el siguiente salto. (3) R1, sin percatarse de la falla de hardware, deja su ruta a 192.168.30.0/24 a trav√©s de R2 en su tabla de enrutamiento, a pesar de la existencia de una ruta alternativa.</p> <p>Nota</p> <p>Si un router no puede acceder a la direcci√≥n IP del siguiente salto de una ruta, la eliminar√° de la tabla de enrutamiento. Esto aplica a todo tipo de rutas y es por eso que R2 elimina su ruta est√°tica a 192.168.30.0/24 cuando falla el enlace R2-R3.</p> <p>Dado que la ruta de R1 a 192.168.30.0/24 a trav√©s de R2 permanece en su tabla de enrutamiento, continuar√° reenviando paquetes destinados a hosts en la red 192.168.30.0/24 a R2. R2 no tiene otra opci√≥n que descartar los paquetes, ya que no tiene una ruta a 192.168.30.0/24 en su tabla de enrutamiento. La imagen muestra c√≥mo el enrutamiento din√°mico soluciona esto; permite a R1 adaptarse autom√°ticamente al cambio de red, insertando una nueva ruta al destino en su tabla de enrutamiento.</p> <p></p> <p>Figura 2.  El enrutamiento din√°mico permite que los routers se adapten a los cambios en la red calculando autom√°ticamente nuevas rutas. (1) Una falla de hardware provoca la ca√≠da del enlace R2-R3. (2) R2 elimina su ruta a 192.168.30.0/24 a trav√©s de R3 y agrega una nueva ruta con R1 como siguiente salto. (3) R1 elimina su ruta a trav√©s de R2 y agrega una nueva ruta con R4 como siguiente salto.</p> <p>Nota</p> <p>El tipo de ruta D en la figura de arriba indica una ruta aprendida mediante el protocolo de enrutamiento Enhanced Interior Gateway Routing Protocol (EIGRP). D significa <code>DIFUSING UPDATE ALGORITHM (DUAL)</code>, el algoritmo espec√≠fico que EIGRP utiliza para calcular rutas.</p> <p>En cuesti√≥n de segundos tras el fallo, todos los routers de la red detectar√°n el cambio y tendr√°n nuevas rutas en sus tablas de enrutamiento. Una vez restaurado el enlace fallido (quiz√°s reemplazando un cable defectuoso), los routers se adaptar√°n de nuevo a ese cambio, restaurando sus tablas de enrutamiento a su estado anterior. La adaptabilidad del enrutamiento din√°mico mejora la resiliencia de la red; es capaz de recuperarse autom√°ticamente de los fallos con un tiempo de inactividad m√≠nimo. Esto no es posible en una red que utiliza exclusivamente enrutamiento est√°tico.</p>","path":["Enrutamiento","Enrutamiento din√°mico"],"tags":[]},{"location":"rutas_dinamicas/#escalabilidad","level":3,"title":"Escalabilidad","text":"<p>Otra ventaja importante del enrutamiento din√°mico es la escalabilidad. Si bien el enrutamiento est√°tico puede ser pr√°ctico para redes peque√±as, se vuelve cada vez m√°s complejo e inmanejable a medida que la red crece. Por otro lado, los protocolos de enrutamiento din√°mico se escalan f√°cilmente para admitir redes muy grandes y complejas. En la imagen se muestra una red de seis routers, cada uno conectado a una LAN que contiene varias subredes. Adem√°s, dos routers tienen conexiones a un ISP. Esta es una red bastante simple, pero incluso en una red de este tama√±o, configurar manualmente rutas est√°ticas a cada destino en cada router no es muy pr√°ctico. Una opci√≥n m√°s sencilla es habilitar un protocolo de enrutamiento en cada router y permitir que compartan la informaci√≥n de enrutamiento entre ellos.</p> <p></p> <p>Figura 3.  Configurar rutas est√°ticas a cada destino en cada router, incluso en una red bastante peque√±a como esta, no es pr√°ctico; consumir√≠a mucho tiempo y ser√≠a propenso a errores humanos.</p> <p>Antes de examinar los diferentes tipos de protocolos de enrutamiento, cabe mencionar que las rutas est√°ticas tienen sus propias ventajas, como la previsibilidad y el control. Dado que el enrutamiento est√°tico implica la configuraci√≥n manual de rutas (especificando el siguiente salto para cada destino), son √∫tiles cuando se desea controlar la ruta exacta que siguen los paquetes. Afortunadamente, no es necesario elegir entre enrutamiento est√°tico y din√°mico; se puede usar una combinaci√≥n de ambos en un solo router.</p>","path":["Enrutamiento","Enrutamiento din√°mico"],"tags":[]},{"location":"rutas_dinamicas/#tipos-de-protocolos-de-enrutamiento","level":2,"title":"Tipos de protocolos de enrutamiento","text":"<p>Los protocolos de enrutamiento se dividen en dos categor√≠as principales: Protocolos de Puerta de Enlace Interior (IGP - Interior Gatewa Protocol) y Protocolos de Puerta de Enlace Exterior (EGP - Exterior Gateway Protocols). Los IGP se utilizan para intercambiar informaci√≥n de enrutamiento dentro de un √∫nico sistema aut√≥nomo (AS), es decir, la red de una organizaci√≥n. Los EGP, por otro lado, se utilizan para intercambiar informaci√≥n de enrutamiento entre diferentes sistemas aut√≥nomos, como entre una empresa y un ISP o entre dos ISP.</p> <p>Nota</p> <p>Puerta de enlace es un t√©rmino antiguo para router. Aunque hoy en d√≠a los llamamos routers, el t√©rmino puerta de enlace todav√≠a se usa en algunos contextos (como puerta de enlace predeterminada, como ya hemos visto.</p> <p>La imagen de abajo muestra la diferencia entre los IGP y los EGP. Cada organizaci√≥n del diagrama utiliza un IGP para intercambiar informaci√≥n de enrutamiento dentro de su organizaci√≥n, pero un EGP para intercambiar informaci√≥n de enrutamiento con otras organizaciones.</p> <p></p> <p>Figura 4.  Los IGP se utilizan para intercambiar informaci√≥n de enrutamiento con routers del mismo sistema aut√≥nomo (conectados con l√≠neas continuas). Los EGP se utilizan para intercambiar informaci√≥n de enrutamiento con routers de un sistema aut√≥nomo diferente (conectados con l√≠neas discontinuas).</p> <p>La siguiente imagen enumera los protocolos de enrutamiento m√°s utilizados en la actualidad. Adem√°s de clasificarse como IGP o EGP, los protocolos de enrutamiento pueden clasificarse por tipo de algoritmo, que describe c√≥mo los routers comparten informaci√≥n y calculan rutas.</p> <p></p> <p>Figura 5.  Los cinco protocolos de enrutamiento de uso com√∫n en la actualidad. Los IGP se pueden clasificar como de vector-distancia o de estado de enlace. Los dos IGP de vector-distancia son RIP y EIGRP. Los dos IGP de estado de enlace son OSPF e IS-IS. El √∫nico protocolo de puerta de enlace exterior en uso actualmente, el Protocolo de Puerta de Enlace Fronterizo (Border Gateway Protocol), utiliza un algoritmo de vector-ruta.</p>","path":["Enrutamiento","Enrutamiento din√°mico"],"tags":[]},{"location":"rutas_dinamicas/#protocolos-de-puerta-de-enlace-interior","level":3,"title":"Protocolos de puerta de enlace interior","text":"<p>Los IGP utilizan uno de dos tipos de algoritmos: vector-distancia y estado-enlace. En esta secci√≥n, analizaremos las caracter√≠sticas b√°sicas de cada uno. Protocolos de vector de distancia</p> <p>Actualmente se utilizan dos protocolos principales de enrutamiento por vector de distancia: RIP (Routing Information Protocol), est√°ndar de la industria, y EIGRP (Enhanced Interior Gateway Routing Protocol), desarrollado por Cisco. RIP es un protocolo muy simple que suele emplearse solo en redes y laboratorios muy peque√±os. EIGRP, por otro lado, es m√°s avanzado que RIP (de hecho, a veces se le denomina protocolo de vector de distancia avanzado) y se utiliza en muchas redes a gran escala.</p> <p>Nota</p> <p>Aunque EIGRP fue desarrollado por Cisco, la mayor parte de su funcionalidad se public√≥ en la RFC 7868, por lo que otros proveedores pueden implementarlo en sus dispositivos. Sin embargo, muy pocos proveedores lo han implementado, por lo que, en general, se puede afirmar que EIGRP solo funciona en routers Cisco.</p> <p>Los routers que utilizan un protocolo de vector-distancia comparten informaci√≥n sobre sus redes conocidas y las m√©tricas para acceder a ellas. Las m√©tricas son un concepto similar al costo ra√≠z de STP. Mientras que el costo ra√≠z de STP mide la eficiencia de una ruta al puente ra√≠z, una m√©trica mide la eficiencia de una ruta a la red de destino; las m√©tricas se abordar√°n en la secci√≥n 17.3.1. La siguiente figura muestra c√≥mo un router obtiene informaci√≥n de una red de destino (LAN A) con un protocolo de enrutamiento de vector-distancia. R1 obtiene informaci√≥n de LAN A a trav√©s de dos vecinos: R2 y R5. Dado que la ruta a trav√©s de R5 tiene una m√©trica menor, R1 la inserta en su tabla de enrutamiento; es preferible un valor de m√©trica menor.</p> <p></p> <p>Figura 6.  Los routers comparten informaci√≥n de enrutamiento con un protocolo de enrutamiento por vector de distancia. R1 obtiene informaci√≥n de la LAN A de R2 y R5, pero inserta la ruta a trav√©s de R5 en su tabla de enrutamiento debido al menor valor de la m√©trica.</p> <p>Nota</p> <p>El tipo de ruta R en la figura indica una ruta aprendida mediante el protocolo de enrutamiento RIP.</p> <p>La caracter√≠stica clave de los protocolos de enrutamiento por vector de distancia es que cada router no tiene un mapa completo de la red; para cada red de destino que aprende, solo conoce la m√©trica y el router del siguiente salto. Usando el ejemplo de la figura 17.7, R1 sabe que para llegar a la LAN A, puede reenviar paquetes a R2, cuya m√©trica es 2, o a R5, cuya m√©trica es 1; desconoce los detalles de la red m√°s all√° de R2 y R5, como se muestra a continuaci√≥n:</p> <p></p> <p>Figura 7.  R1 obtiene informaci√≥n de la LAN A a trav√©s de R2 y R5 y selecciona una ruta bas√°ndose en esa informaci√≥n. R1 desconoce los detalles de la red m√°s all√° de R2 y R5.</p> <p>Nota</p> <p>El enrutamiento por vector de distancia a veces se denomina enrutamiento por rumor. Los routers no tienen un mapa completo de la red; solo conocen lo que les dicen sus vecinos.</p>","path":["Enrutamiento","Enrutamiento din√°mico"],"tags":[]},{"location":"rutas_dinamicas/#protocolos-de-estado-de-enlace","level":3,"title":"Protocolos de estado de enlace","text":"<p>Al igual que los protocolos de enrutamiento por vector de distancia, existen dos protocolos principales de enrutamiento de estado de enlace en uso actualmente: Sistema Intermedio a Sistema Intermedio (IS-IS) y Open Shortest Path First (OSPF), ambos protocolos est√°ndar de la industria. IS-IS se utiliza con mayor frecuencia en redes de proveedores de servicios (como las redes de ISP) y no se trata en el examen CCNA; no lo abordaremos en detalle en este libro. Por otro lado, OSPF es uno de los temas principales del examen CCNA y lo abordaremos en detalle en el cap√≠tulo 18.</p> <p>Al utilizar un protocolo de enrutamiento de estado de enlace, cada router crea un mapa de conectividad de la red. Para que todos los routers puedan crear su propio mapa de conectividad, cada uno comparte informaci√≥n sobre sus enlaces conectados y su estado (subredes conectadas, costo m√©trico, etc.); de ah√≠ el nombre \"estado de enlace\". Esta informaci√≥n no solo se comparte con los routers vecinos directamente conectados, sino con todos los routers de la red, para que todos puedan crear el mismo mapa de conectividad. Cada router utiliza este mapa de la red para calcular la mejor ruta a cada destino. La Figura 17.9 muestra este concepto: el R1 crea un mapa de conectividad y lo utiliza para calcular una ruta a la LAN A.</p> <p></p> <p>Figura 8.  R1 construye un mapa de conectividad de la red y lo utiliza para calcular una ruta a LAN A.</p> <p>Nota</p> <p>El tipo de ruta O indica una ruta aprendida a trav√©s del protocolo de enrutamiento OSPF.</p> <p>Construir este mapa de la red y usarlo para calcular rutas requiere m√°s recursos de CPU y memoria en el router que los requeridos por los protocolos de enrutamiento por vector de distancia, lo cual puede ser un problema en redes muy grandes. El mapa se almacena en memoria mediante una estructura llamada base de datos de estado de enlace (LSDB), y calcular rutas a partir de la LSDB puede consumir muchos recursos de la CPU. Sin embargo, existen m√©todos para superar esta limitaci√≥n, como dividir la red en √°reas, que abordaremos en el cap√≠tulo 18.</p>","path":["Enrutamiento","Enrutamiento din√°mico"],"tags":[]},{"location":"rutas_dinamicas/#protocolos-de-puerta-de-enlace-exterior","level":3,"title":"Protocolos de puerta de enlace exterior","text":"<p>En las redes modernas, solo se utiliza ampliamente un √∫nico EGP: el Protocolo de Puerta de Enlace de Frontera (BGP). BGP utiliza un algoritmo de vector de ruta para calcular rutas. Al igual que los dos tipos de algoritmos IGP, el nombre de vector de ruta nos da una pista sobre c√≥mo funciona BGP. La ruta es la serie de sistemas aut√≥nomos que un paquete recorrer√° a lo largo de su ruta hacia su destino; por ejemplo, podr√≠a pasar por dos ISP diferentes antes de llegar al Sistema Aut√≥nomo de destino.</p> <p>La Figura 17.10 muestra la l√≥gica de vector de ruta: los paquetes del R1 a destinos en la Empresa B viajar√°n a trav√©s de los ISP A y B y luego llegar√°n a la Empresa B. El R1 conoce esta ruta comunic√°ndose con el ISP A mediante BGP. En lugar de tomar decisiones de enrutamiento basadas en la serie de routers individuales por los que viajar√°n los paquetes, BGP toma decisiones de enrutamiento basadas en la serie de sistemas aut√≥nomos por los que viajar√°n (cada AS probablemente consta de varios routers).</p> <p></p> <p>Figura 9.  La ruta de R1 a la Empresa B pasa por el ISP A y el ISP B y luego llega a la Empresa B. La l√≥gica de vector de ruta es de AS a AS, en lugar de router a router.</p> <p>Nota</p> <p>La Figura 17.10 simplifica el funcionamiento de BGP. BGP considera m√∫ltiples atributos de la ruta, no solo el n√∫mero de sistemas aut√≥nomos.</p>","path":["Enrutamiento","Enrutamiento din√°mico"],"tags":[]},{"location":"rutas_dinamicas/#seleccion-de-ruta","level":2,"title":"Selecci√≥n de ruta","text":"<p>La selecci√≥n de ruta es algo que ya hemos visto anteriormente. Esa definici√≥n de selecci√≥n de ruta se refer√≠a al reenv√≠o de paquetes; cuando un router reenv√≠a un paquete, seleccionar√° la ruta coincidente m√°s espec√≠fica en la tabla de enrutamiento.</p> <p>Sin embargo, la selecci√≥n de ruta tambi√©n puede referirse al proceso de seleccionar las rutas que se utilizan para completar la tabla de enrutamiento. Las rutas aprendidas mediante un protocolo de enrutamiento din√°mico no se insertan autom√°ticamente en la tabla de enrutamiento del router. Del mismo modo, las rutas est√°ticas configuradas manualmente tampoco se incluyen necesariamente en la tabla de enrutamiento. Si una ruta no est√° en la tabla de enrutamiento, no se puede utilizar para reenviar paquetes. En resumen, el t√©rmino \"selecci√≥n de ruta\" tiene dos significados:</p> <ul> <li>Poblaci√≥n de la tabla de enrutamiento: el proceso de seleccionar qu√© rutas ingresar√° el router en su tabla de enrutamiento</li> <li>Reenv√≠o de paquetes: el proceso de seleccionar la mejor ruta en la tabla de enrutamiento para reenviar un paquete en particular.</li> </ul> <p>Si un router aprende varias rutas al mismo destino, solo insertar√° la mejor ruta a ese destino en su tabla de enrutamiento. Para determinar cu√°l es la mejor ruta, comparar√° dos par√°metros: distancia m√©trica y administrativa.</p>","path":["Enrutamiento","Enrutamiento din√°mico"],"tags":[]},{"location":"rutas_dinamicas/#el-parametro-de-la-metrica","level":3,"title":"El par√°metro de la m√©trica","text":"<p>Ya vimos un ejemplo del funcionamiento de las m√©tricas en la figura 17.7. R1 aprendi√≥ dos rutas para llegar a la LAN A: una con una m√©trica de 2 y otra con una m√©trica de 1. ¬øCu√°l de las dos rutas insert√≥ R1 en su tabla de enrutamiento? R1 seleccion√≥ la √∫ltima debido a su m√©trica m√°s baja.</p> <p>La m√©trica de cada protocolo de enrutamiento se calcula de forma diferente. RIP utiliza un conteo de saltos simple: la cantidad de routers entre el router y el destino constituye la m√©trica de la ruta. OSPF utiliza un valor de costo calculado a partir del ancho de banda de cada enlace de la ruta. EIGRP utiliza un c√°lculo m√°s complejo basado en el ancho de banda y el retardo (el tiempo que tardan los bits en viajar a trav√©s de un enlace), as√≠ como otros par√°metros. La Tabla 17.1 resume c√≥mo RIP, EIGRP y OSPF calculan las m√©tricas. Tabla 17.1 M√©tricas del IGP (ver figura de la tabla)</p> IGP M√©trica Descripci√≥n RIP N¬∫ de saltos Cada router en la ruta cuenta como un salto. La m√©trica total es el n√∫mero total de saltos hasta el destino. EIGRP M√©trica basada en ancho de banda y retardo Una f√≥rmula compleja que puede tomar en cuenta muchos valores. Por defecto, se utilizan el ancho de banda y el retardo. OSPF Costo El costo de cada enlace se calcula en base al ancho de banda. La m√©trica de una ruta es el costo total de cada enlace en la ruta. <p>La Figura 17.11 muestra un ejemplo de selecci√≥n de ruta en una red de routers que utilizan OSPF para compartir informaci√≥n de enrutamiento. El R1 utiliza su mapa de conectividad para calcular las posibles rutas para llegar a 192.168.3.0/24 y selecciona la mejor ruta para su tabla de enrutamiento.</p> <p></p> <p>Figura 10.  R1 inserta la mejor ruta a 192.168.3.0/24 en su tabla de enrutamiento. (1) R1 calcula las posibles rutas a 192.168.3.0/24. La ruta a trav√©s de R3 tiene una m√©trica de 2 y la ruta a trav√©s de R2 tiene una m√©trica de 4. (2) R1 selecciona la ruta a trav√©s de R3 debido a su m√©trica m√°s baja y la inserta en su tabla de enrutamiento.</p> <p>El siguiente ejemplo muestra la ruta en la tabla de enrutamiento de R1. Preste atenci√≥n a los dos valores entre corchetes:</p> <pre><code>R1# show ip route\n. . .\nO     192.168.3.0/24 [110/2] via 192.168.1.6, 00:08:35, GigabitEthernet0/0\n</code></pre> <p>Despu√©s de la red de destino 192.168.3.0/24, la ruta incluye dos valores entre corchetes: [110/2]. El primer valor (110) corresponde a la distancia administrativa de la ruta (descrita en la secci√≥n 17.3.2) y el segundo valor (2) a su m√©trica. En el siguiente ejemplo, deshabilito la interfaz G0/0 de R1, lo que invalida la ruta v√≠a R3. A continuaci√≥n, reviso de nuevo la tabla de enrutamiento; la ruta alternativa v√≠a R2, con una m√©trica de 4, se inserta en la tabla de enrutamiento en lugar de la ruta v√≠a R3.</p> <pre><code>R1(config)# interface g0/0\nR1(config-if)# shutdown\nR1(config-if)# do show ip route\n. . .\nO     192.168.3.0/24 [110/4] via 192.168.1.2, 00:00:04, GigabitEthernet0/1\n</code></pre>","path":["Enrutamiento","Enrutamiento din√°mico"],"tags":[]},{"location":"rutas_dinamicas/#el-parametro-de-distancia-administrativa","level":3,"title":"El par√°metro de distancia administrativa","text":"<p>Aunque la mayor√≠a de los routers solo ejecutan un protocolo de enrutamiento, hay casos en los que un router ejecuta varios protocolos; por ejemplo, si dos empresas (que ejecutan diferentes protocolos de enrutamiento) conectan sus redes para permitir la comunicaci√≥n entre ellas. Al ejecutar varios protocolos de enrutamiento, un router puede obtener informaci√≥n sobre la misma red de destino a partir de diferentes protocolos de enrutamiento. En tales casos, el router necesita una forma de comparar las rutas para determinar cu√°l debe ingresar en la tabla de enrutamiento.</p> <p>Cada protocolo de enrutamiento utiliza diferentes par√°metros para determinar la m√©trica de una ruta: RIP utiliza un simple conteo de saltos, OSPF utiliza un costo basado en el ancho de banda y la m√©trica de EIGRP se calcula mediante una f√≥rmula que puede considerar diversos factores. El proceso de selecci√≥n de rutas de BGP, que queda fuera del alcance del examen CCNA, es mucho m√°s complejo que un simple valor m√©trico. Dado que la m√©trica de cada protocolo de enrutamiento es diferente, no se pueden comparar directamente; ser√≠a como preguntar: \"¬øQu√© es mejor: 20 kilogramos o 10 kil√≥metros?\". Si un router aprende m√∫ltiples rutas a la misma red de destino desde diferentes protocolos de enrutamiento, necesita usar algo m√°s para seleccionar qu√© ruta entra en la tabla de enrutamiento.</p> <p>Esa es la funci√≥n de la distancia administrativa (AD). La AD es un valor que indica la preferencia de un protocolo de enrutamiento. Un valor de AD bajo indica que el IOS considera que un protocolo de enrutamiento es m√°s confiable, es decir, que tiene mayor probabilidad de seleccionar buenas rutas. Mientras que una m√©trica se utiliza para comparar rutas aprendidas mediante el mismo protocolo de enrutamiento, la AD se utiliza para comparar rutas aprendidas mediante diferentes protocolos de enrutamiento. La Tabla 17.2 muestra los valores de AD predeterminados de algunos protocolos de enrutamiento diferentes (incluidas las rutas conectadas y est√°ticas).</p> Tipo de ruta / Protocolo AD por defecto Conectada 0 Est√°tica 1 BGP Externo (EBGP) 20 EIGRP 90 OSPF 110 IS-IS 115 RIP 120 BGP Interno (IBGP) 200 Ruta inutilizable 255 <p>Tabla 17.2 Valores de AD predeterminados (ver figura de la tabla)</p> <p>Al igual que al comparar valores de m√©tricas, se prefiere el valor de AD m√°s bajo. Las rutas conectadas (las rutas que se agregan autom√°ticamente al configurar una direcci√≥n IP en una interfaz) tienen un AD de 0; siempre se prefieren sobre otros tipos de ruta. Las rutas est√°ticas, con un AD de 1, se prefieren por defecto sobre las rutas aprendidas de cualquier protocolo de enrutamiento din√°mico; sin embargo, m√°s adelante en esta secci√≥n explicaremos c√≥mo reducir su preferencia. El valor de AD menos preferido es 255. Los routers Cisco pueden usar este valor para marcar una ruta como inutilizable; se eliminar√° de la tabla de enrutamiento.</p> <p>La Figura 17.12 muestra un ejemplo en el que se utiliza AD para seleccionar la ruta que entra en la tabla de enrutamiento. R1 obtiene la red de destino 10.0.0.0/24 mediante EIGRP y OSPF. Aunque el valor de la m√©trica de la ruta EIGRP (3584) es num√©ricamente mayor que el de la ruta OSPF (4), esto es irrelevante en este caso; los valores de las m√©tricas de EIGRP y OSPF no se pueden comparar directamente. En su lugar, se utiliza AD para decidir qu√© ruta entra en la tabla de enrutamiento. El AD de EIGRP (90) es menor que el de OSPF (110), por lo que R1 inserta la ruta EIGRP en su tabla de enrutamiento.</p> <p>Nota</p> <p>Debido a la f√≥rmula que EIGRP utiliza para calcular las m√©tricas, los valores de las m√©tricas de las rutas EIGRP tienden a ser bastante altos en comparaci√≥n con los de las rutas RIP y OSPF. Si bien la m√©trica de esta ruta es 3584 (debido a que el R1 y el destino solo est√°n separados por unos pocos routers), no es raro que la m√©trica de las rutas EIGRP se encuentre entre decenas y cientos de miles.</p> <p></p> <p>Figura 11.  El R1 usa AD para seleccionar la ruta que ingresa a la tabla de enrutamiento. (1) El R1 aprende dos rutas a 10.0.0.0/24: v√≠a EIGRP (m√©trica 3584) y v√≠a OSPF (m√©trica 4). (2) El AD de EIGRP (90) es menor que el de OSPF (110), por lo que el R1 inserta la ruta EIGRP en su tabla de enrutamiento. Los valores de las m√©tricas son irrelevantes en este caso.</p> <p>El siguiente ejemplo muestra la ruta EIGRP en la tabla de enrutamiento del R1. Observe los valores entre corchetes: el AD de EIGRP es 90 y la m√©trica de la ruta es 3584.</p> <pre><code>R1# show ip route\n. . .\nD        10.0.0.0 [90/3584] via 192.168.12.2, 00:33:30, GigabitEthernet0/0\n. . .\n</code></pre> <p>Nota</p> <p>Las m√©tricas y el AD solo se utilizan para comparar rutas al mismo destino: la misma direcci√≥n de red de destino con la misma longitud de prefijo. Si dos rutas tienen la misma direcci√≥n de red de destino, pero diferente longitud de prefijo (por ejemplo, 192.168.0.0/24 y 192.168.0.0/25), se consideran destinos diferentes; ambas rutas se insertar√°n en la tabla de enrutamiento. Aclararemos este punto en la secci√≥n 17.3.3.</p>","path":["Enrutamiento","Enrutamiento din√°mico"],"tags":[]},{"location":"rutas_dinamicas/#ecmp","level":3,"title":"ECMP","text":"<p>Las m√©tricas se utilizan para seleccionar rutas con el mismo destino, aprendidas mediante el mismo protocolo de enrutamiento, y el AD se utiliza para seleccionar rutas con el mismo destino, aprendidas mediante diferentes protocolos de enrutamiento. Pero ¬øqu√© sucede si un router aprende varias rutas con el mismo destino mediante el mismo protocolo de enrutamiento y estas tienen la misma m√©trica? En ese caso, todas las rutas se a√±adir√°n a la tabla de enrutamiento y el tr√°fico se distribuir√° entre ellas; la mitad del tr√°fico se enviar√° por una ruta y la otra por la otra. Esto se denomina enrutamiento multirruta de igual coste (ECMP).</p> <p>Nota</p> <p>De forma predeterminada, se puede utilizar un m√°ximo de cuatro rutas al mismo destino para el enrutamiento ECMP.</p> <p></p> <p>Figura 12.  Ejemplo de ECMP. El R1 aprende dos rutas a 10.0.0.0/24: una de R2 y otra de R4. Ambas rutas se aprenden mediante OSPF y tienen una m√©trica de 4. Por lo tanto, el R1 inserta ambas rutas en la tabla de enrutamiento; esto equilibrar√° la carga del tr√°fico entre ambas rutas. Figura 17.13 Un ejemplo de enrutamiento ECMP. (1) R1 aprende dos rutas a 10.0.0.0/24 a trav√©s de OSPF con la misma m√©trica: una de R2 y una de R4. (2) R1 inserta ambas rutas en su tabla de enrutamiento; equilibrar√° la carga del tr√°fico utilizando las dos rutas.</p>","path":["Enrutamiento","Enrutamiento din√°mico"],"tags":[]},{"location":"rutas_dinamicas/#rutas-estaticas-flotantes","level":3,"title":"Rutas est√°ticas flotantes","text":"<p>De forma predeterminada, las rutas est√°ticas tienen un AD de 1 y, por lo tanto, se prefieren a las rutas aprendidas mediante un protocolo de enrutamiento din√°mico. Sin embargo, en algunos casos, podr√≠a ser conveniente configurar una ruta est√°tica como respaldo, que solo se incluya en la tabla de enrutamiento si se pierde la ruta principal (aprendida mediante un protocolo de enrutamiento). Esta es la funci√≥n de las rutas est√°ticas flotantes.</p> <p>Una ruta est√°tica flotante es una ruta est√°tica configurada con un AD mayor que el valor predeterminado de 1 para que sea menos preferida. Por ejemplo, para que una ruta est√°tica sea menos preferida que una ruta OSPF al mismo destino, debe configurarse con un AD mayor que 110 (el AD de OSPF). Para configurar una ruta est√°tica flotante, simplemente a√±ada el valor de AD al final del comando. Por ejemplo, puede configurar una ruta est√°tica recursiva flotante con el comando <code>ip route destination-network netmask next-hop ad</code>. La Figura 17.14 muestra un ejemplo en el que se configura una ruta est√°tica con un AD de 111 para que sea menos preferida que una ruta aprendida mediante OSPF.</p> <p></p> <p>Figura 13.  Una ruta est√°tica flotante es menos preferida que una ruta OSPF al mismo destino.</p> <p>Nota</p> <p>Si configura una ruta est√°tica flotante con el mismo AD que un protocolo de enrutamiento din√°mico, se seguir√° prefiriendo la ruta est√°tica. Debe configurar rutas est√°ticas flotantes con un AD mayor que el protocolo de enrutamiento.</p> <p>Una ruta est√°tica flotante funciona como ruta de respaldo, ofreciendo una ruta secundaria para los datos si la ruta principal falla. Si bien los protocolos de enrutamiento din√°mico tambi√©n pueden ofrecer la misma funcionalidad (recalculando la siguiente mejor ruta si la mejor ruta actual falla), una ruta est√°tica flotante puede proporcionar una ruta de respaldo a trav√©s de un router con el que el router local no intercambia informaci√≥n de enrutamiento. En la figura 17.14, R1 tiene una relaci√≥n de vecino OSPF con R4, pero no con R2. Las rutas est√°ticas flotantes tambi√©n ofrecen las ventajas mencionadas anteriormente, como control y previsibilidad; permiten controlar con exactitud qu√© ruta tomar√° el tr√°fico si falla la ruta principal.</p> <p>En el siguiente ejemplo, pruebo la ruta est√°tica flotante que vimos en la figura 17.14. Al revisar por primera vez la tabla de enrutamiento de R1, la ruta OSPF est√° presente. Luego, deshabilito la interfaz G0/1 de R1 (simulando un fallo de hardware) y reviso la tabla de enrutamiento de nuevo; esta vez, la ruta est√°tica flotante (con un AD de 111) ha reemplazado a la ruta OSPF:</p> <pre><code>R1(config)# do show ip route \n. . .\nO        10.0.0.0 [110/4] via 192.168.1.6, 00:25:43, \nGigabitEthernet0/1\n. . .\nR1(config)# interface g0/1\nR1(config-if)# shutdown    \nR1(config)# do show ip route\n. . .\nS        10.0.0.0 [111/0] via 192.168.1.2\n. . .\n</code></pre> <p>Nota</p> <p>Las rutas est√°ticas no utilizan el concepto de m√©tricas; su m√©trica siempre es 0.</p>","path":["Enrutamiento","Enrutamiento din√°mico"],"tags":[]},{"location":"rutas_dinamicas/#ejemplos-de-seleccion-de-ruta","level":3,"title":"Ejemplos de selecci√≥n de ruta","text":"<p>La selecci√≥n de rutas, en sus dos acepciones (poblaci√≥n de la tabla de enrutamiento y reenv√≠o de paquetes), es un tema muy importante para el examen CCNA. En esta secci√≥n, analizaremos algunos ejemplos de cada una y aclararemos los conceptos que hemos cubierto hasta ahora.</p>","path":["Enrutamiento","Enrutamiento din√°mico"],"tags":[]},{"location":"rutas_dinamicas/#poblacion-de-la-tabla-de-enrutamiento","level":4,"title":"Poblaci√≥n de la tabla de enrutamiento","text":"<p>Considere el siguiente ejemplo. R1 aprende las siguientes rutas mediante configuraci√≥n manual y protocolos de enrutamiento din√°mico:</p> <ul> <li>(A) 203.0.113.0/24 a trav√©s de enrutamiento est√°tico</li> <li>(B) 203.0.113.0/25 v√≠a RIP, m√©trica 4</li> <li>(C) 203.0.113.0/26 a trav√©s de EIGRP, m√©trica 5678</li> <li>(D) 203.0.113.0/27 a trav√©s de OSPF, m√©trica 10</li> </ul> <p>¬øQu√© ruta(s) insertar√° R1 en su tabla de enrutamiento? Tras leer hasta este punto, podr√≠a pensar que R1 seleccionar√° la ruta est√°tica porque tiene el AD m√°s bajo. O quiz√°s piense que R1 seleccionar√° la ruta OSPF porque tiene la longitud de prefijo m√°s larga (utilizando la regla de la \"ruta coincidente m√°s espec√≠fica\" que se explica en el cap√≠tulo 9). Sin embargo, la respuesta es que R1 insertar√° las cuatro rutas en su tabla de enrutamiento.</p> <p>La raz√≥n es que las cuatro rutas tienen destinos diferentes. Aunque comparten la misma direcci√≥n de red de destino (203.0.113.0), todas tienen longitudes de prefijo diferentes y, por lo tanto, se consideran destinos diferentes. No es necesario compararlas; R1 las insertar√° todas en la tabla de enrutamiento.</p> <p>Cabe destacar que las cuatro subredes del ejemplo se superponen, como se muestra en la figura 17.15. Las subredes /25, /26 y /27 se encuentran dentro de la subred /24. Sin embargo, al crear la tabla de enrutamiento, se consideran redes de destino diferentes y, por lo tanto, se insertar√°n en ella.</p> <p></p> <p>Figura 14.  Las cuatro rutas del ejemplo se superponen. 203.0.113.0/24 incluye 203.0.113.0‚Äì.255, 203.0.113.0/25 incluye 203.0.113.0‚Äì.127, 203.0.113.0/26 incluye 203.0.113.0‚Äì.63 y 203.0.113.0/27 incluye 203.0.113.0‚Äì.31. Sin embargo, IOS las considera rutas a diferentes destinos e insertar√° las cuatro rutas en la tabla de enrutamiento.</p> <p>Nota</p> <p>El concepto de \"ruta coincidente m√°s espec√≠fica\" es irrelevante para esta pregunta. La regla de la ruta coincidente m√°s espec√≠fica se utiliza para seleccionar qu√© ruta de la tabla de enrutamiento se usar√° para   reenviar un paquete; no para seleccionar qu√© rutas entrar√°n en la tabla de enrutamiento.</p> <p>Veamos otro ejemplo. R1 aprende las siguientes rutas mediante protocolos de enrutamiento din√°mico:</p> <ul> <li>(A) 10.0.0.0/8 a trav√©s de EIGRP, m√©trica 2345</li> <li>(B) 10.0.0.0/8 a trav√©s de OSPF, m√©trica 10</li> <li>(C) 10.0.0.0/16 a trav√©s de OSPF, m√©trica 20</li> <li>(D) 10.0.0.0/16 a trav√©s de OSPF, m√©trica 5</li> </ul> <p>¬øQu√© ruta(s) insertar√° R1 en su tabla de enrutamiento en este ejemplo? Analicemos la l√≥gica. En este ejemplo, R1 aprende dos rutas a cada una de dos redes de destino diferentes: dos rutas a 10.0.0.0/8 y dos rutas a 10.0.0.0/16. Por lo tanto, R1 debe seleccionar la mejor de las dos rutas a 10.0.0.0/8 y la mejor de las dos rutas a 10.0.0.0/16.</p> <p>¬øCu√°l de las dos rutas a 10.0.0.0/8 preferir√° R1? Dado que R1 aprende las dos rutas mediante diferentes protocolos de enrutamiento, usar√° AD para compararlas. La m√©trica de EIGRP (90) es menor que la de OSPF (110), por lo que R1 seleccionar√° la ruta EIGRP; por lo tanto, A es una de las respuestas.</p> <p>¬øY cu√°l de las dos rutas a 10.0.0.0/16 preferir√° R1? En este caso, ambas rutas se aprenden mediante el mismo protocolo de enrutamiento, por lo que R1 comparar√° sus valores m√©tricos para determinar cu√°l es la ruta preferible. La ruta D tiene la m√©trica m√°s baja de las dos, por lo que ser√° la seleccionada.</p>","path":["Enrutamiento","Enrutamiento din√°mico"],"tags":[]},{"location":"rutas_dinamicas/#reenvio-de-paquetes","level":4,"title":"Reenv√≠o de paquetes","text":"<p>El segundo aspecto de la selecci√≥n de ruta es el reenv√≠o de paquetes: seleccionar la ruta de la tabla de enrutamiento que se utilizar√° para reenviar un paquete en particular. Este proceso es m√°s sencillo, ya que solo se considera una cosa: la ruta m√°s espec√≠fica. Al reenviar un paquete, no se consideran los valores de AD ni de m√©tricas de las rutas.</p> <p>Sin embargo, identificar la ruta que un router seleccionar√° para reenviar un paquete puede ser dif√≠cil, ya que el proceso de identificar qu√© rutas coinciden con el destino de un paquete en particular y cu√°l de ellas es la m√°s espec√≠fica requiere la conversi√≥n entre binario y decimal. Por eso, enfatic√© la importancia de familiarizarse con el sistema binario al abordar el direccionamiento y la subred IPv4 en cap√≠tulos anteriores.</p> <p>Veamos un ejemplo de selecci√≥n de ruta en el contexto del reenv√≠o de paquetes. Examine la tabla de enrutamiento de R1 a continuaci√≥n. ¬øQu√© ruta seleccionar√° para reenviar un paquete con destino a 203.0.113.65?</p> <pre><code>R1# show ip route\n. . .\nS        203.0.113.0/24 [1/0] via 192.168.1.2\nR        203.0.113.0/25 [120/4] via 192.168.1.6\nD        203.0.113.0/26 [90/5678] via 192.168.1.10\nO        203.0.113.0/27 [110/10] via 192.168.1.14\n</code></pre> <p>El primer paso es identificar qu√© rutas coinciden con el destino del paquete. Como vimos en el cap√≠tulo 9, si la direcci√≥n IP de destino del paquete forma parte de la red especificada en la ruta, se considera una coincidencia. En el siguiente ejemplo, he escrito cada ruta en binario, as√≠ como la direcci√≥n IP de destino del paquete (203.0.113.65):</p> <pre><code>203.0.113.0/24 = 11001011.00000000.01110001.00000000\n203.0.113.0/25 = 11001011.00000000.01110001.00000000\n203.0.113.0/26 = 11001011.00000000.01110001.00000000\n203.0.113.0/27 = 11001011.00000000.01110001.00000000\n203.0.113.65   = 11001011.00000000.01110001.01000001\n</code></pre> <p>La ruta a 203.0.113.0/24 coincide con el destino del paquete, al igual que la ruta a 203.0.113.0/25. La ruta a 203.0.113.0/26 no coincide con el destino del paquete porque el bit 26 no coincide; es 0 en la ruta, pero 1 en la direcci√≥n IP de destino del paquete. Del mismo modo, la ruta /27 no coincide debido a la falta de coincidencia del bit 26.</p> <p>De las dos rutas coincidentes, la ruta a 203.0.113.0/25 es m√°s espec√≠fica; tiene la longitud de prefijo m√°s larga. Por lo tanto, es la ruta que se seleccionar√° para reenviar el paquete; R1 reenviar√° el paquete al siguiente salto 192.168.1.6. El hecho de que la ruta tenga un AD m√°s alto que las otras tres rutas es irrelevante, al igual que su m√©trica; al seleccionar la ruta que se utilizar√° para reenviar un paquete, la √∫nica consideraci√≥n es la ruta coincidente m√°s espec√≠fica. En resumen, estos son los dos aspectos de la selecci√≥n de ruta:</p> <ul> <li>Poblaci√≥n de la tabla de enrutamiento:<ul> <li>Las m√©tricas se utilizan para seleccionar entre rutas hacia el mismo destino que se aprenden a trav√©s del mismo protocolo de enrutamiento.</li> <li>AD se utiliza para seleccionar entre rutas hacia el mismo destino que se aprenden a trav√©s de diferentes protocolos de enrutamiento.</li> </ul> </li> <li>Reenv√≠o de paquetes:<ul> <li>Se selecciona la ruta coincidente m√°s espec√≠fica.</li> </ul> </li> </ul>","path":["Enrutamiento","Enrutamiento din√°mico"],"tags":[]},{"location":"rutas_dinamicas/#el-comando-network","level":2,"title":"El comando <code>network</code>","text":"<p>RIP, EIGRP y OSPF se configuran activando el protocolo en una o m√°s interfaces del router. El router anuncia el prefijo de red (direcci√≥n y m√°scara de red) de la interfaz. La configuraci√≥n de RIP y EIGRP queda fuera del alcance del examen CCNA, y abordaremos la configuraci√≥n de OSPF con m√°s detalle en el cap√≠tulo 18. Sin embargo, en esta secci√≥n, analizaremos un comando compartido por los tres protocolos: el comando <code>network</code>. Este comando le indica al router que:</p> <ul> <li>Busque interfaces con una direcci√≥n IP que est√© dentro del rango especificado</li> <li>Active el protocolo de enrutamiento en esas interfaces</li> <li>Anuncie el prefijo de red de las interfaces a sus vecinos</li> </ul> <p>Aunque RIP, EIGRP y OSPF comparten el comando <code>network</code>, existen diferencias de sintaxis entre ellos; nos centraremos en OSPF, ya que su configuraci√≥n es un tema del examen CCNA. Para configurar OSPF en un router Cisco, utilice el comando router ospf process-id en el modo de configuraci√≥n global para acceder al modo de configuraci√≥n del router, un nuevo modo de configuraci√≥n desde el cual puede utilizar el comando network.</p> <p>Nota</p> <p>Un router puede ejecutar procesos OSPF independientes (instancias), por lo que debe especificar un id de proceso en el comando router ospf. Sin embargo, los casos de uso de m√∫ltiples procesos OSPF quedan fuera del alcance del examen CCNA.</p> <p>La Figura 17.16 muestra c√≥mo se puede usar el comando network para activar OSPF en las interfaces de un router. La sintaxis del comando network es <code>network ip-address wildcard-mask area area-id</code>. La clave de este comando es la m√°scara wildcard, que parece una m√°scara de red invertida, pero tiene una funci√≥n diferente.</p> <p>Nota</p> <p>OSPF utiliza √°reas para dividir l√≥gicamente la red; cubriremos las √°reas OSPF en el cap√≠tulo 18. Por ahora, solo especificaremos el √°rea 0 en el comando de red.</p> <p></p> <p>Figura 15.  Activaci√≥n de OSPF en las interfaces de un router con el comando network. El comando utiliza una m√°scara comod√≠n, que parece una m√°scara de red invertida.</p> <p>Una m√°scara wildcard o comod√≠n, al igual que una m√°scara de red, es una serie de 32 bits. Su prop√≥sito es indicar qu√© bits deben coincidir entre dos direcciones IP y cu√°les no. La m√°scara comod√≠n del comando <code>network</code> especifica qu√© bits deben coincidir entre la direcci√≥n IP del comando <code>network</code>y la direcci√≥n IP configurada en la interfaz de un router. Un bit 0 en la m√°scara comod√≠n significa que los bits en la misma posici√≥n de la direcci√≥n IP del comando <code>network</code> y la direcci√≥n IP de la interfaz deben coincidir. Un bit 1 en la m√°scara comod√≠n significa que los bits no tienen que coincidir.</p> <p>Examinemos los tres comandos <code>network</code>utilizados en la figura 17.16. En el siguiente ejemplo, muestro el comando <code>network</code> utilizado para activar OSPF en la interfaz G0/0 de R1. Observe que los bits correspondientes coinciden entre la direcci√≥n IP del comando de red (192.168.1.0) y la direcci√≥n IP G0/0 de R1 (192.168.1.1); estos bits se especifican con 0 en la m√°scara comod√≠n.</p> <pre><code>192.168.1.1 = 11000000.10101000.00000001.00000001\n192.168.1.0 = 11000000.10101000.00000001.00000000\n0.0.0.3     = 00000000.00000000.00000000.00000011\n</code></pre> <p>A continuaci√≥n, el comando que utilic√© para activar OSPF en la interfaz G0/1 de R1. Nuevamente, los bits correspondientes coinciden con la direcci√≥n IP especificada en el comando de red y la direcci√≥n IP de G0/1:</p> <pre><code>192.168.1.5 = 11000000.10101000.00000001.00000101\n192.168.1.4 = 11000000.10101000.00000001.00000100\n0.0.0.3     = 00000000.00000000.00000000.00000011\n</code></pre> <p>En estos dos ejemplos, utilic√© una m√°scara comod√≠n de 0.0.0.3, que equivale a una m√°scara de red /30 (255.255.255.252) con los bits invertidos. La Figura 17.17 lo demuestra: todos los bits 1 de la m√°scara de red 255.255.255.252 son 0 en la m√°scara comod√≠n 0.0.0.3 y viceversa.</p> <p></p> <p>Figura 16.  M√°scara de red A /30 (255.255.255.252) y su m√°scara comod√≠n equivalente (0.0.0.3). Los bits 1 en la m√°scara de red son 0 en la m√°scara comod√≠n y viceversa.</p> <p>Nota</p> <p>Un atajo para calcular la m√°scara comod√≠n equivalente de una m√°scara de red es restar cada octeto de la m√°scara de red de 255. Los primeros tres octetos de una m√°scara de red /30 son 255 y 255-255 = 0. El octeto final es 252 y 255-252 = 3.</p> <p>Finalmente, veamos el comando que us√© para activar OSPF en la interfaz G0/2 de R1. Esta vez, la longitud del prefijo de la interfaz es /24, por lo que us√© la m√°scara comod√≠n equivalente a una m√°scara de red /24: 0.0.0.255.</p> <pre><code>192.168.2.1 = 11000000.10101000.00000010.00000000\n192.168.2.0 = 11000000.10101000.00000010.00000000\n0.0.0.255   = 00000000.00000000.00000000.11111111\n</code></pre> <p>En la Tabla 17.3 se enumeran algunas m√°scaras de red y sus m√°scaras comod√≠n equivalentes.</p> Longitud del prefijo M√°scara de red M√°scara comod√≠n (√∫ltimo octeto en binario) /24 255.255.255.0 0.0.0.255 (11111111) /25 255.255.255.128 0.0.0.127 (01111111) /26 255.255.255.192 0.0.0.63 (00111111) /27 255.255.255.224 0.0.0.31 (00011111) /28 255.255.255.240 0.0.0.15 (00001111) /29 255.255.255.248 0.0.0.7 (00000111) /30 255.255.255.252 0.0.0.3 (00000011) /31 255.255.255.254 0.0.0.1 (00000001) /32 255.255.255.255 0.0.0.0 (00000000) <p>Tabla 17.3 M√°scaras de red /24+ y m√°scaras comod√≠n (ver figura de la tabla)</p>","path":["Enrutamiento","Enrutamiento din√°mico"],"tags":[]},{"location":"rutas_dinamicas/#por-que-mascarillas-comodin","level":3,"title":"¬øPor qu√© mascarillas comod√≠n?","text":"<p>Quiz√°s se pregunte por qu√© usamos m√°scaras comod√≠n en lugar de m√°scaras de red. La clave est√° en recordar para qu√© sirven las m√°scaras de red: identifican el tama√±o de un prefijo de red, distinguiendo entre la parte de red y la parte de host de una direcci√≥n IP. Por ejemplo, al configurar <code>ip address 192.168.1.1 255.255.255.0</code> en la interfaz de un router, este indica que su direcci√≥n IP es 192.168.1.1: los primeros tres octetos corresponden a la parte de red y el √∫ltimo a la parte de host. El prefijo es 192.168.1.0/24.</p> <p>Sin embargo, al usar el comando <code>network</code> de OSPF, la direcci√≥n IP y la m√°scara comod√≠n se usan de forma diferente; no definen un prefijo de red como lo har√≠a una m√°scara de red. En cambio, especifican un rango de direcciones IP, que no necesariamente forman parte de la misma subred. Este rango se utiliza para determinar qu√© interfaces del router participar√°n en OSPF, es decir, cu√°les enviar√°n y recibir√°n informaci√≥n de enrutamiento OSPF. A continuaci√≥n, un breve resumen:</p> <ul> <li>Una m√°scara de red (o m√°scara de subred) se utiliza para distinguir las partes de red y host de una direcci√≥n IP. Determina la longitud del prefijo de red de una subred.</li> <li>En el contexto del comando de red OSPF, una direcci√≥n IP y una m√°scara comod√≠n no definen un prefijo de red. En cambio, definen un rango de direcciones IP (que no necesariamente pertenecen a la misma subred). Este rango se utiliza para determinar qu√© interfaces del router participar√°n en el proceso OSPF (es decir, qu√© interfaces enviar√°n y recibir√°n informaci√≥n de enrutamiento OSPF).</li> </ul> <p>En los tres comandos <code>network</code> que analizamos, utilic√© la direcci√≥n de red (la parte del host de todos los 0) de cada interfaz y la m√°scara comod√≠n equivalente a la m√°scara de red de cada interfaz. Sin embargo, es importante destacar que el comando <code>network</code> es flexible: siempre que los bits correspondientes coincidan entre la direcci√≥n IP del <code>network</code> y la direcci√≥n IP de la interfaz (los indicados por un bit 0 en la m√°scara comod√≠n), OSPF se activar√° en la interfaz. La Figura 17.18 muestra una forma diferente de activar OSPF en las interfaces del R1, esta vez utilizando solo dos comandos <code>network</code>.</p> <p></p> <p>Figura 17.  Activaci√≥n de OSPF en las interfaces de R1 con dos comandos de red. El primer comando activa OSPF en las interfaces G0/0 y G0/1 de R1, y el segundo en G0/2.</p> <p>El primer comando activa OSPF tanto en G0/0 como en G0/1; los bits correspondientes de la direcci√≥n IP de cada interfaz coinciden con la direcci√≥n IP especificada en el comando <code>network</code>. Mediante una m√°scara comod√≠n de 0.0.0.7 (equivalente a una m√°scara de red /29 (255.255.255.248), indico a R1 que active OSPF en todas las interfaces con una direcci√≥n IP entre 192.168.1.0 y 192.168.1.7, incluidas G0/0 (192.168.1.1) y G0/1 (192.168.1.5).</p> <pre><code>192.168.1.1 = 11000000.10101000.00000001.00000001\n192.168.1.5 = 11000000.10101000.00000001.00000101\n192.168.1.0 = 11000000.10101000.00000001.00000000\n0.0.0.7     = 00000000.00000000.00000000.00000111\n</code></pre> <p>El segundo comando activa OSPF en G0/2 de forma diferente al ejemplo anterior. Al especificar la direcci√≥n IP exacta de G0/2 en el comando de red y usar una m√°scara comod√≠n de 0.0.0.0 (equivalente a una m√°scara de red /32 (255.255.255.255), le indico a R1 que active OSPF solo en la interfaz con la direcci√≥n IP 192.168.2.1, la interfaz G0/2 de R1.</p> <pre><code>192.168.2.1 = 11000000.10101000.00000010.00000001\n192.168.2.1 = 11000000.10101000.00000010.00000001\n0.0.0.0     = 00000000.00000000.00000000.00000000\n</code></pre> <p>Como acabamos de ver, el comando <code>network</code> es bastante flexible. El resultado de los dos ejemplos anteriores (figuras 17.17 y 17.18) es el mismo: OSPF se activa en las interfaces de R1, y R1 anuncia la direcci√≥n de red de sus interfaces a sus vecinos. Sin embargo, el m√©todo recomendado para usar el comando <code>network</code> es el √∫ltimo que vimos: especificar la direcci√≥n IP exacta de la interfaz y usar una m√°scara comod√≠n de 0.0.0.0.</p> <p>El motivo de esta recomendaci√≥n es evitar la activaci√≥n involuntaria de OSPF en las interfaces. Si utiliza un comando <code>network</code> con un rango de direcciones m√°s amplio, cualquier interfaz con una direcci√≥n IP dentro de ese rango se incluir√° en el proceso OSPF. Al especificar la direcci√≥n IP exacta de la interfaz con una m√°scara comod√≠n de 0.0.0.0, se garantiza que solo se incluya la interfaz deseada.</p> <p>Nota</p> <p>Un m√©todo abreviado para activar OSPF en todas las interfaces es usar la red 0.0.0.0 255.255.255.255 √°rea 0. Una m√°scara comod√≠n de 255.255.255.255 equivale a una m√°scara de red de 0.0.0.0 y coincide con todas las direcciones IP posibles. Esto es √∫til para activar OSPF r√°pidamente en un entorno de laboratorio, pero no se recomienda en una red real.</p> <p>Existen dos conceptos err√≥neos importantes que muchos estudiantes tienen sobre el comando \"network\" de OSPF. El primero es que la m√°scara comod√≠n del comando \"network\" debe coincidir con la m√°scara de red de la interfaz. Esto no es as√≠, como vimos en los ejemplos anteriores; siempre que los bits correctos entre la direcci√≥n IP del comando \"network\" y la direcci√≥n IP de la interfaz (los bits especificados por la m√°scara comod√≠n) coincidan, OSPF se activar√° en la interfaz.</p> <p>El segundo error es que el comando network especifica qu√© redes debe anunciar OSPF. No es as√≠; m√°s bien, especifica en qu√© interfaces debe activarse OSPF. El router anunciar√° entonces el prefijo de red de la interfaz. Para aclarar, veamos qu√© hacen los dos comandos de la figura 17.18. Este es el primer comando:</p> <pre><code>R1(config-router)# network 192.168.1.0 0.0.0.7 area 0\n</code></pre> <p>Aunque 0.0.0.7 equivale a una m√°scara de red /29, este comando no le indica a R1 que anuncie la red 192.168.1.0/29. Le indica a R1 que haga lo siguiente:</p> <ul> <li>Busque interfaces con una direcci√≥n IP en el rango 192.168.1.0 a 192.168.1.7:<ul> <li>Las direcciones IP de R1 G0/0 y G0/1 est√°n en este rango.</li> </ul> </li> <li>Activar OSPF en esas interfaces.</li> <li>Anunciar el prefijo de red de las interfaces a los vecinos:<ul> <li>R1 anunciar√° el prefijo 192.168.1.0/30 de G0/0 y el prefijo 192.168.1.4/30 de G0/1.</li> </ul> </li> </ul> <p>Y aqu√≠ est√° el segundo comando, utilizado para activar OSPF en la interfaz G0/2 de R1:</p> <pre><code>R1(config-router)# network 192.168.2.1 0.0.0.0 area 0\n</code></pre> <p>Este comando no le indica a R1 que anuncie 192.168.2.1/32, sino que active OSPF en la interfaz con una direcci√≥n IP de 192.168.2.1 (G0/2) y anuncie el prefijo de red de esa interfaz, que es 192.168.2.0/24.</p>","path":["Enrutamiento","Enrutamiento din√°mico"],"tags":[]},{"location":"rutas_dinamicas/#resumen","level":2,"title":"Resumen","text":"<ul> <li>El enrutamiento din√°mico es un proceso mediante el cual los routers comparten informaci√≥n sobre la red, lo que les permite crear sus tablas de enrutamiento autom√°ticamente. Esto se logra mediante un protocolo de enrutamiento.</li> <li>El enrutamiento din√°mico ofrece varias ventajas sobre el enrutamiento est√°tico, como adaptabilidad y escalabilidad.</li> <li>El enrutamiento est√°tico tambi√©n ofrece ventajas sobre el enrutamiento din√°mico, como la previsibilidad y el control. Afortunadamente, ambos pueden usarse simult√°neamente.</li> <li>Los protocolos de enrutamiento se pueden dividir en dos categor√≠as principales: Interior Gateway Protocols (IGP) y Exterior Gateway Protocols (EGP).</li> <li>Los IGP se utilizan para intercambiar informaci√≥n de enrutamiento dentro de un solo sistema aut√≥nomo (AS), y los EGP se utilizan para intercambiar informaci√≥n de enrutamiento entre sistemas aut√≥nomos.</li> <li>Los IGP se pueden clasificar seg√∫n el tipo de algoritmo que utilizan para compartir informaci√≥n de enrutamiento y calcular rutas: vector de distancia o estado de enlace.</li> <li>Los dos IGP de vector de distancia son Routing Information Protocol (RIP) y Enhanced Interior Gateway Routing Protocol (EIGRP).</li> <li>Los dos IGP de estado de enlace son Routing Information Protocol (RIP) y Enhanced Interior Gateway Routing Protocol (EIGRP).</li> <li>El enrutamiento por vector de distancia tambi√©n se denomina enrutamiento por rumor. El router no tiene un mapa completo de la red; solo conoce lo que le dicen sus vecinos.</li> <li>Los routers que utilizan un protocolo de enrutamiento de estado de enlace construyen un ‚Äúmapa de conectividad‚Äù de la red y utilizan ese mapa para calcular rutas a cada destino.</li> <li>El √∫nico EGP de uso com√∫n actualmente es Border Gateway Protocol (BGP). Utiliza un algoritmo de vector de ruta que calcula rutas mediante l√≥gica AS-a-AS, en lugar de router a router; est√° dise√±ado para enrutamiento a gran escala.</li> <li>El t√©rmino selecci√≥n de ruta tiene dos significados principales: uno relacionado con la poblaci√≥n de la tabla de enrutamiento y otro relacionado con el reenv√≠o de paquetes.</li> <li>En la poblaci√≥n de la tabla de enrutamiento, la selecci√≥n de rutas es el proceso de seleccionar las rutas que ingresar√°n a la tabla. El router usar√° AD y m√©tricas para seleccionar las rutas que ingresar√°n a la tabla de enrutamiento.</li> <li>En el reenv√≠o de paquetes, la selecci√≥n de ruta consiste en seleccionar la mejor ruta en la tabla de enrutamiento para reenviar un paquete. El router seleccionar√° la ruta coincidente m√°s espec√≠fica de la tabla de enrutamiento para reenviarlo.</li> <li>Solo la mejor ruta a cada destino se a√±adir√° a la tabla de enrutamiento y, por lo tanto, ser√° candidata para el reenv√≠o de paquetes. Las rutas que no se incluyan en la tabla de enrutamiento no podr√°n utilizarse para el reenv√≠o de paquetes.</li> <li>Una m√©trica mide la eficiencia de una ruta. Se utiliza para seleccionar rutas con el mismo destino (misma direcci√≥n de red y longitud de prefijo), obtenidas mediante el mismo protocolo de enrutamiento.</li> <li>Cada IGP utiliza una m√©trica diferente. RIP utiliza el n√∫mero de saltos, EIGRP utiliza una m√©trica basada en el ancho de banda y el retraso (y otros par√°metros), y OSPF utiliza un costo basado en el ancho de banda de cada enlace.</li> <li>Debido a que cada protocolo utiliza una m√©trica diferente, las m√©tricas no se pueden utilizar para comparar rutas aprendidas a trav√©s de diferentes protocolos de enrutamiento.</li> <li>La distancia administrativa (AD) es un valor que indica la preferencia de un protocolo de enrutamiento. Un valor de AD m√°s bajo se considera preferible, lo que significa que IOS considera el protocolo m√°s confiable y, por lo tanto, es m√°s probable que seleccione buenas rutas.</li> <li>AD se utiliza para seleccionar entre rutas hacia el mismo destino, aprendidas a trav√©s de diferentes protocolos de enrutamiento.</li> <li>Los valores de AD predeterminados son Conectado = 0, Est√°tico = 1, eBGP = 20, EIGRP = 90, OSPF = 110, IS-IS = 115, RIP = 120, iBGP = 200, inutilizable = 255.</li> <li>Si se aprenden varias rutas al mismo destino mediante el mismo protocolo de enrutamiento y tienen la misma m√©trica, todas se insertar√°n en la tabla de enrutamiento y el router distribuir√° el tr√°fico entre ellas. Esto se denomina enrutamiento multirruta de igual costo (ECMP).</li> <li>Una ruta est√°tica flotante es una ruta est√°tica configurada con un AD mayor que el valor predeterminado de 1 para que sea menos preferida. La sintaxis del comando es: <code>ip route destination-network netmask next-hop ad</code></li> <li>Incluso si varias rutas comparten la misma direcci√≥n de red de destino, sus destinos se consideran diferentes si tienen distintas longitudes de prefijo. Todas se insertar√°n en la tabla de enrutamiento (es decir, 192.168.0.0/16, 192.168.0.0/17 y 192.168.0.0/18).</li> <li>RIP, EIGRP y OSPF utilizan el comando network para activar el protocolo en las interfaces del router. Se configura en el modo de configuraci√≥n del router.</li> <li>Para acceder al modo de configuraci√≥n del router para OSPF, utilice el comando router ospf process-id. La sintaxis del comando <code>network</code> de OSPF es: <code>network, ip-address wildcard-mask area area-id</code>.</li> <li>El comando <code>network</code>le dice al router que:</li> <li>Busque interfaces con una direcci√≥n IP en el rango especificado</li> <li>Activar el protocolo de enrutamiento en esas interfaces</li> <li>Anunciar el prefijo de red de las interfaces a los vecinos</li> <li>Una m√°scara comod√≠n o wildcard es una serie de 32 bits que indica qu√© bits deben coincidir entre dos direcciones IP. Un bit 0 en la m√°scara comod√≠n significa que los bits deben coincidir, y un bit 1 en la m√°scara comod√≠n significa que no tienen que coincidir.</li> <li>Una m√°scara comod√≠n se parece a una m√°scara de red invertida, pero tiene una funci√≥n diferente. Una m√°scara de red indica las partes de red y host de una direcci√≥n IP, y una m√°scara comod√≠n se utiliza para especificar un rango de direcciones IP (no necesariamente en la misma subred).</li> <li>Todos los bits 1 de una m√°scara de red son 0 en la m√°scara comod√≠n equivalente y viceversa. Por ejemplo, una m√°scara de red /24 es 255.255.255.0, y la m√°scara comod√≠n equivalente es 0.0.0.255.</li> <li>Si los bits apropiados coinciden entre la direcci√≥n IP en el <code>network</code> y la direcci√≥n IP de una interfaz, se activar√° OSPF en la interfaz.</li> <li>El comando <code>network</code>es flexible. La direcci√≥n IP y la m√°scara comod√≠n del comando no tienen que coincidir con la direcci√≥n IP y la m√°scara de red de la interfaz. Si los bits correctos entre la direcci√≥n IP del comando <code>network</code> y la direcci√≥n IP de la interfaz coinciden, se activar√° OSPF en la interfaz.</li> <li>Se recomienda especificar la direcci√≥n IP exacta de la interfaz y utilizar una m√°scara comod√≠n /32 (0.0.0.0) en el comando <code>network</code> para garantizar que OSPF se active solo en la interfaz deseada.</li> <li>Un atajo para activar OSPF en todas las interfaces es usar <code>network 0.0.0.0 255.255.255.255 √°rea 0</code>, ya que coincide con todas las direcciones IP posibles. Este atajo es √∫til en un laboratorio simulado, pero no se recomienda en una red real.</li> <li>La direcci√≥n IP y la m√°scara comod√≠n del comando <code>network</code> no determinan los prefijos que anuncia el router. Determinan en qu√© interfaces est√° activado OSPF, y luego el router anuncia los prefijos de esas interfaces.</li> </ul>","path":["Enrutamiento","Enrutamiento din√°mico"],"tags":[]}]}